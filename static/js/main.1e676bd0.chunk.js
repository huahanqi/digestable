(this.webpackJsonpdigestable=this.webpackJsonpdigestable||[]).push([[0],{75:function(e,t,n){},78:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(21),i=n.n(r),l=(n(75),n(11)),s=n.n(l),u=n(60),o=n(5),d=n(90),f=n(58),h=n(87),v=n(61),p=n(88),m=n(92),g=n(89),j=n(4),b=n(2),x=n(1),y=[{name:"quantiles",type:"rows"}],O={apply:!1,columnType:"numeric",methods:y,method:y[0],amount:.5,transformBase:1,unique:0,rows:10,unselect:!1},w=function(e,t){switch(t.type){case"setApply":return Object(b.a)(Object(b.a)({},e),{},{apply:t.apply});case"setMethod":return Object(b.a)(Object(b.a)({},e),{},{method:t.method});case"setAmount":return Object(b.a)(Object(b.a)({},e),{},{amount:t.amount});case"setTransformBase":return Object(b.a)(Object(b.a)({},e),{},{transformBase:t.transformBase});case"setColumnInfo":return Object(b.a)(Object(b.a)({},e),{},{columnType:t.columnType,unique:t.unique,rows:Math.min(e.rows,t.unique)});case"setRows":return Object(b.a)(Object(b.a)({},e),{},{rows:t.rows});case"setUnselect":return Object(b.a)(Object(b.a)({},e),{},{unselect:t.unselect});default:throw new Error("Invalid simplify context action: "+t.type)}},C=Object(a.createContext)(O),S=function(e){var t=e.children,n=Object(a.useReducer)(w,O),c=Object(o.a)(n,2),r=c[0],i=c[1];return Object(x.jsx)(C.Provider,{value:[r,i],children:t})},k=["text","visualizations","both"],A=["row"],D={modes:k,mode:k[0],showLinks:!1,categoryScalingOptions:A,categoryScaling:A[0],calculatingRelations:!0,mainIndices:[],prepareIndices:[],showSearch:!1},I=function(e,t){switch(t.type){case"setMode":return Object(b.a)(Object(b.a)({},e),{},{mode:t.mode});case"setShowLinks":return Object(b.a)(Object(b.a)({},e),{},{showLinks:t.showLinks});case"setCategoryScaling":return Object(b.a)(Object(b.a)({},e),{},{categoryScaling:t.categoryScaling});case"setCalculatingRelations":return Object(b.a)(Object(b.a)({},e),{},{calculatingRelations:t.calculatingRelations});case"setMainIndices":return Object(b.a)(Object(b.a)({},e),{},{mainIndices:t.mainIndices});case"setPrepareIndices":return Object(b.a)(Object(b.a)({},e),{},{prepareIndices:t.prepareIndices});case"setShowSearch":return Object(b.a)(Object(b.a)({},e),{},{showSearch:t.showSearch});default:throw new Error("Invalid visualization context action: "+t.type)}},R=Object(a.createContext)(D),M=function(e){var t=e.children,n=Object(a.useReducer)(I,D),c=Object(o.a)(n,2),r=c[0],i=c[1];return Object(x.jsx)(R.Provider,{value:[r,i],children:t})},E=n(10);function L(e,t,n){for(var a=e[0].length,c=n-t,r=[],i=0;i<a;i++)r.push(0);for(var l=t;l<n;l++)for(var s=0;s<a;s++)r[s]=r[s]+e[l][s]/c;return r}function N(e,t){for(var n=e.length,a=Math.floor(n/t),c=[],r=0;r<t;r++){var i=a*r,l=a*(r+1);r+1===t&&(l=n),c.push(L(e,i,l))}return c}function B(e,t){for(var n,a,c,r=e.length,i=[];i.length<t;)a=0,c=r,n=Math.floor(Math.random()*(c-a)+a),-1===i.indexOf(n)&&i.push(n);for(var l=[],s=0;s<i.length;s++){var u=Object(E.a)(e[i[s]]);l.push(u)}return l}function q(e,t){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function z(e,t,n){if(n>50)return!0;if(!e||!e.length)return!1;for(var a=!0,c=0;c<t.length;c++)q(t[c],e[c])||(a=!1);return a}function T(e,t){for(var n=[],a=0;a<e.length;a++)n.push(e[a]-t[a]);return n.reduce((function(e,t){return e+t*t}),0)}function F(e,t){for(var n={},a=0;a<t.length;a++)n[a]={points:[],indeces:[],centroid:t[a]};for(var c=0;c<e.length;c++){for(var r=e[c],i=void 0,l=void 0,s=0;s<t.length;s++){var u=t[s];if(0===s)i=s,l=T(r,u);else{var o=T(r,u);o<l&&(l=o,u,i=s)}}n[i].points.push(r),n[i].indeces.push(c)}return n}function V(e){for(var t=e.length,n=[],a=0;a<e[0].length;a++)n.push(0);for(var c=0;c<e.length;c++)for(var r=e[c],i=0;i<r.length;i++){var l=r[i];n[i]=n[i]+l/t}return n}function U(e,t,n){var a,c=[];for(var r in t){var i=t[r];a=i.points.length>0?V(i.points):B(e,1)[0],c.push(a)}return c}n(78);function P(){return new Worker(n.p+"static/js/compute-relation-web-worker.dc856299.worker.js")}var W=n(55),H=(n(79),function(){var e=j.select(),t=j.select(),n=[],a=[],c=[],r=[],i=!1,l=NaN,s=NaN,u="ascending",d="ascending",f=!1,h="threshold",v=.9,p=20,m=1,g="text",x=!1,y=!1,O="row",w=["","NA","na"],C=function(e){return w.includes(e)},S=j.dispatch("clusterByColumn"),k=j.dispatch("CalculateRelations"),A=j.dispatch("selectIndices"),D=100,I=!1,R=[];function M(a){a.each((function(a){if(t=j.select(this).selectAll(".linkSvg").data([[]]).join((function(e){return e.append("svg").attr("class","linkSvg")})),e=j.select(this).selectAll("table").data([[]]).join((function(e){var t=e.append("table");return t.append("thead").append("tr"),t.append("tbody"),t})),function(e){c=e.columns.map((function(e){return{name:e}}));var t={name:"group",type:"group"};c.unshift(t),c.filter((function(e){return"group"!==e.type})).forEach((function(t){var n=t.name,a=e.map((function(e){return e[n]})),c=Array.from(a.reduce((function(e,t){return e.add(t)}),new Set)),r=c.filter((function(e){return!C(e)})),i=r.reduce((function(e,t){return e&&!isNaN(t)}),!0),l=i?r.map((function(e){return+e})):null;if(t.uniqueValues=c,i)if(l.length===e.length){l.sort((function(e,t){return j.ascending(e,t)}));var s=l.reduce((function(e,t,n,a){return e&&(0===n||t===a[n-1]+1)}),!0);t.type=s?"id":"numeric"}else 2===l.length&&l.includes(0)&&l.includes(1)?t.type="categorical":t.type="numeric";else c.length===e.length?t.type="id":t.type="categorical";"numeric"===t.type?(t.values=a.filter((function(e){return!C(e)})),t.extent=j.extent(l),t.maxDigits=j.max(l,q)):"categorical"===t.type&&(t.type="categorical",t.counts=L(c,a).sort((function(e,t){return t.count-e.count})),t.uniqueValues=t.counts.map((function(e){return e.value})))})),T(),V()}(a),n=a.map((function(e,t){var n=Object(b.a)({},e);return c.forEach((function(e){var t=e.type,a=e.name,c=n[a];C(c)?n[a]=null:"numeric"===t&&(n[a]=+c)})),{initialIndex:t,isCluster:!1,cluster:null,pinned:!1,expanded:!1,values:n}})),l){var r=c.find((function(e){return e.name===l}));r&&(G(r),"ascending"===u&&G(r))}if(s){var i=c.find((function(e){return e.name===s}));i&&(H(i),"ascending"===d&&H(i))}J(),Q(),Y()}))}var L=function(e,t){return Object.entries(t.reduce((function(e,t){return e[t]++,e}),e.reduce((function(e,t){return e[t]=0,e}),{}))).map((function(e){var t=Object(o.a)(e,2);return{value:t[0],count:t[1]}})).sort((function(e,t){return j.descending(e.count,t.count)}))},q=function(e){var t=Math.log(10),n=String(e).split("."),a=Object(o.a)(n,2),c=a[0],r=a[1];c=Math.abs(c);var i=Math.floor(Math.log(e)/t)+1,l=r?c>0?r.length:Math.floor(Math.log(+e)/t)+1:0;return Math.max(i+l,1)};function T(){c.forEach((function(e){return e.sort=null}))}function V(){c.forEach((function(e){return e.cluster=null}))}function H(e){var t="descending"===e.sort?"ascending":"descending";T(),e.sort=t}function G(e){var t=null===e.cluster?"descending":"descending"===e.cluster?"ascending":null;V(),T(),e.cluster=t}function J(){!function(){var e=c.find((function(e){return e.cluster})),t=e?e.cluster:"ascending";n.sort((function(n,a){var c=e?n.values[e.name]:n.initialIndex,r=e?a.values[e.name]:a.initialIndex;return c===r?0:null===c?1:null===r?-1:j[t](c,r)}))}(),n.forEach((function(e){return e.expanded=!1}));var e=c.find((function(e){return e.cluster}));if(c.filter((function(e){return"numeric"!==e.type})).forEach((function(e){return e.maxCount=1})),i=f&&e&&"id"!==e.type){var t=e.name,r=e.type,l=e.cluster,s=n.map((function(e){return e.values[t]})),u=("numeric"===r?function(e,t){var n=function(e){var n="ascending"===t?1/m:m,a=j.scaleLinear().domain(j.extent(e)).range([0,1]);return e.map((function(e){return Math.pow(a(e),n)}))},a=function(e){var t=e.indexOf(null),n=t>-1?j.range(t,e.length):null;return[t>-1?e.slice(0,t):e,n,n?p-1:p]},c=function(e,t){return t?e.concat([t]):e};switch(h){case"quantiles":var r=a(e),i=Object(o.a)(r,3),l=i[0],s=i[1],u=function(e,t){var n=j.range(t),a=j.scaleQuantile().domain(e).range(n);return e.reduce((function(e,t,n){return e[a(t)].push(n),e}),n.map((function(){return[]})))}(l,i[2]);return"descending"===t&&u.reverse(),c(u,s);case"kmeans":var d=a(e),f=Object(o.a)(d,3),v=f[0],g=f[1],b=f[2],x=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e.length&&e[0].length&&e.length>=t){var a,c,r,i=0;for(r=n?N(e,t):B(e,t);!z(a,r,i);)a=Object(E.a)(r),i++,r=U(e,c=F(e,r));for(var l=[],s=0;s<t;s++)l.push(c[s]);return{clusters:l,centroids:r,iterations:i,converged:i<=50}}throw new Error("Invalid dataset")}(v.map((function(e){return[e]})),b),y=x.clusters;return y.sort((function(e,n){return j[t](e.centroid[0],n.centroid[0])})),c(y.map((function(e){return e.indeces})),g);case"gap":var O=a(e),w=Object(o.a)(O,3),C=w[0],S=w[1],k=w[2],A=function(e,t){var n=j.pairs(e).map((function(e,t){return{value:Math.abs(e[1]-e[0]),index:t}}));n.sort((function(e,t){return e.value===t.value?j.ascending(e.index,t.index):j.descending(e.value,t.value)}));var a=n.slice(0,t-1).map((function(e){return e.index}));return a.sort(j.ascending),a.unshift(-1),a.push(e.length-1),j.pairs(a).map((function(e){return j.range(e[0]+1,e[1]+1)}))}(n(C),k);return c(A,S);default:console.log("Unknown simplification method: ".concat(h))}}(s,l):function(e){return function(e){return e.reduce((function(e,t,n,a){return 0===n?e.push([n]):t===a[n-1]?e[e.length-1].push(n):e.push([n]),e}),[])}(e)}(s)).filter((function(e){return e.length>0}));a=u.map((function(e){var t=e.length;if(1===t)return n[e[0]].cluster=null,n[e[0]];var a={isCluster:!0,indeces:e,size:t,values:{}};return e.forEach((function(e){return n[e].cluster=a})),c.forEach((function(t){var c=t.name,r=t.type,i=t.uniqueValues;if("numeric"===r){var l=e.map((function(e){return n[e].values[c]}));if(l.length>0){var s=l.filter((function(e){return null!==e}));a.values[c]=s.length>0?{valid:!0,values:l,validValues:s,min:j.min(s),max:j.max(s),median:j.median(s),q1:j.quantile(s,.25),q2:j.quantile(s,.75)}:{valid:!1,values:l}}else a.values[c]=null}else if("categorical"===r){var u=e.map((function(e){return n[e].values[c]}));if(u.length>0){var o=L(i,u);t.maxCount=Math.max(t.maxCount,o[0].count),a.values[c]={counts:o}}else a.values[c]=null}else if("id"===r){var d=e.map((function(e){return n[e].values[c]}));if(d.length>0){var f=d.map((function(e){return{value:e,count:1}}));a.values[c]={counts:f}}else a.values[c]=null}else"group"===r||console.warn("Unknown column type: "+r)})),a}))}else D<Object(E.a)(n).length?a=Object(E.a)(n).slice(0,D):(a=Object(E.a)(n),I=!0)}function Q(){var e=c.find((function(e){return null!==e.sort}));if(e){var t=e.name,n=e.type,r=e.sort,i=e.cluster;a.sort((function(e,a){switch(n){case"numeric":var c=e.isCluster?e.values[t].median:e.values[t],l=a.isCluster?a.values[t].median:a.values[t];return c===l?0:null===c?1:null===l?-1:j[r](c,l);case"categorical":if(i){var s=e.isCluster?e.values[t].counts[0].count:e.values[t]?1:null,u=a.isCluster?a.values[t].counts[0].count:a.values[t]?1:null;return s===u?0:null===s?1:null===u?-1:j[r](s,u)}var o=e.isCluster?e.values[t].counts[0].count/e.size:e.values[t],d=a.isCluster?a.values[t].counts[0].count/a.size:a.values[t];return o===d?0:null===o?1:null===d?-1:j[r](o,d);case"id":var f=e.isCluster?e.values[t].counts[0].value:e.values[t],h=a.isCluster?a.values[t].counts[0].value:a.values[t];return f===h?0:null===f?1:null===h?-1:j[r](f,h);default:return console.log("Unknown column type ".concat(n)),0}}))}}function Y(){var r="5px",l="0px",s=c.find((function(e){return e.cluster})),u=f&&s&&"categorical"===s.type;e.selectAll("svg").attr("width",0),function(){var t=function(e){switch(e.type){case"numeric":var t=e.extent[0],n=e.extent[1];return t===n?t:"<div class='range'><div>".concat(t,"</div><div class='dash'><hr /></div><div>").concat(n,"</div>");case"categorical":return"<div>".concat(e.uniqueValues.length," categories</div>");case"id":return"<div>".concat(e.uniqueValues.length," unique values<div>");default:return null}},n=e.select("thead").select("tr").selectAll("th").data(c,(function(e){return e.name})).join((function(e){var n=e.append("th");n.each((function(e){var a=this;j.select(this).selectAll(".headerDiv").data([e]).join((function(c){var r=c.append("div").attr("class","headerDiv"),i=r.append("div").attr("class","nameDiv");return"group"===e.type?i.append("div").text("\u25c6\ufe0e").style("margin","auto"):(i.append("div").text((function(e){return e.name})),i.append("button").attr("class","headerButton sortButton").on("click",(function(e,t){H(t),Q(),Y()})),i.append("button").attr("class","headerButton clusterButton").style("font-weight","bold").on("click",(function(e,t){G(t),J(),Q(),Y(),S.call("clusterByColumn",a,t)}))),r.append("div").attr("class","info").html(t),r.each((function(e){j.select(this).selectAll(".visDiv").data("id"===e.type?[]:[e]).join((function(e){var t=e.append("div").attr("class","visDiv");return t.append("svg"),t}))})),n.append("div").attr("class","highlight"),r}))}));return n})).classed("active",(function(e){return null!==e.cluster})).style("padding-left",r).style("padding-right",r).style("padding-top",l).style("padding-bottom",l);n.select(".clusterButton").classed("active",(function(e){return null!==e.cluster})).text((function(e){return"ascending"===(t=e.cluster)?"\u22bb":"descending"===t?"\u22bc":"\u2261";var t})),n.select(".sortButton").classed("active",(function(e){return null!==e.sort})).style("visibility",(function(e){return u?null:"hidden"})).text((function(e){return"ascending"===e.sort?"\u21e3":"\u21e1"})),e.select("thead").selectAll("tr").each((function(){j.select(this).selectAll("th").each((function(e){if("group"===e.type)var t=5;else t=j.select(this).select(".nameDiv").node().clientWidth;var n=10;switch(e.type){case"numeric":var a=j.select(this).select(".visDiv svg").attr("width",t).attr("height",n),c=j.scaleLinear().domain(e.extent).rangeRound([0,t]),r=j.bin().domain(c.domain())(e.values),i=j.scaleLinear().domain([0,j.max(r,(function(e){return e.length}))]).range([n,0]);a.selectAll("rect").data(r).join((function(e){var t=e.append("rect").style("fill","#aaa");return t.append("title"),t})).attr("x",(function(e){return c(e.x0)})).attr("y",(function(e){return i(e.length)})).attr("width",(function(e){return c(e.x1)-c(e.x0)-1})).attr("height",(function(e){return i(0)-i(e.length)})).attr("data-tippy-content",(function(e){return"".concat(e.x0,"-").concat(e.x1,": ").concat(e.length)})).call((function(e){return Object(W.a)(e.nodes())}));break;case"categorical":var l=j.select(this).select(".visDiv svg").attr("width",t).attr("height",n),s=j.scaleOrdinal().domain(e.uniqueValues).range(j.schemeTableau10),u=j.scaleBand().domain(e.uniqueValues).range([0,t]),o=j.scaleLinear().domain([0,j.max(e.counts,(function(e){return e.count}))]).range([n,0]);l.selectAll("rect").data(e.counts).join((function(e){var t=e.append("rect");return t.append("title"),t})).attr("x",(function(e){return u(e.value)})).attr("y",(function(e){return o(e.count)})).attr("width",u.bandwidth()).attr("height",(function(e){return o(0)-o(e.count)})).attr("fill",(function(e){return s(e.value)})).attr("data-tippy-content",(function(e){return"".concat(e.value,": ").concat(e.count)})).call((function(e){return Object(W.a)(e.nodes())}));break;case"id":case"group":j.select(this).select(".visDiv svg").attr("width",t).attr("height",n);break;default:console.log("Unknown column type ".concat(e.type))}}))}))}(),function(){var s=function(e,t,n,a){switch(e){case"numeric":if(null!==t&&n&&t.valid){var c=j.format(".".concat(a,"r"))(t.median);return t.min===t.max?c:"<div class='range'><div class='extrema'>".concat(t.min,"</div><div>").concat(c,"</div><div class='extrema'>").concat(t.max,"<div>")}return null===t||n?"":t;case"categorical":if(null!==t&&n){var r=t.counts[0],i=t.counts.slice(1).filter((function(e){return e.count>0})),l=i.map((function(e){return"".concat(e.value," (").concat(e.count,")")})).join(", "),s="<div>".concat(r.value)+(r.count>1?" (".concat(r.count,")</div>"):"<div>"),u=1===i.length?"<div class='others' title=\"".concat(l,'">and 1 other category</div>'):i.length>1?"<div class='others' title=\"".concat(l,'">and ').concat(i.length," other categories</div>"):"<div class='others none'>dummy text</div>";return"<div class='categories'>".concat(s).concat(u,"</div>")}return null===t?"":t;case"id":if(null!==t&&n){var o=t.counts[0],d=t.counts.slice(1).filter((function(e){return e.count>0})),f=d.map((function(e){return e.value})).join(", "),h="<div>".concat(o.value,"<div>"),v=1===d.length?"<div class='others' title=\"".concat(f,'">and 1 other</div>'):d.length>1?"<div class='others' title=\"".concat(f,'">and ').concat(d.length," others</div>"):"";return"<div class='categories'>".concat(h).concat(v,"</div>")}return null===t?"":t;case"cluster":return"<div class='clusterSize'>n = ".concat(t,"</div>");case"group":return"<div class='group' align=\"center\">".concat(t,"</div>");case"Diamond":return'<div class=\'group\' align="center", style="opacity:0.5;" >'.concat(t,"</div>");default:return null}},u=[],o=c.find((function(e){return null!==e.sort})),d=c.find((function(e){return null!==e.cluster}));a.forEach((function(e){if(u.push(e),e.isCluster){var t=e.indeces.map((function(e){return n[e]})).filter((function(e){return e.pinned||e.expanded})),a=o?o.name:d.name,c=o?o.sort:d.cluster;t.sort((function(e,t){var n=e.values[a],r=t.values[a];return null===n&&null===r?0:null===n?1:null===r?-1:j[c](n,r)})),u.push.apply(u,Object(E.a)(t))}}));var f=j.max(a,(function(e){return e.isCluster?e.size:1}));e.select("tbody").selectAll("tr").data(u).join("tr").style("cursor","pointer").each((function(e,t){j.select(this).selectAll("td").data(c,(function(e){return e.name})).join((function(e){var t=e.append("td"),n=t.append("div").attr("class","cellDiv").append("div").attr("class","valueDiv");return n.append("div").attr("class","textDiv").classed("notId",(function(e){return"id"!==e.type})).style("text-align",(function(e){return"numeric"===e.type?"center":"left"})),n.append("div").attr("class","visDiv"),t})).classed("active",(function(e){return null!==e.cluster})).style("padding-left",r).style("padding-right",r).style("padding-top",l).style("padding-bottom",l).each((function(t,a){var c=e.values[t.name],r=j.select(this).classed("expanded",e.expanded).classed("pinned",e.pinned),l=j.select(this).classed("pinned"),u=j.select(this).classed("expanded");if(0===a)if(e.isCluster){var o=!1;e.indeces.forEach((function(e){o=n[e].expanded})),o?r.select(".valueDiv").html(s(t.type,"\u25bc\ufe0e",e.isCluster,t.maxDigits)):r.select(".valueDiv").html(s(t.type,"\u25b6\ufe0e",e.isCluster,t.maxDigits))}else l?r.select(".valueDiv").html(s("Diamond","\u25c6\ufe0e",e.isCluster,t.maxDigits)):u?r.select(".valueDiv").html(s("Diamond","\u25c7\ufe0e",e.isCluster,t.maxDigits)):r.select(".valueDiv").html(s(t.type,"",e.isCluster,t.maxDigits));else 1===a&&(u||l&&i)?r.select(".valueDiv .textDiv").html(s(t.type,"&emsp;"+c,e.isCluster,t.maxDigits)):r.select(".valueDiv .textDiv").html(s(t.type,c,e.isCluster,t.maxDigits));r.select(".cellDiv").selectAll(".clusterDiv").data(i&&null!==t.cluster?[c]:[]).join((function(e){var t=e.append("div").attr("class","clusterDiv");return t.append("div").attr("class","textDiv notId"),t.append("div").attr("class","visDiv"),t})).select(".textDiv").html(e.expanded?"":s("cluster",e.isCluster?e.size:1))}))})),e.select("tbody").selectAll("tr").each((function(n,a){j.select(this).selectAll("td").each((function(e){0===a&&(e.width=j.select(this).select(".valueDiv").node().clientWidth);var t=n.values[e.name];switch(e.type){case"numeric":j.select(this).select(".valueDiv .visDiv").selectAll("svg").data(null===t||n.isCluster&&!t.valid?[]:[t]).join("svg").attr("width",e.width).attr("height",10).each((function(t){var a=j.select(this),c=Math.max(Math.floor(1.5),1),r=j.scaleLinear().domain([e.extent[0],(e.extent[0]+e.extent[1])/2,e.extent[1]]).range(["#2171b5","#999","#cb181d"]),i=j.scaleLinear().domain(e.extent).range([3,e.width-3]);a.selectAll("line").data(n.isCluster?[[t.min,t.max,t.median],[t.q1,t.q2,t.median]]:[]).join((function(e){return e.append("line").style("margin",0).style("padding",0).style("stroke-linecap","round")})).attr("x1",(function(e){return i(e[0])})).attr("y1",3).attr("x2",(function(e){return i(e[1])})).attr("y2",3).style("stroke",(function(e){return r(e[2])})).style("stroke-width",(function(e,t){return 0===t?c:3})),a.selectAll("circle").data(n.isCluster?[t.median]:[t]).join("circle").attr("cx",(function(e){return i(e)})).attr("cy",3).attr("r",3).style("fill",(function(e){return r(e)}))}));break;case"categorical":j.select(this).select(".valueDiv .visDiv").selectAll("svg").data(null===t?[]:[t]).join("svg").attr("width",e.width).attr("height",10).each((function(t){var n=j.select(this),a=t.counts?t.counts:[{value:t,count:1}],c=j.scaleOrdinal().domain(e.uniqueValues).range(j.schemeTableau10),r=j.scaleBand().domain(e.uniqueValues).range([0,e.width]),i=j.scaleLinear().domain("row"===O?[0,j.max(a,(function(e){return e.count}))]:[0,e.maxCount]).range([10,0]);n.selectAll("rect").data(a).join((function(e){var t=e.append("rect");return t.append("title"),t})).attr("x",(function(e){return r(e.value)})).attr("y",(function(e){return i(e.count)})).attr("width",r.bandwidth()).attr("height",(function(e){return i(0)-i(e.count)})).attr("fill",(function(e){return c(e.value)})).attr("data-tippy-content",(function(e){return"".concat(e.value,": ").concat(e.count)})).call((function(e){return Object(W.a)(e.nodes())}))}));break;case"id":case"group":break;default:console.log("Unknown column type ".concat(e.type))}j.select(this).select(".clusterDiv .visDiv").selectAll("svg").data([n]).join("svg").attr("width",30).attr("height",10).each((function(e){var t=j.select(this),n=e.isCluster?e.size:1,a=j.scaleLinear().domain([0,f]).range([0,30]);t.selectAll("rect").data(e.expanded?[]:[e]).join("rect").attr("width",a(n)).attr("height",5).attr("fill","#bbb")}))})).on("mouseover",(function(n,a){e.selectAll("th").filter((function(e){return e===a})).select(".highlight").style("visibility",null),"interactive"===g&&e.selectAll("td").filter((function(e){return e===a||null!==e.cluster})).selectAll(".textDiv.notId").style("visibility",null),t.selectAll("path").style("visibility",(function(e){return e.source===a||e.target===a?null:"hidden"}))})).on("mouseout",(function(n,a){e.selectAll("th").filter((function(e){return e===a})).select(".highlight").style("visibility",(function(e){return null!==e.cluster?null:"hidden"})),"interactive"===g&&e.selectAll("td").filter((function(e){return e===a||null!==e.cluster})).selectAll(".textDiv.notId").style("visibility","hidden"),t.selectAll("path").style("visibility",null)}))})).on("mouseover",(function(t,n){e.select("tbody").selectAll("tr").filter((function(e){return e===n})).selectAll("td").classed("mouseOver",!0)})).on("mouseout",(function(t,n){e.select("tbody").selectAll("tr").filter((function(e){return e===n})).selectAll("td").classed("mouseOver",!1)})).on("click",(function(e,t){t.isCluster?(t.indeces.forEach((function(e){n[e].expanded=!n[e].expanded})),Y()):(t.pinned=!t.pinned,R=n.filter((function(e){return e.pinned})),A.call("selectIndices",this,R),t.pinned?(j.select(this).selectAll("td").classed("pinned",!0),Y()):Y())}))}(),K(),function(){var t=e.node()?e.node().clientHeight-4:0;e.selectAll("th").select(".highlight").style("height","".concat(t,"px")).style("visibility",(function(e){return null!==e.cluster?null:"hidden"}))}(),_()}function _(){if(e.node()){if(0===r.length&&!y)if(window.Worker){y=!0;var a=new P;a.postMessage({relations:r,columns:c,allData:n}),a.onmessage=function(e){if(e&&e.data){var t=e.data,n=t.relations,a=t.columns;r=n,c=a,y=!1,k.call("CalculateRelations",this,y)}}}else console.log("Your browser doesn't support web worker");if(t.style("display",x?null:"none"),x){var i=e.node().offsetWidth,l=200,s=i/l,u=e.node().getBoundingClientRect().x;e.selectAll("th").nodes().forEach((function(e,t){var n=e.getBoundingClientRect(),a=n.left,r=n.right;c[t].pos=a+(r-a)/2-u})),r.forEach((function(e){var t=e.source.pos,n=e.target.pos,a=l-(n-t)/s,c=j.interpolateNumber(t,n),r=j.interpolateNumber(l,a);e.points=[{x:c(0),y:r(0)},{x:c(.1),y:r(.5)},{x:c(.5),y:r(1)},{x:c(.9),y:r(.5)},{x:c(1),y:r(0)}]}));var o=j.line().x((function(e){return e.x})).y((function(e){return e.y})).curve(j.curveBasis),d=j.scaleSequential(j.interpolateRdBu).domain([1,-1]),f=j.scaleLinear().domain([0,1]).range([0,1]),h=j.scaleLinear().domain([0,1]).range([0,5]);t.attr("width",i).attr("height",l).selectAll("path").data(r).join("path").attr("d",(function(e){return o(e.points)})).style("fill","none").style("stroke",(function(e){return d(e.value)})).style("stroke-opacity",(function(e){return f(e.magnitude)})).style("stroke-width",(function(e){return h(e.magnitude)})).style("stroke-linecap","round").append("title").text((function(e){return e.value}))}}}function K(){var t=e.selectAll("td");t.selectAll(".textDiv.notId").style("visibility","text"===g||"both"===g?"visible":"hidden"),t.selectAll("svg").style("visibility","text"!==g?"visible":"hidden")}return M.applyClusterColumnLink=function(e,t){return arguments.length?(u=t&&"true"!==t?"descending":"ascending",l=e,M):l},M.applySortColumnLink=function(e,t){return arguments.length?(d=t&&"true"!==t?"descending":"ascending",s=e,M):s},M.applySimplification=function(e){if(!arguments.length)return f;f=e;var t=c.find((function(e){return null!==e.cluster}));return t&&"id"!==t.type&&(J(),Q()),Y(),M},M.simplificationMethod=function(e){return arguments.length?(h=e,i&&(J(),Q(),Y()),M):h},M.simplificationAmount=function(e){return arguments.length?(v=e,i&&(J(),Q(),Y()),M):v},M.simplificationRows=function(e){return arguments.length?(p=e,i&&(J(),Q(),Y()),M):p},M.transformBase=function(e){return arguments.length?(m=e,i&&(J(),Q(),Y()),M):m},M.unselect=function(){return n.forEach((function(e){e.pinned=!1})),Y(),M},M.selectIndices=function(e){return n.forEach((function(e){e.pinned=!1})),e.forEach((function(e){n.forEach((function(t){e.values.index===t.values.index&&(t.pinned=!0)}))})),Y(),M},M.selectInitialIndices=function(e){return arguments.length?(R=e,M):R},M.visualizationMode=function(e){return arguments.length?(g=e,K(),M):g},M.showLinks=function(e){return arguments.length?(x=e,Y(),M):x},M.categoryScaling=function(e){return arguments.length?(O=e,Y(),M):O},M.updateLinks=function(){return _(),M},M.on=function(){var e=S.on.apply(S,arguments);return e===S?M:e},M.onCalcRel=function(){var e=k.on.apply(k,arguments);return e===k?M:e},M.onSelectIndices=function(){var e=A.on.apply(A,arguments);return e===A?M:e},M.loadMore=function(e){return function(e){(D+=parseInt(e))<Object(E.a)(n).length?a=Object(E.a)(n).slice(0,D):(I=!0,a=Object(E.a)(n)),Y()}(e),M},M.isFullData=function(){return I},M.fullDataLength=function(){return Object(E.a)(n).length},M.displayRowNum=function(){return D},M}),G=n(44),J=function(e){var t=e.loadMore,n=e.isFullData,c=e.addrowNum,r=e.setAddRowNum,i=e.max,l=e.displayRowNum,s=e.refreshDisplayRowNum,u=Object(a.useState)(l||100),d=Object(o.a)(u,2),p=d[0],m=d[1];return Object(x.jsx)("div",{style:{padding:"2rem",display:"flex",justifyContent:"center",position:"sticky",left:"0",zIndex:"3",backgroundColor:"white"},children:Object(x.jsx)(f.a,{onSubmit:function(e){e.preventDefault(),t(c),s()>i?m(i):m(s()),r(100)},children:Object(x.jsxs)(h.a,{children:[Object(x.jsx)(v.a,{xs:"auto",children:Object(x.jsxs)(f.a.Text,{style:{position:"relative",top:".5rem",fontSize:"1rem"},children:["Showing ",p," of ",i," rows"]})}),Object(x.jsx)(v.a,{xs:"auto",children:Object(x.jsx)(G.a,{disabled:n,type:"submit",children:n?"End of Data":"Load ".concat(c," more rows")})}),Object(x.jsx)(v.a,{xs:"auto",children:Object(x.jsx)(f.a.Control,{type:"number",min:"1",max:i,value:c,onChange:function(e){return r(e.target.value)},disabled:n})})]})})})},Q=function(e){var t=e.data,n=e.clusterCol,c=e.clusterAscending,r=e.sortCol,i=e.sortAscending,l=e.mainPage,s=Object(a.useContext)(C),u=Object(o.a)(s,2),d=u[0],f=d.apply,h=d.method,v=d.amount,p=d.rows,m=d.transformBase,g=d.unselect,b=u[1],y=Object(a.useContext)(R),O=Object(o.a)(y,2),w=O[0],S=w.mode,k=w.showLinks,A=w.categoryScaling,D=w.mainIndices,I=w.prepareIndices,M=w.showSearch,L=O[1],N=Object(a.useRef)(),B=Object(a.useRef)(),q=Object(a.useRef)(),z=Object(a.useState)(!1),T=Object(o.a)(z,2),F=T[0],V=T[1],U=Object(a.useState)(100),P=Object(o.a)(U,2),W=P[0],G=P[1],Q=function(e,t,n){var c=Object(a.useRef)(0),r=Object(a.useRef)(0),i=Object(a.useRef)(!1);return function(){if(t.current)switch(n){case"horizontal":var a=t.current.scrollLeft;a!==c.current&&(c.current=a,i.current||(window.requestAnimationFrame((function(){e(a),i.current=!1})),i.current=!0));break;case"vertical":var l=t.current.scrollTop;l!==r.current&&(r.current=l,i.current||(window.requestAnimationFrame((function(){e(l),i.current=!1})),i.current=!0));break;case"both":var s=t.current.scrollLeft,u=t.current.scrollTop;s===c.current&&u===r.current||(c.current=s,r.current=u,i.current||(window.requestAnimationFrame((function(){e(s,u),i.current=!1})),i.current=!0));break;default:console.log("Invalid scroll type")}}}((function(){B.current&&B.current.updateLinks()}),q,"horizontal");Object(a.useEffect)((function(){B.current||(B.current=l?H().applySimplification(f).selectInitialIndices(D).simplificationMethod(h.name).simplificationAmount(v).simplificationRows(p).transformBase(m).visualizationMode(S).categoryScaling(A).on("clusterByColumn",(function(e){b({type:"setColumnInfo",columnType:e.type,unique:e.uniqueValues.length})})).onCalcRel("CalculateRelations",(function(e){L({type:"setCalculatingRelations",calculatingRelations:e})})).onSelectIndices("selectIndices",(function(e){L({type:"setMainIndices",mainIndices:e})})).applyClusterColumnLink(n,c).applySortColumnLink(r,i):H().applySimplification(f).selectInitialIndices(I).simplificationMethod(h.name).simplificationAmount(v).simplificationRows(p).transformBase(m).visualizationMode(S).categoryScaling(A).on("clusterByColumn",(function(e){b({type:"setColumnInfo",columnType:e.type,unique:e.uniqueValues.length})})).onCalcRel("CalculateRelations",(function(e){L({type:"setCalculatingRelations",calculatingRelations:e})})).onSelectIndices("selectIndices",(function(e){L({type:"setPrepareIndices",prepareIndices:e})})).applyClusterColumnLink(n,c).applySortColumnLink(r,i))}),[]),Object(a.useEffect)((function(){j.select(N.current).datum(t).call(B.current),L({type:"setCalculatingRelations",calculatingRelations:!0})}),[t]),Object(a.useEffect)((function(){B.current&&B.current.applySimplification(f)}),[f]),Object(a.useEffect)((function(){B.current&&B.current.simplificationMethod(h.name)}),[h]),Object(a.useEffect)((function(){B.current&&B.current.simplificationAmount(v)}),[v]),Object(a.useEffect)((function(){B.current&&B.current.simplificationRows(p)}),[p]),Object(a.useEffect)((function(){B.current&&B.current.transformBase(m)}),[m]),Object(a.useEffect)((function(){B.current&&B.current.unselect()}),[g]),Object(a.useEffect)((function(){B.current&&B.current.visualizationMode(S)}),[S]),Object(a.useEffect)((function(){B.current&&B.current.showLinks(k)}),[k]),Object(a.useEffect)((function(){B.current&&B.current.categoryScaling(A)}),[A]),Object(a.useEffect)((function(){if(B.current&&!M){var e=Object(E.a)(new Set([].concat(Object(E.a)(D),Object(E.a)(I))));B.current.selectIndices(e),L({type:"setMainIndices",mainIndices:e})}}),[M]),Object(a.useEffect)((function(){B.current&&B.current.isFullData()&&V(!0)}),[]);var Y=B.current&&B.current.fullDataLength(),_=B.current&&B.current.displayRowNum();return Object(x.jsxs)("div",{ref:q,onScroll:Q,style:{height:"100%",overflow:"auto"},children:[Object(x.jsx)("div",{ref:N}),f||F?Object(x.jsx)("div",{}):Object(x.jsx)(J,{loadMore:function(e){B.current&&(B.current.loadMore(e),B.current.isFullData()&&V(!0))},isFullData:F,addrowNum:W,setAddRowNum:G,max:Y,displayRowNum:_,refreshDisplayRowNum:function(){if(B.current)return B.current.displayRowNum()}})]})},Y=n(63),_=n(62),K=n(91),X=K.a.Header,Z=K.a.Body,$=K.a.Subtitle,ee=function(e){var t=e.title,n=e.subtitle,a=e.children;return Object(x.jsxs)(K.a,{children:[Object(x.jsx)(X,{children:t}),Object(x.jsxs)(Z,{children:[n&&Object(x.jsx)($,{className:"mb-2 text-muted",children:n}),Object(x.jsx)(m.a,{gap:3,children:a})]})]})},te=f.a.Group,ne=f.a.Label,ae=f.a.Check,ce=f.a.Select,re=f.a.Range,ie=f.a.Control,le=function(e){var t=e.simplification,n=Object(a.useContext)(C),c=Object(o.a)(n,2),r=c[0],i=r.apply,l=r.columnType,s=r.methods,u=r.method,d=r.amount,f=r.transformBase,h=r.unique,v=r.rows,p=r.unselect,m=c[1],g=Object(a.useContext)(R),j=Object(o.a)(g,2);Object(Y.a)(j[0]);var b=j[1];Object(a.useEffect)((function(){"true"===t&&m({type:"setApply",apply:!0})}),[]);return Object(x.jsxs)(ee,{title:"Simplification",subtitle:"".concat(l," column"),children:[Object(x.jsx)(te,{children:Object(x.jsx)(ae,{type:"checkbox",label:"Apply",id:"apply-simplification-checkbox",size:"sm",checked:i,disabled:"id"===l,onChange:function(e){m({type:"setApply",apply:e.target.checked})}})}),"numeric"===l&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)(te,{children:[Object(x.jsx)(ne,{children:"numeric column:"}),Object(x.jsx)(_.a,{label:"Method",children:Object(x.jsx)(ce,{value:u.name,onChange:function(e){m({type:"setMethod",method:s.find((function(t){return t.name===e.target.value}))})},children:s.map((function(e,t){var n=e.name;return Object(x.jsx)("option",{value:n,children:n},t)}))})})]}),"amount"===u.type?Object(x.jsxs)(te,{children:[Object(x.jsx)(ne,{children:"Amount"}),Object(x.jsx)(re,{min:0,max:100,step:1,value:100*d,onChange:function(e){m({type:"setAmount",amount:+e.target.value/100})}})]}):Object(x.jsxs)(te,{children:[Object(x.jsx)(ne,{children:"Number of rows"}),Object(x.jsx)(ie,{type:"number",min:1,max:h,step:1,value:v,onChange:function(e){""===e.target.value?m({type:"setRows",rows:1}):m({type:"setRows",rows:+e.target.value})}})]}),u.transform&&Object(x.jsxs)(te,{children:[Object(x.jsx)(ne,{children:"Depth weight"}),Object(x.jsx)(re,{min:100,max:400,step:1,value:100*f,onChange:function(e){m({type:"setTransformBase",transformBase:+e.target.value/100})}})]})]}),Object(x.jsx)(te,{children:Object(x.jsx)(G.a,{variant:"outline-secondary",size:"sm",value:!p,onClick:function(e){m({type:"setUnselect",unselect:"true"===e.target.value}),b({type:"setMainIndices",mainIndices:[]})},children:"Unselect all rows"})})]})},se=f.a.Group,ue=f.a.Select,oe=(f.a.Check,function(e){var t=e.visual,n=Object(a.useContext)(R),c=Object(o.a)(n,2),r=c[0],i=r.modes,l=r.mode,s=(r.showLinks,r.categoryScalingOptions,r.categoryScaling,r.calculatingRelations,c[1]);Object(a.useEffect)((function(){"both"===t?s({type:"setMode",mode:"both"}):"visualizations"===t?s({type:"setMode",mode:"visualizations"}):"interactive"===t&&s({type:"setMode",mode:"interactive"})}),[]);return Object(x.jsx)(ee,{title:"Visualization",children:Object(x.jsx)(se,{children:Object(x.jsx)(_.a,{label:"Mode",children:Object(x.jsx)(ue,{value:l,onChange:function(e){s({type:"setMode",mode:e.target.value})},children:i.map((function(e,t){return Object(x.jsx)("option",{value:e,children:e},t)}))})})})})}),de=n(35),fe=n(67),he=function(e){var t=e.data,n=Object(a.useContext)(R),c=Object(o.a)(n,2),r=c[0].showSearch,i=c[1],l=Object(a.useState)(t),s=Object(o.a)(l,2),u=s[0],d=s[1],h=function(){i({type:"setShowSearch",showSearch:!1})},v=Object(a.useState)(""),p=Object(o.a)(v,2),m=p[0],g=p[1];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(G.a,{variant:"light",onClick:function(){i({type:"setPrepareIndices",prepareIndices:[]}),d(t),i({type:"setShowSearch",showSearch:!0})},children:"Search Rows"}),Object(x.jsxs)(de.a,{size:"lg",show:r,onHide:h,backdrop:"static",keyboard:!1,children:[Object(x.jsx)(de.a.Header,{closeButton:!0,children:Object(x.jsx)(de.a.Title,{children:"Search Box"})}),Object(x.jsxs)(de.a.Body,{children:[Object(x.jsx)(f.a,{onSubmit:function(e){e.preventDefault();for(var n=t.columns,a=[],c=function(e){var c=n[e],r=t.filter((function(e){return e[c].toLowerCase().includes(m.toLowerCase())}));a=Object(E.a)(new Set([].concat(Object(E.a)(r),Object(E.a)(a))))},r=0;r<n.length;r++)c(r);a.columns=n,d(a),g("")},children:Object(x.jsxs)(fe.a,{className:"mb-3",children:[Object(x.jsx)(f.a.Control,{placeholder:"Type any relavant information to search",type:"text",onChange:function(e){return g(e.target.value)},value:m}),Object(x.jsx)(G.a,{variant:"outline-secondary",id:"button-addon2",type:"submit",children:"Search"})]})}),Object(x.jsx)(Q,{data:u})]}),Object(x.jsxs)(de.a.Footer,{children:[Object(x.jsx)(G.a,{variant:"secondary",onClick:function(){i({type:"setPrepareIndices",prepareIndices:[]}),i({type:"setShowSearch",showSearch:!1})},children:"Cancel"}),Object(x.jsx)(G.a,{variant:"primary",onClick:h,children:"Save Selections"})]})]})]})},ve=d.a.Brand,pe=f.a.Group,me=f.a.Control,ge=f.a.Select,je=[{name:"MT Cars",url:"/digestable/data/mtcars.csv"},{name:"NFL Combine 2017",url:"/digestable/data/NFL Combine 2017.csv"},{name:"Starbucks",url:"/digestable/data/starbucks.csv"},{name:"Electric Cars",url:"/digestable/data/ElectricCars.csv"},{name:"Stars",url:"/digestable/data/Stars.csv"}],be=function(){var e=Object(a.useState)(""),t=Object(o.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(null),i=Object(o.a)(r,2),l=i[0],b=i[1],y=Object(a.useState)(!1),O=Object(o.a)(y,2),w=O[0],C=O[1],k=function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(null),C(!0),e.prev=2,e.next=5,j.csv(t);case 5:(n=e.sent).forEach((function(e,t){return e.index=t})),b(n),C(!1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}(),A=new URLSearchParams(window.location.search),D=A.get("mode"),I=A.get("clusterCol"),R=A.get("clusterAscending"),E=A.get("sortCol"),L=A.get("sortAscending"),N=A.get("simplification"),B=A.get("visual"),q=A.get("dataset");return Object(a.useEffect)((function(){!function(e){var t=je.find((function(t){return t.name===e}));if(t){var n=t.url;c(n),k(n)}}(q)}),[]),Object(x.jsx)(S,{children:Object(x.jsxs)(M,{children:[Object(x.jsxs)(d.a,{bg:"dark",variant:"dark",children:[Object(x.jsxs)(ve,{className:"ms-2",children:[Object(x.jsx)("img",{src:"/digestable/digestable_512.png",alt:"digestable logo",height:"32px",className:"me-1"}),Object(x.jsxs)("span",{className:"text-align-bottom",children:["diges",Object(x.jsx)("b",{children:"table"})]})]}),Object(x.jsx)(f.a,{children:Object(x.jsxs)(pe,{as:h.a,className:"align-items-center",children:[Object(x.jsx)(v.a,{children:Object(x.jsxs)(ge,{value:n,onChange:function(e){var t=e.target.value;c(t),k(t)},children:[Object(x.jsx)("option",{value:"",disabled:!0,children:"Choose dataset"}),je.map((function(e,t){return Object(x.jsx)("option",{value:e.url,children:e.name},t)}))]})}),Object(x.jsx)(v.a,{sm:"auto",className:"text-center",children:Object(x.jsx)("span",{className:"text-light",children:"or"})}),Object(x.jsx)(v.a,{sm:"auto",children:Object(x.jsx)(me,{type:"file",accept:".csv",onChange:function(e){var t=1===e.target.files.length?e.target.files[0]:null;t&&(c(""),k(URL.createObjectURL(t)))}})}),l&&Object(x.jsx)(v.a,{children:Object(x.jsx)(he,{data:l})})]})})]}),l?Object(x.jsx)(p.a,{fluid:!0,style:{height:"calc(100% - 100px)"},children:Object(x.jsxs)(h.a,{style:{height:"100%"},children:[Object(x.jsx)(v.a,{xs:10,className:"mt-3",style:{height:"100%"},children:Object(x.jsx)(Q,{data:l,clusterCol:I,clusterAscending:R,sortCol:E,sortAscending:L,mainPage:!0})}),Object(x.jsx)(v.a,{className:"bg-dark",children:"simple"===D?Object(x.jsx)(m.a,{gap:3}):Object(x.jsxs)(m.a,{gap:3,children:[Object(x.jsx)(le,{simplification:N}),Object(x.jsx)(oe,{visual:B})]})})]})}):Object(x.jsx)(p.a,{children:Object(x.jsx)("div",{className:"m-4 text-center",children:w?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("h5",{children:"Loading..."}),Object(x.jsx)(g.a,{animation:"border"})]}):Object(x.jsx)("h3",{children:"No data"})})})]})})};i.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(be,{})}),document.getElementById("root"))}},[[82,1,2]]]);
//# sourceMappingURL=main.1e676bd0.chunk.js.map