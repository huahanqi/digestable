(this.webpackJsonpdigestable=this.webpackJsonpdigestable||[]).push([[0],{46:function(e,t,n){},49:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(19),i=n.n(c),l=(n(46),n(10)),u=n.n(l),s=n(36),o=n(5),d=n(57),f=n(58),h=n(54),v=n(37),p=n(55),m=n(61),g=n(56),j=n(4),b=n(2),x=n(1),y=[{name:"quantiles",type:"rows"},{name:"kmeans",type:"rows"},{name:"gap",type:"rows",transform:!0}],O={apply:!1,columnType:"numeric",methods:y,method:y[0],amount:.5,transformBase:1,unique:0,rows:10},w=function(e,t){switch(t.type){case"setApply":return Object(b.a)(Object(b.a)({},e),{},{apply:t.apply});case"setMethod":return Object(b.a)(Object(b.a)({},e),{},{method:t.method});case"setAmount":return Object(b.a)(Object(b.a)({},e),{},{amount:t.amount});case"setTransformBase":return Object(b.a)(Object(b.a)({},e),{},{transformBase:t.transformBase});case"setColumnInfo":return Object(b.a)(Object(b.a)({},e),{},{columnType:t.columnType,unique:t.unique,rows:Math.min(e.rows,t.unique)});case"setRows":return Object(b.a)(Object(b.a)({},e),{},{rows:t.rows});default:throw new Error("Invalid simplify context action: "+t.type)}},k=Object(r.createContext)(O),C=function(e){var t=e.children,n=Object(r.useReducer)(w,O),a=Object(o.a)(n,2),c=a[0],i=a[1];return Object(x.jsx)(k.Provider,{value:[c,i],children:t})},A=["text","visualizations","both","interactive"],D=["row","column"],R={modes:A,mode:A[0],showLinks:!1,categoryScalingOptions:D,categoryScaling:D[0],calculatingRelations:!0},S=function(e,t){switch(t.type){case"setMode":return Object(b.a)(Object(b.a)({},e),{},{mode:t.mode});case"setShowLinks":return Object(b.a)(Object(b.a)({},e),{},{showLinks:t.showLinks});case"setCategoryScaling":return Object(b.a)(Object(b.a)({},e),{},{categoryScaling:t.categoryScaling});case"setCalculatingRelations":return Object(b.a)(Object(b.a)({},e),{},{calculatingRelations:t.calculatingRelations});default:throw new Error("Invalid visualization context action: "+t.type)}},M=Object(r.createContext)(R),L=function(e){var t=e.children,n=Object(r.useReducer)(S,R),a=Object(o.a)(n,2),c=a[0],i=a[1];return Object(x.jsx)(M.Provider,{value:[c,i],children:t})},N=n(13);function B(e,t,n){for(var r=e[0].length,a=n-t,c=[],i=0;i<r;i++)c.push(0);for(var l=t;l<n;l++)for(var u=0;u<r;u++)c[u]=c[u]+e[l][u]/a;return c}function q(e,t){for(var n=e.length,r=Math.floor(n/t),a=[],c=0;c<t;c++){var i=r*c,l=r*(c+1);c+1===t&&(l=n),a.push(B(e,i,l))}return a}function E(e,t){for(var n,r,a,c=e.length,i=[];i.length<t;)r=0,a=c,n=Math.floor(Math.random()*(a-r)+r),-1===i.indexOf(n)&&i.push(n);for(var l=[],u=0;u<i.length;u++){var s=Object(N.a)(e[i[u]]);l.push(s)}return l}function z(e,t){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function I(e,t,n){if(n>50)return!0;if(!e||!e.length)return!1;for(var r=!0,a=0;a<t.length;a++)z(t[a],e[a])||(r=!1);return r}function F(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r]-t[r]);return n.reduce((function(e,t){return e+t*t}),0)}function T(e,t){for(var n={},r=0;r<t.length;r++)n[r]={points:[],indeces:[],centroid:t[r]};for(var a=0;a<e.length;a++){for(var c=e[a],i=void 0,l=void 0,u=0;u<t.length;u++){var s=t[u];if(0===u)i=u,l=F(c,s);else{var o=F(c,s);o<l&&(l=o,s,i=u)}}n[i].points.push(c),n[i].indeces.push(a)}return n}function V(e){for(var t=e.length,n=[],r=0;r<e[0].length;r++)n.push(0);for(var a=0;a<e.length;a++)for(var c=e[a],i=0;i<c.length;i++){var l=c[i];n[i]=n[i]+l/t}return n}function U(e,t,n){var r,a=[];for(var c in t){var i=t[c];r=i.points.length>0?V(i.points):E(e,1)[0],a.push(r)}return a}n(49);function W(){return new Worker(n.p+"static/js/compute-relation-web-worker.39ef6faf.worker.js")}var G=function(){var e=j.select(),t=j.select(),n=[],r=[],a=[],c=[],i=!1,l=!1,u="threshold",s=.9,d=20,f=1,h="text",v=!1,p=!1,m="row",g=["","NA","na"],x=function(e){return g.includes(e)},y=j.dispatch("clusterByColumn"),O=j.dispatch("CalculateRelations"),w=100,k=!1;function C(r){r.each((function(r){var c;t=j.select(this).selectAll(".linkSvg").data([[]]).join((function(e){return e.append("svg").attr("class","linkSvg")})),e=j.select(this).selectAll("table").data([[]]).join((function(e){var t=e.append("table");return t.append("thead").append("tr"),t.append("tbody"),t})),(a=(c=r).columns.map((function(e){return{name:e}}))).forEach((function(e){var t=e.name,n=c.map((function(e){return e[t]})),r=Array.from(n.reduce((function(e,t){return e.add(t)}),new Set)),a=r.filter((function(e){return!x(e)})),i=a.reduce((function(e,t){return e&&!isNaN(t)}),!0),l=i?a.map((function(e){return+e})):null;if(e.uniqueValues=r,i)if(l.length===c.length){l.sort((function(e,t){return j.ascending(e,t)}));var u=l.reduce((function(e,t,n,r){return e&&(0===n||t===r[n-1]+1)}),!0);e.type=u?"id":"numeric"}else 2===l.length&&l.includes(0)&&l.includes(1)?e.type="categorical":e.type="numeric";else r.length===c.length?e.type="id":e.type="categorical";"numeric"===e.type?(e.values=n.filter((function(e){return!x(e)})),e.extent=j.extent(l),e.maxDigits=j.max(l,D)):"categorical"===e.type&&(e.type="categorical",e.counts=A(r,n).sort((function(e,t){return t.count-e.count})),e.uniqueValues=e.counts.map((function(e){return e.value})))})),R(),S(),function(e){n=e.map((function(e,t){var n=Object(b.a)({},e);return a.forEach((function(e){var t=e.type,r=e.name,a=n[r];x(a)?n[r]=null:"numeric"===t&&(n[r]=+a)})),{initialIndex:t,isCluster:!1,cluster:null,pinned:!1,expanded:!1,values:n}}))}(r),M(),L(),B()}))}var A=function(e,t){return Object.entries(t.reduce((function(e,t){return e[t]++,e}),e.reduce((function(e,t){return e[t]=0,e}),{}))).map((function(e){var t=Object(o.a)(e,2);return{value:t[0],count:t[1]}})).sort((function(e,t){return j.descending(e.count,t.count)}))},D=function(e){var t=Math.log(10),n=String(e).split("."),r=Object(o.a)(n,2),a=r[0],c=r[1];a=Math.abs(a);var i=Math.floor(Math.log(e)/t)+1,l=c?a>0?c.length:Math.floor(Math.log(+e)/t)+1:0;return Math.max(i+l,1)};function R(){a.forEach((function(e){return e.sort=null}))}function S(){a.forEach((function(e){return e.cluster=null}))}function M(){!function(){var e=a.find((function(e){return e.cluster})),t=e?e.cluster:"ascending";n.sort((function(n,r){var a=e?n.values[e.name]:n.initialIndex,c=e?r.values[e.name]:r.initialIndex;return a===c?0:null===a?1:null===c?-1:j[t](a,c)}))}(),n.forEach((function(e){return e.expanded=!1}));var e=a.find((function(e){return e.cluster}));if(a.filter((function(e){return"numeric"!==e.type})).forEach((function(e){return e.maxCount=1})),i=l&&e&&"id"!==e.type){var t=e.name,c=e.type,s=e.cluster,h=n.map((function(e){return e.values[t]})),v=("numeric"===c?function(e,t){var n=function(e){var n="ascending"===t?1/f:f,r=j.scaleLinear().domain(j.extent(e)).range([0,1]);return e.map((function(e){return Math.pow(r(e),n)}))},r=function(e){var t=e.indexOf(null),n=t>-1?j.range(t,e.length):null;return[t>-1?e.slice(0,t):e,n,n?d-1:d]},a=function(e,t){return t?e.concat([t]):e};switch(u){case"quantiles":var c=r(e),i=Object(o.a)(c,3),l=i[0],s=i[1],h=function(e,t){var n=j.range(t),r=j.scaleQuantile().domain(e).range(n);return e.reduce((function(e,t,n){return e[r(t)].push(n),e}),n.map((function(){return[]})))}(l,i[2]);return"descending"===t&&h.reverse(),a(h,s);case"kmeans":var v=r(e),p=Object(o.a)(v,3),m=p[0],g=p[1],b=p[2],x=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e.length&&e[0].length&&e.length>=t){var r,a,c,i=0;for(c=n?q(e,t):E(e,t);!I(r,c,i);)r=Object(N.a)(c),i++,c=U(e,a=T(e,c));for(var l=[],u=0;u<t;u++)l.push(a[u]);return{clusters:l,centroids:c,iterations:i,converged:i<=50}}throw new Error("Invalid dataset")}(m.map((function(e){return[e]})),b),y=x.clusters;return y.sort((function(e,n){return j[t](e.centroid[0],n.centroid[0])})),a(y.map((function(e){return e.indeces})),g);case"gap":var O=r(e),w=Object(o.a)(O,3),k=w[0],C=w[1],A=w[2],D=function(e,t){var n=j.pairs(e).map((function(e,t){return{value:Math.abs(e[1]-e[0]),index:t}}));n.sort((function(e,t){return e.value===t.value?j.ascending(e.index,t.index):j.descending(e.value,t.value)}));var r=n.slice(0,t-1).map((function(e){return e.index}));return r.sort(j.ascending),r.unshift(-1),r.push(e.length-1),j.pairs(r).map((function(e){return j.range(e[0]+1,e[1]+1)}))}(n(k),A);return a(D,C);default:console.log("Unknown simplification method: ".concat(u))}}(h,s):function(e){return function(e){return e.reduce((function(e,t,n,r){return 0===n?e.push([n]):t===r[n-1]?e[e.length-1].push(n):e.push([n]),e}),[])}(e)}(h)).filter((function(e){return e.length>0}));r=v.map((function(e){var t=e.length;if(1===t)return n[e[0]].cluster=null,n[e[0]];var r={isCluster:!0,indeces:e,size:t,values:{}};return e.forEach((function(e){return n[e].cluster=r})),a.forEach((function(t){var a=t.name,c=t.type,i=t.uniqueValues;if("numeric"===c){var l=e.map((function(e){return n[e].values[a]}));if(l.length>0){var u=l.filter((function(e){return null!==e}));r.values[a]=u.length>0?{valid:!0,values:l,validValues:u,min:j.min(u),max:j.max(u),median:j.median(u),q1:j.quantile(u,.25),q2:j.quantile(u,.75)}:{valid:!1,values:l}}else r.values[a]=null}else if("categorical"===c){var s=e.map((function(e){return n[e].values[a]}));if(s.length>0){var o=A(i,s);t.maxCount=Math.max(t.maxCount,o[0].count),r.values[a]={counts:o}}else r.values[a]=null}else if("id"===c){var d=e.map((function(e){return n[e].values[a]}));if(d.length>0){var f=d.map((function(e){return{value:e,count:1}}));r.values[a]={counts:f}}else r.values[a]=null}else console.warn("Unknown column type: "+c)})),r}))}else w<Object(N.a)(n).length?r=Object(N.a)(n).slice(0,w):(r=Object(N.a)(n),k=!0)}function L(){var e=a.find((function(e){return null!==e.sort}));if(e){var t=e.name,n=e.type,c=e.sort,i=e.cluster;r.sort((function(e,r){switch(n){case"numeric":var a=e.isCluster?e.values[t].median:e.values[t],l=r.isCluster?r.values[t].median:r.values[t];return a===l?0:null===a?1:null===l?-1:j[c](a,l);case"categorical":if(i){var u=e.isCluster?e.values[t].counts[0].count:e.values[t]?1:null,s=r.isCluster?r.values[t].counts[0].count:r.values[t]?1:null;return u===s?0:null===u?1:null===s?-1:j[c](u,s)}var o=e.isCluster?e.values[t].counts[0].count/e.size:e.values[t],d=r.isCluster?r.values[t].counts[0].count/r.size:r.values[t];return o===d?0:null===o?1:null===d?-1:j[c](o,d);case"id":var f=e.isCluster?e.values[t].counts[0].value:e.values[t],h=r.isCluster?r.values[t].counts[0].value:r.values[t];return f===h?0:null===f?1:null===h?-1:j[c](f,h);default:return console.log("Unknown column type ".concat(n)),0}}))}}function B(){var c="5px",u="0px",s=a.find((function(e){return e.cluster})),o=l&&s&&"categorical"===s.type;e.selectAll("svg").attr("width",0),function(){var t=this,n=function(e){switch(e.type){case"numeric":var t=e.extent[0],n=e.extent[1];return t===n?t:"<div class='range'><div>".concat(t,"</div><div class='dash'><hr /></div><div>").concat(n,"</div>");case"categorical":return"<div>".concat(e.uniqueValues.length," categories</div>");case"id":return"<div>".concat(e.uniqueValues.length," unique values<div>");default:return null}},r=e.select("thead").select("tr").selectAll("th").data(a,(function(e){return e.name})).join((function(e){var r=e.append("th"),a=r.append("div").attr("class","headerDiv"),c=a.append("div").attr("class","nameDiv");return c.append("div").text((function(e){return e.name})),c.append("button").attr("class","headerButton sortButton").on("click",(function(e,t){!function(e){var t="descending"===e.sort?"ascending":"descending";R(),e.sort=t}(t),L(),B()})),c.append("button").attr("class","headerButton clusterButton").style("font-weight","bold").on("click",(function(e,n){!function(e){var t=null===e.cluster?"descending":"descending"===e.cluster?"ascending":null;S(),R(),e.cluster=t}(n),M(),L(),B(),y.call("clusterByColumn",t,n)})),a.append("div").attr("class","info").html(n),a.each((function(e){j.select(this).selectAll(".visDiv").data("id"===e.type?[]:[e]).join((function(e){var t=e.append("div").attr("class","visDiv");return t.append("svg"),t}))})),r.append("div").attr("class","highlight"),r})).classed("active",(function(e){return null!==e.cluster})).style("padding-left",c).style("padding-right",c).style("padding-top",u).style("padding-bottom",u);r.select(".clusterButton").classed("active",(function(e){return null!==e.cluster})).text((function(e){return"ascending"===(t=e.cluster)?"\u22bb":"descending"===t?"\u22bc":"\u2261";var t})),r.select(".sortButton").classed("active",(function(e){return null!==e.sort})).style("visibility",(function(e){return o?null:"hidden"})).text((function(e){return"ascending"===e.sort?"\u21e3":"\u21e1"})),e.select("thead").selectAll("tr").each((function(){j.select(this).selectAll("th").each((function(e){var t=j.select(this).select(".nameDiv").node().clientWidth;switch(e.type){case"numeric":var n=j.select(this).select(".visDiv svg").attr("width",t).attr("height",10),r=j.scaleLinear().domain(e.extent).rangeRound([0,t]),a=j.bin().domain(r.domain())(e.values),c=j.scaleLinear().domain([0,j.max(a,(function(e){return e.length}))]).range([10,0]);n.selectAll("rect").data(a).join((function(e){var t=e.append("rect").style("fill","#aaa");return t.append("title"),t})).attr("x",(function(e){return r(e.x0)})).attr("y",(function(e){return c(e.length)})).attr("width",(function(e){return r(e.x1)-r(e.x0)-1})).attr("height",(function(e){return c(0)-c(e.length)})).select("title").text((function(e){return"".concat(e.x0,"-").concat(e.x1,": ").concat(e.length)}));break;case"categorical":var i=j.select(this).select(".visDiv svg").attr("width",t).attr("height",10),l=j.scaleOrdinal().domain(e.uniqueValues).range(j.schemeTableau10),u=j.scaleBand().domain(e.uniqueValues).range([0,t]),s=j.scaleLinear().domain([0,j.max(e.counts,(function(e){return e.count}))]).range([10,0]);i.selectAll("rect").data(e.counts).join((function(e){var t=e.append("rect");return t.append("title"),t})).attr("x",(function(e){return u(e.value)})).attr("y",(function(e){return s(e.count)})).attr("width",u.bandwidth()).attr("height",(function(e){return s(0)-s(e.count)})).attr("fill",(function(e){return l(e.value)})).select("title").text((function(e){return"".concat(e.value,": ").concat(e.count)}));break;case"id":j.select(this).select(".visDiv svg").attr("width",t).attr("height",10);break;default:console.log("Unknown column type ".concat(e.type))}}))}))}(),function(){var l=function(e,t,n,r){switch(e){case"numeric":if(null!==t&&n&&t.valid){var a=j.format(".".concat(r,"r"))(t.median);return t.min===t.max?a:"<div class='range'><div class='extrema'>".concat(t.min,"</div><div>").concat(a,"</div><div class='extrema'>").concat(t.max,"<div>")}return null===t||n?"":t;case"categorical":if(null!==t&&n){var c=t.counts[0],i=t.counts.slice(1).filter((function(e){return e.count>0})),l=i.map((function(e){return"".concat(e.value," (").concat(e.count,")")})).join(", "),u="<div>".concat(c.value)+(c.count>1?" (".concat(c.count,")</div>"):"<div>"),s=1===i.length?"<div class='others' title=\"".concat(l,'">and 1 other category</div>'):i.length>1?"<div class='others' title=\"".concat(l,'">and ').concat(i.length," other categories</div>"):"<div class='others none'>dummy text</div>";return"<div class='categories'>".concat(u).concat(s,"</div>")}return null===t?"":t;case"id":if(null!==t&&n){var o=t.counts[0],d=t.counts.slice(1).filter((function(e){return e.count>0})),f=d.map((function(e){return e.value})).join(", "),h="<div>".concat(o.value,"<div>"),v=1===d.length?"<div class='others' title=\"".concat(f,'">and 1 other</div>'):d.length>1?"<div class='others' title=\"".concat(f,'">and ').concat(d.length," others</div>"):"";return"<div class='categories'>".concat(h).concat(v,"</div>")}return null===t?"":t;case"cluster":return"<div class='clusterSize'>n = ".concat(t,"</div>");default:return null}},s=[],o=a.find((function(e){return null!==e.sort})),d=a.find((function(e){return null!==e.cluster}));r.forEach((function(e){if(s.push(e),e.isCluster){var t=e.indeces.map((function(e){return n[e]})).filter((function(e){return e.pinned||e.expanded})),r=o?o.name:d.name,a=o?o.sort:d.cluster;t.sort((function(e,t){var n=e.values[r],c=t.values[r];return null===n&&null===c?0:null===n?1:null===c?-1:j[a](n,c)})),s.push.apply(s,Object(N.a)(t))}}));var f=j.max(r,(function(e){return e.isCluster?e.size:1}));e.select("tbody").selectAll("tr").data(s).join("tr").style("cursor","pointer").each((function(e){j.select(this).selectAll("td").data(a,(function(e){return e.name})).join((function(e){var t=e.append("td"),n=t.append("div").attr("class","cellDiv").append("div").attr("class","valueDiv");return n.append("div").attr("class","textDiv").classed("notId",(function(e){return"id"!==e.type})).style("text-align",(function(e){return"numeric"===e.type?"center":"left"})),n.append("div").attr("class","visDiv"),t})).classed("active",(function(e){return null!==e.cluster})).style("padding-left",c).style("padding-right",c).style("padding-top",u).style("padding-bottom",u).each((function(t){var n=e.values[t.name],r=j.select(this).classed("expanded",e.expanded).classed("pinned",e.pinned);r.select(".valueDiv .textDiv").html(l(t.type,n,e.isCluster,t.maxDigits)),r.select(".cellDiv").selectAll(".clusterDiv").data(i&&null!==t.cluster?[n]:[]).join((function(e){var t=e.append("div").attr("class","clusterDiv");return t.append("div").attr("class","textDiv notId"),t.append("div").attr("class","visDiv"),t})).select(".textDiv").html(e.expanded?"":l("cluster",e.isCluster?e.size:1))}))})),e.select("tbody").selectAll("tr").each((function(n,r){j.select(this).selectAll("td").each((function(e){0===r&&(e.width=j.select(this).select(".valueDiv").node().clientWidth);var t=n.values[e.name];switch(e.type){case"numeric":j.select(this).select(".valueDiv .visDiv").selectAll("svg").data(null===t||n.isCluster&&!t.valid?[]:[t]).join("svg").attr("width",e.width).attr("height",10).each((function(t){var r=j.select(this),a=Math.max(Math.floor(1.5),1),c=j.scaleLinear().domain([e.extent[0],(e.extent[0]+e.extent[1])/2,e.extent[1]]).range(["#2171b5","#999","#cb181d"]),i=j.scaleLinear().domain(e.extent).range([3,e.width-3]);r.selectAll("line").data(n.isCluster?[[t.min,t.max,t.median],[t.q1,t.q2,t.median]]:[]).join((function(e){return e.append("line").style("margin",0).style("padding",0).style("stroke-linecap","round")})).attr("x1",(function(e){return i(e[0])})).attr("y1",3).attr("x2",(function(e){return i(e[1])})).attr("y2",3).style("stroke",(function(e){return c(e[2])})).style("stroke-width",(function(e,t){return 0===t?a:3})),r.selectAll("circle").data(n.isCluster?[t.median]:[t]).join("circle").attr("cx",(function(e){return i(e)})).attr("cy",3).attr("r",3).style("fill",(function(e){return c(e)}))}));break;case"categorical":j.select(this).select(".valueDiv .visDiv").selectAll("svg").data(null===t?[]:[t]).join("svg").attr("width",e.width).attr("height",10).each((function(t){var n=j.select(this),r=t.counts?t.counts:[{value:t,count:1}],a=j.scaleOrdinal().domain(e.uniqueValues).range(j.schemeTableau10),c=j.scaleBand().domain(e.uniqueValues).range([0,e.width]),i=j.scaleLinear().domain("row"===m?[0,j.max(r,(function(e){return e.count}))]:[0,e.maxCount]).range([10,0]);n.selectAll("rect").data(r).join((function(e){var t=e.append("rect");return t.append("title"),t})).attr("x",(function(e){return c(e.value)})).attr("y",(function(e){return i(e.count)})).attr("width",c.bandwidth()).attr("height",(function(e){return i(0)-i(e.count)})).attr("fill",(function(e){return a(e.value)})).select("title").text((function(e){return"".concat(e.value,": ").concat(e.count)}))}));break;case"id":break;default:console.log("Unknown column type ".concat(e.type))}j.select(this).select(".clusterDiv .visDiv").selectAll("svg").data([n]).join("svg").attr("width",30).attr("height",10).each((function(e){var t=j.select(this),n=e.isCluster?e.size:1,r=j.scaleLinear().domain([0,f]).range([0,30]);t.selectAll("rect").data(e.expanded?[]:[e]).join("rect").attr("width",r(n)).attr("height",5).attr("fill","#bbb")}))})).on("mouseover",(function(n,r){e.selectAll("th").filter((function(e){return e===r})).select(".highlight").style("visibility",null),"interactive"===h&&e.selectAll("td").filter((function(e){return e===r||null!==e.cluster})).selectAll(".textDiv.notId").style("visibility",null),t.selectAll("path").style("visibility",(function(e){return e.source===r||e.target===r?null:"hidden"}))})).on("mouseout",(function(n,r){e.selectAll("th").filter((function(e){return e===r})).select(".highlight").style("visibility",(function(e){return null!==e.cluster?null:"hidden"})),"interactive"===h&&e.selectAll("td").filter((function(e){return e===r||null!==e.cluster})).selectAll(".textDiv.notId").style("visibility","hidden"),t.selectAll("path").style("visibility",null)}))})).on("mouseover",(function(t,n){e.select("tbody").selectAll("tr").filter((function(e){return e===n})).selectAll("td").classed("mouseOver",!0)})).on("mouseout",(function(t,n){e.select("tbody").selectAll("tr").filter((function(e){return e===n})).selectAll("td").classed("mouseOver",!1)})).on("click",(function(e,t){t.isCluster?(t.indeces.forEach((function(e){n[e].expanded=!n[e].expanded})),B()):(t.pinned=!t.pinned,t.pinned?j.select(this).selectAll("td").classed("pinned",!0):B())}))}(),F(),function(){var t=e.node()?e.node().clientHeight-4:0;e.selectAll("th").select(".highlight").style("height","".concat(t,"px")).style("visibility",(function(e){return null!==e.cluster?null:"hidden"}))}(),z()}function z(){if(e.node()){if(0===c.length&&!p)if(window.Worker){p=!0;var r=new W;r.postMessage({relations:c,columns:a,allData:n}),r.onmessage=function(e){if(e&&e.data){var t=e.data,n=t.relations,r=t.columns;c=n,a=r,p=!1,O.call("CalculateRelations",this,p)}}}else console.log("Your browser doesn't support web worker");if(t.style("display",v?null:"none"),v){var i=e.node().offsetWidth,l=200,u=i/l,s=e.node().getBoundingClientRect().x;e.selectAll("th").nodes().forEach((function(e,t){var n=e.getBoundingClientRect(),r=n.left,c=n.right;a[t].pos=r+(c-r)/2-s})),c.forEach((function(e){var t=e.source.pos,n=e.target.pos,r=l-(n-t)/u,a=j.interpolateNumber(t,n),c=j.interpolateNumber(l,r);e.points=[{x:a(0),y:c(0)},{x:a(.1),y:c(.5)},{x:a(.5),y:c(1)},{x:a(.9),y:c(.5)},{x:a(1),y:c(0)}]}));var o=j.line().x((function(e){return e.x})).y((function(e){return e.y})).curve(j.curveBasis),d=j.scaleSequential(j.interpolateRdBu).domain([1,-1]),f=j.scaleLinear().domain([0,1]).range([0,1]),h=j.scaleLinear().domain([0,1]).range([0,5]);t.attr("width",i).attr("height",l).selectAll("path").data(c).join("path").attr("d",(function(e){return o(e.points)})).style("fill","none").style("stroke",(function(e){return d(e.value)})).style("stroke-opacity",(function(e){return f(e.magnitude)})).style("stroke-width",(function(e){return h(e.magnitude)})).style("stroke-linecap","round").append("title").text((function(e){return e.value}))}}}function F(){var t=e.selectAll("td");t.selectAll(".textDiv.notId").style("visibility","text"===h||"both"===h?"visible":"hidden"),t.selectAll("svg").style("visibility","text"!==h?"visible":"hidden")}return C.applySimplification=function(e){if(!arguments.length)return l;l=e;var t=a.find((function(e){return null!==e.cluster}));return t&&"id"!==t.type&&(M(),L(),B()),C},C.simplificationMethod=function(e){return arguments.length?(u=e,i&&(M(),L(),B()),C):u},C.simplificationAmount=function(e){return arguments.length?(s=e,i&&(M(),L(),B()),C):s},C.simplificationRows=function(e){return arguments.length?(d=e,i&&(M(),L(),B()),C):d},C.transformBase=function(e){return arguments.length?(f=e,i&&(M(),L(),B()),C):f},C.visualizationMode=function(e){return arguments.length?(h=e,F(),C):h},C.showLinks=function(e){return arguments.length?(v=e,B(),C):v},C.categoryScaling=function(e){return arguments.length?(m=e,B(),C):m},C.updateLinks=function(){return z(),C},C.on=function(){var e=y.on.apply(y,arguments);return e===y?C:e},C.onCalcRel=function(){var e=O.on.apply(O,arguments);return e===O?C:e},C.loadMore=function(e){return function(e){w+=parseInt(e),console.log(w),w<Object(N.a)(n).length?r=Object(N.a)(n).slice(0,w):(k=!0,r=Object(N.a)(n)),B()}(e),C},C.isFullData=function(){return k},C.fullDataLength=function(){return Object(N.a)(n).length},C.displayRowNum=function(){return w},C},P=n(60),H=function(e){var t=e.loadMore,n=e.isFullData,a=e.addrowNum,c=e.setAddRowNum,i=e.max,l=e.displayRowNum,u=e.refreshDisplayRowNum,s=Object(r.useState)(l||100),d=Object(o.a)(s,2),p=d[0],m=d[1];return Object(x.jsx)("div",{style:{padding:"2rem",display:"flex",justifyContent:"center",position:"sticky",left:"0",zIndex:"3",backgroundColor:"white"},children:Object(x.jsx)(f.a,{onSubmit:function(e){e.preventDefault(),t(a),u()>i?m(i):m(u()),c(100)},children:Object(x.jsxs)(h.a,{children:[Object(x.jsx)(v.a,{xs:"auto",children:Object(x.jsxs)(f.a.Text,{style:{position:"relative",top:".5rem",fontSize:"1rem"},children:["Showing ",p," of ",i," rows"]})}),Object(x.jsx)(v.a,{xs:"auto",children:Object(x.jsx)(P.a,{disabled:n,type:"submit",children:n?"End of Data":"Load ".concat(a," more rows")})}),Object(x.jsx)(v.a,{xs:"auto",children:Object(x.jsx)(f.a.Control,{type:"number",min:"1",max:i,value:a,onChange:function(e){return c(e.target.value)},disabled:n})})]})})})},J=function(e){var t=e.data,n=Object(r.useContext)(k),a=Object(o.a)(n,2),c=a[0],i=c.apply,l=c.method,u=c.amount,s=c.rows,d=c.transformBase,f=a[1],h=Object(r.useContext)(M),v=Object(o.a)(h,2),p=v[0],m=p.mode,g=p.showLinks,b=p.categoryScaling,y=v[1],O=Object(r.useRef)(),w=Object(r.useRef)(),C=Object(r.useRef)(),A=Object(r.useState)(!1),D=Object(o.a)(A,2),R=D[0],S=D[1],L=Object(r.useState)(100),N=Object(o.a)(L,2),B=N[0],q=N[1],E=function(e,t,n){var a=Object(r.useRef)(0),c=Object(r.useRef)(0),i=Object(r.useRef)(!1);return function(){if(t.current)switch(n){case"horizontal":var r=t.current.scrollLeft;r!==a.current&&(a.current=r,i.current||(window.requestAnimationFrame((function(){e(r),i.current=!1})),i.current=!0));break;case"vertical":var l=t.current.scrollTop;l!==c.current&&(c.current=l,i.current||(window.requestAnimationFrame((function(){e(l),i.current=!1})),i.current=!0));break;case"both":var u=t.current.scrollLeft,s=t.current.scrollTop;u===a.current&&s===c.current||(a.current=u,c.current=s,i.current||(window.requestAnimationFrame((function(){e(u,s),i.current=!1})),i.current=!0));break;default:console.log("Invalid scroll type")}}}((function(){w.current&&w.current.updateLinks()}),C,"horizontal");Object(r.useEffect)((function(){w.current||(w.current=G().applySimplification(i).simplificationMethod(l.name).simplificationAmount(u).simplificationRows(s).transformBase(d).visualizationMode(m).categoryScaling(b).on("clusterByColumn",(function(e){f({type:"setColumnInfo",columnType:e.type,unique:e.uniqueValues.length})})).onCalcRel("CalculateRelations",(function(e){y({type:"setCalculatingRelations",calculatingRelations:e})})))}),[]),Object(r.useEffect)((function(){j.select(O.current).datum(t).call(w.current),y({type:"setCalculatingRelations",calculatingRelations:!0})}),[t]),Object(r.useEffect)((function(){w.current&&w.current.applySimplification(i)}),[i]),Object(r.useEffect)((function(){w.current&&w.current.simplificationMethod(l.name)}),[l]),Object(r.useEffect)((function(){w.current&&w.current.simplificationAmount(u)}),[u]),Object(r.useEffect)((function(){w.current&&w.current.simplificationRows(s)}),[s]),Object(r.useEffect)((function(){w.current&&w.current.transformBase(d)}),[d]),Object(r.useEffect)((function(){w.current&&w.current.visualizationMode(m)}),[m]),Object(r.useEffect)((function(){w.current&&w.current.showLinks(g)}),[g]),Object(r.useEffect)((function(){w.current&&w.current.categoryScaling(b)}),[b]),Object(r.useEffect)((function(){w.current&&w.current.isFullData()&&S(!0)}),[]);var z=w.current&&w.current.fullDataLength(),I=w.current&&w.current.displayRowNum();return Object(x.jsxs)("div",{ref:C,onScroll:E,style:{height:"100%",overflow:"auto"},children:[Object(x.jsx)("div",{ref:O}),i||R?Object(x.jsx)("div",{}):Object(x.jsx)(H,{loadMore:function(e){w.current&&(w.current.loadMore(e),w.current.isFullData()&&S(!0))},isFullData:R,addrowNum:B,setAddRowNum:q,max:z,displayRowNum:I,refreshDisplayRowNum:function(){if(w.current)return w.current.displayRowNum()}})]})},Q=n(38),Y=n(59),_=Y.a.Header,K=Y.a.Body,X=Y.a.Subtitle,Z=function(e){var t=e.title,n=e.subtitle,r=e.children;return Object(x.jsxs)(Y.a,{children:[Object(x.jsx)(_,{children:t}),Object(x.jsxs)(K,{children:[n&&Object(x.jsx)(X,{className:"mb-2 text-muted",children:n}),Object(x.jsx)(m.a,{gap:3,children:r})]})]})},$=f.a.Group,ee=f.a.Label,te=f.a.Check,ne=f.a.Select,re=f.a.Range,ae=f.a.Control,ce=function(){var e=Object(r.useContext)(k),t=Object(o.a)(e,2),n=t[0],a=n.apply,c=n.columnType,i=n.methods,l=n.method,u=n.amount,s=n.transformBase,d=n.unique,f=n.rows,h=t[1];return Object(x.jsxs)(Z,{title:"Simplification",subtitle:"".concat(c," column"),children:[Object(x.jsx)($,{children:Object(x.jsx)(te,{type:"checkbox",label:"Apply",id:"apply-simplification-checkbox",size:"sm",checked:a,disabled:"id"===c,onChange:function(e){h({type:"setApply",apply:e.target.checked})}})}),"numeric"===c&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)($,{children:[Object(x.jsx)(ee,{children:"numeric column:"}),Object(x.jsx)(Q.a,{label:"Method",children:Object(x.jsx)(ne,{value:l.name,onChange:function(e){h({type:"setMethod",method:i.find((function(t){return t.name===e.target.value}))})},children:i.map((function(e,t){var n=e.name;return Object(x.jsx)("option",{value:n,children:n},t)}))})})]}),"amount"===l.type?Object(x.jsxs)($,{children:[Object(x.jsx)(ee,{children:"Amount"}),Object(x.jsx)(re,{min:0,max:100,step:1,value:100*u,onChange:function(e){h({type:"setAmount",amount:+e.target.value/100})}})]}):Object(x.jsxs)($,{children:[Object(x.jsx)(ee,{children:"Number of rows"}),Object(x.jsx)(ae,{type:"number",min:1,max:d,step:1,value:f,onChange:function(e){h({type:"setRows",rows:+e.target.value})}})]}),l.transform&&Object(x.jsxs)($,{children:[Object(x.jsx)(ee,{children:"Depth weight"}),Object(x.jsx)(re,{min:100,max:400,step:1,value:100*s,onChange:function(e){h({type:"setTransformBase",transformBase:+e.target.value/100})}})]})]})]})},ie=f.a.Group,le=f.a.Select,ue=f.a.Check,se=function(){var e=Object(r.useContext)(M),t=Object(o.a)(e,2),n=t[0],a=n.modes,c=n.mode,i=n.showLinks,l=n.categoryScalingOptions,u=n.categoryScaling,s=n.calculatingRelations,d=t[1],f=function(e){d({type:"setShowLinks",showLinks:e.target.checked})};return Object(x.jsxs)(Z,{title:"Visualization",children:[Object(x.jsx)(ie,{children:Object(x.jsx)(Q.a,{label:"Mode",children:Object(x.jsx)(le,{value:c,onChange:function(e){d({type:"setMode",mode:e.target.value})},children:a.map((function(e,t){return Object(x.jsx)("option",{value:e,children:e},t)}))})})}),Object(x.jsx)(ie,{children:s?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(ue,{type:"checkbox",label:"Show links",id:"show-links-checkbox",size:"sm",checked:i,onChange:f,disabled:s}),Object(x.jsx)("p",{className:"text-muted small",style:{marginBottom:"0rem"},children:"Calculating..."})]}):Object(x.jsx)(ue,{type:"checkbox",label:"Show links",id:"show-links-checkbox",size:"sm",checked:i,onChange:f,disabled:s})}),Object(x.jsx)(ie,{children:Object(x.jsx)(Q.a,{label:"Category scaling",children:Object(x.jsx)(le,{value:u,onChange:function(e){d({type:"setCategoryScaling",categoryScaling:e.target.value})},children:l.map((function(e,t){return Object(x.jsx)("option",{value:e,children:e},t)}))})})})]})},oe=d.a.Brand,de=f.a.Group,fe=f.a.Control,he=f.a.Select,ve=[{name:"MT Cars",url:"/digestable/data/mtcars.csv"},{name:"NFL Combine 2017",url:"/digestable/data/NFL Combine 2017.csv"}],pe=function(){var e=Object(r.useState)(""),t=Object(o.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),i=Object(o.a)(c,2),l=i[0],b=i[1],y=Object(r.useState)(!1),O=Object(o.a)(y,2),w=O[0],k=O[1],A=function(){var e=Object(s.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(null),k(!0),e.prev=2,e.next=5,j.csv(t);case 5:n=e.sent,b(n),k(!1),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),D=new URLSearchParams(window.location.search).get("mode");return Object(x.jsx)(C,{children:Object(x.jsxs)(L,{children:[Object(x.jsxs)(d.a,{bg:"dark",variant:"dark",children:[Object(x.jsxs)(oe,{className:"ms-2",children:[Object(x.jsx)("img",{src:"/digestable/digestable_512.png",alt:"digestable logo",height:"32px",className:"me-1"}),Object(x.jsxs)("span",{className:"text-align-bottom",children:["diges",Object(x.jsx)("b",{children:"table"})]})]}),Object(x.jsx)(f.a,{children:Object(x.jsxs)(de,{as:h.a,className:"align-items-center",children:[Object(x.jsx)(v.a,{children:Object(x.jsxs)(he,{value:n,onChange:function(e){var t=e.target.value;a(t),A(t)},children:[Object(x.jsx)("option",{value:"",disabled:!0,children:"Choose dataset"}),ve.map((function(e,t){return Object(x.jsx)("option",{value:e.url,children:e.name},t)}))]})}),Object(x.jsx)(v.a,{sm:"auto",className:"text-center",children:Object(x.jsx)("span",{className:"text-light",children:"or"})}),Object(x.jsx)(v.a,{children:Object(x.jsx)(fe,{type:"file",accept:".csv",onChange:function(e){var t=1===e.target.files.length?e.target.files[0]:null;t&&(a(""),A(URL.createObjectURL(t)))}})})]})})]}),l?Object(x.jsx)(p.a,{fluid:!0,style:{height:"calc(100% - 100px)"},children:Object(x.jsxs)(h.a,{style:{height:"100%"},children:[Object(x.jsx)(v.a,{xs:10,className:"mt-3",style:{height:"100%"},children:Object(x.jsx)(J,{data:l})}),Object(x.jsx)(v.a,{className:"bg-dark",children:"simple"===D?Object(x.jsx)(m.a,{gap:3}):Object(x.jsxs)(m.a,{gap:3,children:[Object(x.jsx)(ce,{}),Object(x.jsx)(se,{})]})})]})}):Object(x.jsx)(p.a,{children:Object(x.jsx)("div",{className:"m-4 text-center",children:w?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("h5",{children:"Loading..."}),Object(x.jsx)(g.a,{animation:"border"})]}):Object(x.jsx)("h3",{children:"No data"})})})]})})};i.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(pe,{})}),document.getElementById("root"))}},[[52,1,2]]]);
//# sourceMappingURL=main.3141c5f5.chunk.js.map