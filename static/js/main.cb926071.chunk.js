(this.webpackJsonpdigestable=this.webpackJsonpdigestable||[]).push([[0],{49:function(e,t,n){},52:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(19),i=n.n(c),l=(n(49),n(10)),u=n.n(l),s=n(37),o=n(5),d=n(64),f=n(65),h=n(61),v=n(38),p=n(62),m=n(68),g=n(63),j=n(4),b=n(2),x=n(1),y=[{name:"quantiles",type:"rows"},{name:"kmeans",type:"rows"},{name:"gap",type:"rows",transform:!0}],O={apply:!1,columnType:"numeric",methods:y,method:y[0],amount:.5,transformBase:1,unique:0,rows:10,unselect:!1},w=function(e,t){switch(t.type){case"setApply":return Object(b.a)(Object(b.a)({},e),{},{apply:t.apply});case"setMethod":return Object(b.a)(Object(b.a)({},e),{},{method:t.method});case"setAmount":return Object(b.a)(Object(b.a)({},e),{},{amount:t.amount});case"setTransformBase":return Object(b.a)(Object(b.a)({},e),{},{transformBase:t.transformBase});case"setColumnInfo":return Object(b.a)(Object(b.a)({},e),{},{columnType:t.columnType,unique:t.unique,rows:Math.min(e.rows,t.unique)});case"setRows":return Object(b.a)(Object(b.a)({},e),{},{rows:t.rows});case"setUnselect":return Object(b.a)(Object(b.a)({},e),{},{unselect:t.unselect});default:throw new Error("Invalid simplify context action: "+t.type)}},C=Object(r.createContext)(O),k=function(e){var t=e.children,n=Object(r.useReducer)(w,O),a=Object(o.a)(n,2),c=a[0],i=a[1];return Object(x.jsx)(C.Provider,{value:[c,i],children:t})},A=["text","visualizations","both","interactive"],D=["row","column"],S={modes:A,mode:A[0],showLinks:!1,categoryScalingOptions:D,categoryScaling:D[0],calculatingRelations:!0},R=function(e,t){switch(t.type){case"setMode":return Object(b.a)(Object(b.a)({},e),{},{mode:t.mode});case"setShowLinks":return Object(b.a)(Object(b.a)({},e),{},{showLinks:t.showLinks});case"setCategoryScaling":return Object(b.a)(Object(b.a)({},e),{},{categoryScaling:t.categoryScaling});case"setCalculatingRelations":return Object(b.a)(Object(b.a)({},e),{},{calculatingRelations:t.calculatingRelations});default:throw new Error("Invalid visualization context action: "+t.type)}},L=Object(r.createContext)(S),M=function(e){var t=e.children,n=Object(r.useReducer)(R,S),a=Object(o.a)(n,2),c=a[0],i=a[1];return Object(x.jsx)(L.Provider,{value:[c,i],children:t})},E=n(13);function N(e,t,n){for(var r=e[0].length,a=n-t,c=[],i=0;i<r;i++)c.push(0);for(var l=t;l<n;l++)for(var u=0;u<r;u++)c[u]=c[u]+e[l][u]/a;return c}function B(e,t){for(var n=e.length,r=Math.floor(n/t),a=[],c=0;c<t;c++){var i=r*c,l=r*(c+1);c+1===t&&(l=n),a.push(N(e,i,l))}return a}function q(e,t){for(var n,r,a,c=e.length,i=[];i.length<t;)r=0,a=c,n=Math.floor(Math.random()*(a-r)+r),-1===i.indexOf(n)&&i.push(n);for(var l=[],u=0;u<i.length;u++){var s=Object(E.a)(e[i[u]]);l.push(s)}return l}function z(e,t){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function I(e,t,n){if(n>50)return!0;if(!e||!e.length)return!1;for(var r=!0,a=0;a<t.length;a++)z(t[a],e[a])||(r=!1);return r}function F(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r]-t[r]);return n.reduce((function(e,t){return e+t*t}),0)}function T(e,t){for(var n={},r=0;r<t.length;r++)n[r]={points:[],indeces:[],centroid:t[r]};for(var a=0;a<e.length;a++){for(var c=e[a],i=void 0,l=void 0,u=0;u<t.length;u++){var s=t[u];if(0===u)i=u,l=F(c,s);else{var o=F(c,s);o<l&&(l=o,s,i=u)}}n[i].points.push(c),n[i].indeces.push(a)}return n}function V(e){for(var t=e.length,n=[],r=0;r<e[0].length;r++)n.push(0);for(var a=0;a<e.length;a++)for(var c=e[a],i=0;i<c.length;i++){var l=c[i];n[i]=n[i]+l/t}return n}function U(e,t,n){var r,a=[];for(var c in t){var i=t[c];r=i.points.length>0?V(i.points):q(e,1)[0],a.push(r)}return a}n(52);function W(){return new Worker(n.p+"static/js/compute-relation-web-worker.dc856299.worker.js")}var G=n(33),P=(n(53),function(){var e=j.select(),t=j.select(),n=[],r=[],a=[],c=[],i=!1,l=NaN,u=NaN,s="ascending",d="ascending",f=!1,h="threshold",v=.9,p=20,m=1,g="text",x=!1,y=!1,O="row",w=["","NA","na"],C=function(e){return w.includes(e)},k=j.dispatch("clusterByColumn"),A=j.dispatch("CalculateRelations"),D=100,S=!1;function R(r){r.each((function(r){if(t=j.select(this).selectAll(".linkSvg").data([[]]).join((function(e){return e.append("svg").attr("class","linkSvg")})),e=j.select(this).selectAll("table").data([[]]).join((function(e){var t=e.append("table");return t.append("thead").append("tr"),t.append("tbody"),t})),function(e){a=e.columns.map((function(e){return{name:e}}));var t={name:"group",type:"group"};a.unshift(t),a.filter((function(e){return"group"!==e.type})).forEach((function(t){var n=t.name,r=e.map((function(e){return e[n]})),a=Array.from(r.reduce((function(e,t){return e.add(t)}),new Set)),c=a.filter((function(e){return!C(e)})),i=c.reduce((function(e,t){return e&&!isNaN(t)}),!0),l=i?c.map((function(e){return+e})):null;if(t.uniqueValues=a,i)if(l.length===e.length){l.sort((function(e,t){return j.ascending(e,t)}));var u=l.reduce((function(e,t,n,r){return e&&(0===n||t===r[n-1]+1)}),!0);t.type=u?"id":"numeric"}else 2===l.length&&l.includes(0)&&l.includes(1)?t.type="categorical":t.type="numeric";else a.length===e.length?t.type="id":t.type="categorical";"numeric"===t.type?(t.values=r.filter((function(e){return!C(e)})),t.extent=j.extent(l),t.maxDigits=j.max(l,M)):"categorical"===t.type&&(t.type="categorical",t.counts=L(a,r).sort((function(e,t){return t.count-e.count})),t.uniqueValues=t.counts.map((function(e){return e.value})))})),N(),z()}(r),n=r.map((function(e,t){var n=Object(b.a)({},e);return a.forEach((function(e){var t=e.type,r=e.name,a=n[r];C(a)?n[r]=null:"numeric"===t&&(n[r]=+a)})),{initialIndex:t,isCluster:!1,cluster:null,pinned:!1,expanded:!1,values:n}})),l){var c=a.find((function(e){return e.name===l}));c&&(V(c),"ascending"===s&&V(c))}if(u){var i=a.find((function(e){return e.name===u}));i&&(F(i),"ascending"===d&&F(i))}P(),H(),J()}))}var L=function(e,t){return Object.entries(t.reduce((function(e,t){return e[t]++,e}),e.reduce((function(e,t){return e[t]=0,e}),{}))).map((function(e){var t=Object(o.a)(e,2);return{value:t[0],count:t[1]}})).sort((function(e,t){return j.descending(e.count,t.count)}))},M=function(e){var t=Math.log(10),n=String(e).split("."),r=Object(o.a)(n,2),a=r[0],c=r[1];a=Math.abs(a);var i=Math.floor(Math.log(e)/t)+1,l=c?a>0?c.length:Math.floor(Math.log(+e)/t)+1:0;return Math.max(i+l,1)};function N(){a.forEach((function(e){return e.sort=null}))}function z(){a.forEach((function(e){return e.cluster=null}))}function F(e){var t="descending"===e.sort?"ascending":"descending";N(),e.sort=t}function V(e){var t=null===e.cluster?"descending":"descending"===e.cluster?"ascending":null;z(),N(),e.cluster=t}function P(){!function(){var e=a.find((function(e){return e.cluster})),t=e?e.cluster:"ascending";n.sort((function(n,r){var a=e?n.values[e.name]:n.initialIndex,c=e?r.values[e.name]:r.initialIndex;return a===c?0:null===a?1:null===c?-1:j[t](a,c)}))}(),n.forEach((function(e){return e.expanded=!1}));var e=a.find((function(e){return e.cluster}));if(a.filter((function(e){return"numeric"!==e.type})).forEach((function(e){return e.maxCount=1})),i=f&&e&&"id"!==e.type){var t=e.name,c=e.type,l=e.cluster,u=n.map((function(e){return e.values[t]})),s=("numeric"===c?function(e,t){var n=function(e){var n="ascending"===t?1/m:m,r=j.scaleLinear().domain(j.extent(e)).range([0,1]);return e.map((function(e){return Math.pow(r(e),n)}))},r=function(e){var t=e.indexOf(null),n=t>-1?j.range(t,e.length):null;return[t>-1?e.slice(0,t):e,n,n?p-1:p]},a=function(e,t){return t?e.concat([t]):e};switch(h){case"quantiles":var c=r(e),i=Object(o.a)(c,3),l=i[0],u=i[1],s=function(e,t){var n=j.range(t),r=j.scaleQuantile().domain(e).range(n);return e.reduce((function(e,t,n){return e[r(t)].push(n),e}),n.map((function(){return[]})))}(l,i[2]);return"descending"===t&&s.reverse(),a(s,u);case"kmeans":var d=r(e),f=Object(o.a)(d,3),v=f[0],g=f[1],b=f[2],x=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e.length&&e[0].length&&e.length>=t){var r,a,c,i=0;for(c=n?B(e,t):q(e,t);!I(r,c,i);)r=Object(E.a)(c),i++,c=U(e,a=T(e,c));for(var l=[],u=0;u<t;u++)l.push(a[u]);return{clusters:l,centroids:c,iterations:i,converged:i<=50}}throw new Error("Invalid dataset")}(v.map((function(e){return[e]})),b),y=x.clusters;return y.sort((function(e,n){return j[t](e.centroid[0],n.centroid[0])})),a(y.map((function(e){return e.indeces})),g);case"gap":var O=r(e),w=Object(o.a)(O,3),C=w[0],k=w[1],A=w[2],D=function(e,t){var n=j.pairs(e).map((function(e,t){return{value:Math.abs(e[1]-e[0]),index:t}}));n.sort((function(e,t){return e.value===t.value?j.ascending(e.index,t.index):j.descending(e.value,t.value)}));var r=n.slice(0,t-1).map((function(e){return e.index}));return r.sort(j.ascending),r.unshift(-1),r.push(e.length-1),j.pairs(r).map((function(e){return j.range(e[0]+1,e[1]+1)}))}(n(C),A);return a(D,k);default:console.log("Unknown simplification method: ".concat(h))}}(u,l):function(e){return function(e){return e.reduce((function(e,t,n,r){return 0===n?e.push([n]):t===r[n-1]?e[e.length-1].push(n):e.push([n]),e}),[])}(e)}(u)).filter((function(e){return e.length>0}));r=s.map((function(e){var t=e.length;if(1===t)return n[e[0]].cluster=null,n[e[0]];var r={isCluster:!0,indeces:e,size:t,values:{}};return e.forEach((function(e){return n[e].cluster=r})),a.forEach((function(t){var a=t.name,c=t.type,i=t.uniqueValues;if("numeric"===c){var l=e.map((function(e){return n[e].values[a]}));if(l.length>0){var u=l.filter((function(e){return null!==e}));r.values[a]=u.length>0?{valid:!0,values:l,validValues:u,min:j.min(u),max:j.max(u),median:j.median(u),q1:j.quantile(u,.25),q2:j.quantile(u,.75)}:{valid:!1,values:l}}else r.values[a]=null}else if("categorical"===c){var s=e.map((function(e){return n[e].values[a]}));if(s.length>0){var o=L(i,s);t.maxCount=Math.max(t.maxCount,o[0].count),r.values[a]={counts:o}}else r.values[a]=null}else if("id"===c){var d=e.map((function(e){return n[e].values[a]}));if(d.length>0){var f=d.map((function(e){return{value:e,count:1}}));r.values[a]={counts:f}}else r.values[a]=null}else"group"===c||console.warn("Unknown column type: "+c)})),r}))}else D<Object(E.a)(n).length?r=Object(E.a)(n).slice(0,D):(r=Object(E.a)(n),S=!0)}function H(){var e=a.find((function(e){return null!==e.sort}));if(e){var t=e.name,n=e.type,c=e.sort,i=e.cluster;r.sort((function(e,r){switch(n){case"numeric":var a=e.isCluster?e.values[t].median:e.values[t],l=r.isCluster?r.values[t].median:r.values[t];return a===l?0:null===a?1:null===l?-1:j[c](a,l);case"categorical":if(i){var u=e.isCluster?e.values[t].counts[0].count:e.values[t]?1:null,s=r.isCluster?r.values[t].counts[0].count:r.values[t]?1:null;return u===s?0:null===u?1:null===s?-1:j[c](u,s)}var o=e.isCluster?e.values[t].counts[0].count/e.size:e.values[t],d=r.isCluster?r.values[t].counts[0].count/r.size:r.values[t];return o===d?0:null===o?1:null===d?-1:j[c](o,d);case"id":var f=e.isCluster?e.values[t].counts[0].value:e.values[t],h=r.isCluster?r.values[t].counts[0].value:r.values[t];return f===h?0:null===f?1:null===h?-1:j[c](f,h);default:return console.log("Unknown column type ".concat(n)),0}}))}}function J(){var c="5px",l="0px",u=a.find((function(e){return e.cluster})),s=f&&u&&"categorical"===u.type;e.selectAll("svg").attr("width",0),function(){var t=function(e){switch(e.type){case"numeric":var t=e.extent[0],n=e.extent[1];return t===n?t:"<div class='range'><div>".concat(t,"</div><div class='dash'><hr /></div><div>").concat(n,"</div>");case"categorical":return"<div>".concat(e.uniqueValues.length," categories</div>");case"id":return"<div>".concat(e.uniqueValues.length," unique values<div>");default:return null}},n=e.select("thead").select("tr").selectAll("th").data(a,(function(e){return e.name})).join((function(e){var n=e.append("th");n.each((function(e){var r=this;j.select(this).selectAll(".headerDiv").data("group"===e.type?[]:[e]).join((function(e){var a=e.append("div").attr("class","headerDiv"),c=a.append("div").attr("class","nameDiv");return c.append("div").text((function(e){return e.name})),c.append("button").attr("class","headerButton sortButton").on("click",(function(e,t){F(t),H(),J()})),c.append("button").attr("class","headerButton clusterButton").style("font-weight","bold").on("click",(function(e,t){V(t),P(),H(),J(),k.call("clusterByColumn",r,t)})),a.append("div").attr("class","info").html(t),a.each((function(e){j.select(this).selectAll(".visDiv").data("id"===e.type?[]:[e]).join((function(e){var t=e.append("div").attr("class","visDiv");return t.append("svg"),t}))})),n.append("div").attr("class","highlight"),a}))}));return n})).classed("active",(function(e){return null!==e.cluster})).style("padding-left",c).style("padding-right",c).style("padding-top",l).style("padding-bottom",l);n.select(".clusterButton").classed("active",(function(e){return null!==e.cluster})).text((function(e){return"ascending"===(t=e.cluster)?"\u22bb":"descending"===t?"\u22bc":"\u2261";var t})),n.select(".sortButton").classed("active",(function(e){return null!==e.sort})).style("visibility",(function(e){return s?null:"hidden"})).text((function(e){return"ascending"===e.sort?"\u21e3":"\u21e1"})),e.select("thead").selectAll("tr").each((function(){j.select(this).selectAll("th").each((function(e){if("group"===e.type)var t=5;else t=j.select(this).select(".nameDiv").node().clientWidth;var n=10;switch(e.type){case"numeric":var r=j.select(this).select(".visDiv svg").attr("width",t).attr("height",n),a=j.scaleLinear().domain(e.extent).rangeRound([0,t]),c=j.bin().domain(a.domain())(e.values),i=j.scaleLinear().domain([0,j.max(c,(function(e){return e.length}))]).range([n,0]);r.selectAll("rect").data(c).join((function(e){var t=e.append("rect").style("fill","#aaa");return t.append("title"),t})).attr("x",(function(e){return a(e.x0)})).attr("y",(function(e){return i(e.length)})).attr("width",(function(e){return a(e.x1)-a(e.x0)-1})).attr("height",(function(e){return i(0)-i(e.length)})).attr("data-tippy-content",(function(e){return"".concat(e.x0,"-").concat(e.x1,": ").concat(e.length)})).call((function(e){return Object(G.a)(e.nodes())}));break;case"categorical":var l=j.select(this).select(".visDiv svg").attr("width",t).attr("height",n),u=j.scaleOrdinal().domain(e.uniqueValues).range(j.schemeTableau10),s=j.scaleBand().domain(e.uniqueValues).range([0,t]),o=j.scaleLinear().domain([0,j.max(e.counts,(function(e){return e.count}))]).range([n,0]);l.selectAll("rect").data(e.counts).join((function(e){var t=e.append("rect");return t.append("title"),t})).attr("x",(function(e){return s(e.value)})).attr("y",(function(e){return o(e.count)})).attr("width",s.bandwidth()).attr("height",(function(e){return o(0)-o(e.count)})).attr("fill",(function(e){return u(e.value)})).attr("data-tippy-content",(function(e){return"".concat(e.value,": ").concat(e.count)})).call((function(e){return Object(G.a)(e.nodes())}));break;case"id":case"group":j.select(this).select(".visDiv svg").attr("width",t).attr("height",n);break;default:console.log("Unknown column type ".concat(e.type))}}))}))}(),function(){var u=function(e,t,n,r){switch(e){case"numeric":if(null!==t&&n&&t.valid){var a=j.format(".".concat(r,"r"))(t.median);return t.min===t.max?a:"<div class='range'><div class='extrema'>".concat(t.min,"</div><div>").concat(a,"</div><div class='extrema'>").concat(t.max,"<div>")}return null===t||n?"":t;case"categorical":if(null!==t&&n){var c=t.counts[0],i=t.counts.slice(1).filter((function(e){return e.count>0})),l=i.map((function(e){return"".concat(e.value," (").concat(e.count,")")})).join(", "),u="<div>".concat(c.value)+(c.count>1?" (".concat(c.count,")</div>"):"<div>"),s=1===i.length?"<div class='others' title=\"".concat(l,'">and 1 other category</div>'):i.length>1?"<div class='others' title=\"".concat(l,'">and ').concat(i.length," other categories</div>"):"<div class='others none'>dummy text</div>";return"<div class='categories'>".concat(u).concat(s,"</div>")}return null===t?"":t;case"id":if(null!==t&&n){var o=t.counts[0],d=t.counts.slice(1).filter((function(e){return e.count>0})),f=d.map((function(e){return e.value})).join(", "),h="<div>".concat(o.value,"<div>"),v=1===d.length?"<div class='others' title=\"".concat(f,'">and 1 other</div>'):d.length>1?"<div class='others' title=\"".concat(f,'">and ').concat(d.length," others</div>"):"";return"<div class='categories'>".concat(h).concat(v,"</div>")}return null===t?"":t;case"cluster":return"<div class='clusterSize'>n = ".concat(t,"</div>");case"group":return"<div class='group' align=\"center\">".concat(t,"</div>");case"Diamond":return'<div class=\'group\' align="center", style="opacity:0.5;" >'.concat(t,"</div>");default:return null}},s=[],o=a.find((function(e){return null!==e.sort})),d=a.find((function(e){return null!==e.cluster}));console.log(o),console.log(d),r.forEach((function(e){if(s.push(e),e.isCluster){var t=e.indeces.map((function(e){return n[e]})).filter((function(e){return e.pinned||e.expanded})),r=o?o.name:d.name,a=o?o.sort:d.cluster;t.sort((function(e,t){var n=e.values[r],c=t.values[r];return null===n&&null===c?0:null===n?1:null===c?-1:j[a](n,c)})),s.push.apply(s,Object(E.a)(t))}}));var h=j.max(r,(function(e){return e.isCluster?e.size:1}));e.select("tbody").selectAll("tr").data(s).join("tr").style("cursor","pointer").each((function(e,t){j.select(this).selectAll("td").data(a,(function(e){return e.name})).join((function(e){var t=e.append("td"),n=t.append("div").attr("class","cellDiv").append("div").attr("class","valueDiv");return n.append("div").attr("class","textDiv").classed("notId",(function(e){return"id"!==e.type})).style("text-align",(function(e){return"numeric"===e.type?"center":"left"})),n.append("div").attr("class","visDiv"),t})).classed("active",(function(e){return null!==e.cluster})).style("padding-left",c).style("padding-right",c).style("padding-top",l).style("padding-bottom",l).each((function(t,r){var a=e.values[t.name],c=j.select(this).classed("expanded",e.expanded).classed("pinned",e.pinned),l=j.select(this).classed("pinned"),s=j.select(this).classed("expanded");if(f&&1===r&&(s||l))c.select(".valueDiv .textDiv").html(u(t.type,"&emsp;"+a,e.isCluster,t.maxDigits));else if(f&&0===r&&(s||l))l?c.select(".valueDiv").html(u("Diamond","\u25c6\ufe0e",e.isCluster,t.maxDigits)):c.select(".valueDiv").html(u("Diamond","\u25c7\ufe0e",e.isCluster,t.maxDigits));else if(0===r)if(f)if(e.isCluster){var o=!1;e.indeces.forEach((function(e){o=n[e].expanded})),o?c.select(".valueDiv").html(u(t.type,"\u25bc\ufe0e",e.isCluster,t.maxDigits)):c.select(".valueDiv").html(u(t.type,"\u25b6\ufe0e",e.isCluster,t.maxDigits))}else c.select(".valueDiv").html(u(t.type,"\u25b6\ufe0e",e.isCluster,t.maxDigits));else c.select(".valueDiv").html(u(t.type,"",e.isCluster,t.maxDigits));else c.select(".valueDiv .textDiv").html(u(t.type,a,e.isCluster,t.maxDigits));c.select(".cellDiv").selectAll(".clusterDiv").data(i&&null!==t.cluster?[a]:[]).join((function(e){var t=e.append("div").attr("class","clusterDiv");return t.append("div").attr("class","textDiv notId"),t.append("div").attr("class","visDiv"),t})).select(".textDiv").html(e.expanded?"":u("cluster",e.isCluster?e.size:1))}))})),e.select("tbody").selectAll("tr").each((function(n,r){j.select(this).selectAll("td").each((function(e){0===r&&(e.width=j.select(this).select(".valueDiv").node().clientWidth);var t=n.values[e.name];switch(e.type){case"numeric":j.select(this).select(".valueDiv .visDiv").selectAll("svg").data(null===t||n.isCluster&&!t.valid?[]:[t]).join("svg").attr("width",e.width).attr("height",10).each((function(t){var r=j.select(this),a=Math.max(Math.floor(1.5),1),c=j.scaleLinear().domain([e.extent[0],(e.extent[0]+e.extent[1])/2,e.extent[1]]).range(["#2171b5","#999","#cb181d"]),i=j.scaleLinear().domain(e.extent).range([3,e.width-3]);r.selectAll("line").data(n.isCluster?[[t.min,t.max,t.median],[t.q1,t.q2,t.median]]:[]).join((function(e){return e.append("line").style("margin",0).style("padding",0).style("stroke-linecap","round")})).attr("x1",(function(e){return i(e[0])})).attr("y1",3).attr("x2",(function(e){return i(e[1])})).attr("y2",3).style("stroke",(function(e){return c(e[2])})).style("stroke-width",(function(e,t){return 0===t?a:3})),r.selectAll("circle").data(n.isCluster?[t.median]:[t]).join("circle").attr("cx",(function(e){return i(e)})).attr("cy",3).attr("r",3).style("fill",(function(e){return c(e)}))}));break;case"categorical":j.select(this).select(".valueDiv .visDiv").selectAll("svg").data(null===t?[]:[t]).join("svg").attr("width",e.width).attr("height",10).each((function(t){var n=j.select(this),r=t.counts?t.counts:[{value:t,count:1}],a=j.scaleOrdinal().domain(e.uniqueValues).range(j.schemeTableau10),c=j.scaleBand().domain(e.uniqueValues).range([0,e.width]),i=j.scaleLinear().domain("row"===O?[0,j.max(r,(function(e){return e.count}))]:[0,e.maxCount]).range([10,0]);n.selectAll("rect").data(r).join((function(e){var t=e.append("rect");return t.append("title"),t})).attr("x",(function(e){return c(e.value)})).attr("y",(function(e){return i(e.count)})).attr("width",c.bandwidth()).attr("height",(function(e){return i(0)-i(e.count)})).attr("fill",(function(e){return a(e.value)})).attr("data-tippy-content",(function(e){return"".concat(e.value,": ").concat(e.count)})).call((function(e){return Object(G.a)(e.nodes())}))}));break;case"id":case"group":break;default:console.log("Unknown column type ".concat(e.type))}j.select(this).select(".clusterDiv .visDiv").selectAll("svg").data([n]).join("svg").attr("width",30).attr("height",10).each((function(e){var t=j.select(this),n=e.isCluster?e.size:1,r=j.scaleLinear().domain([0,h]).range([0,30]);t.selectAll("rect").data(e.expanded?[]:[e]).join("rect").attr("width",r(n)).attr("height",5).attr("fill","#bbb")}))})).on("mouseover",(function(n,r){e.selectAll("th").filter((function(e){return e===r})).select(".highlight").style("visibility",null),"interactive"===g&&e.selectAll("td").filter((function(e){return e===r||null!==e.cluster})).selectAll(".textDiv.notId").style("visibility",null),t.selectAll("path").style("visibility",(function(e){return e.source===r||e.target===r?null:"hidden"}))})).on("mouseout",(function(n,r){e.selectAll("th").filter((function(e){return e===r})).select(".highlight").style("visibility",(function(e){return null!==e.cluster?null:"hidden"})),"interactive"===g&&e.selectAll("td").filter((function(e){return e===r||null!==e.cluster})).selectAll(".textDiv.notId").style("visibility","hidden"),t.selectAll("path").style("visibility",null)}))})).on("mouseover",(function(t,n){e.select("tbody").selectAll("tr").filter((function(e){return e===n})).selectAll("td").classed("mouseOver",!0)})).on("mouseout",(function(t,n){e.select("tbody").selectAll("tr").filter((function(e){return e===n})).selectAll("td").classed("mouseOver",!1)})).on("click",(function(e,t){t.isCluster?(t.indeces.forEach((function(e){n[e].expanded=!n[e].expanded})),J()):(t.pinned=!t.pinned,t.pinned?(j.select(this).selectAll("td").classed("pinned",!0),J()):J())}))}(),Y(),function(){var t=e.node()?e.node().clientHeight-4:0;e.selectAll("th").select(".highlight").style("height","".concat(t,"px")).style("visibility",(function(e){return null!==e.cluster?null:"hidden"}))}(),Q()}function Q(){if(e.node()){if(0===c.length&&!y)if(window.Worker){y=!0;var r=new W;r.postMessage({relations:c,columns:a,allData:n}),r.onmessage=function(e){if(e&&e.data){var t=e.data,n=t.relations,r=t.columns;c=n,a=r,y=!1,A.call("CalculateRelations",this,y)}}}else console.log("Your browser doesn't support web worker");if(t.style("display",x?null:"none"),x){var i=e.node().offsetWidth,l=200,u=i/l,s=e.node().getBoundingClientRect().x;e.selectAll("th").nodes().forEach((function(e,t){var n=e.getBoundingClientRect(),r=n.left,c=n.right;a[t].pos=r+(c-r)/2-s})),c.forEach((function(e){var t=e.source.pos,n=e.target.pos,r=l-(n-t)/u,a=j.interpolateNumber(t,n),c=j.interpolateNumber(l,r);e.points=[{x:a(0),y:c(0)},{x:a(.1),y:c(.5)},{x:a(.5),y:c(1)},{x:a(.9),y:c(.5)},{x:a(1),y:c(0)}]}));var o=j.line().x((function(e){return e.x})).y((function(e){return e.y})).curve(j.curveBasis),d=j.scaleSequential(j.interpolateRdBu).domain([1,-1]),f=j.scaleLinear().domain([0,1]).range([0,1]),h=j.scaleLinear().domain([0,1]).range([0,5]);t.attr("width",i).attr("height",l).selectAll("path").data(c).join("path").attr("d",(function(e){return o(e.points)})).style("fill","none").style("stroke",(function(e){return d(e.value)})).style("stroke-opacity",(function(e){return f(e.magnitude)})).style("stroke-width",(function(e){return h(e.magnitude)})).style("stroke-linecap","round").append("title").text((function(e){return e.value}))}}}function Y(){var t=e.selectAll("td");t.selectAll(".textDiv.notId").style("visibility","text"===g||"both"===g?"visible":"hidden"),t.selectAll("svg").style("visibility","text"!==g?"visible":"hidden")}return R.applyClusterColumnLink=function(e,t){return arguments.length?(s=t&&"true"!==t?"descending":"ascending",l=e,R):l},R.applySortColumnLink=function(e,t){return arguments.length?(d=t&&"true"!==t?"descending":"ascending",u=e,R):u},R.applySimplification=function(e){if(!arguments.length)return f;f=e;var t=a.find((function(e){return null!==e.cluster}));return t&&"id"!==t.type&&(P(),H()),J(),R},R.simplificationMethod=function(e){return arguments.length?(h=e,i&&(P(),H(),J()),R):h},R.simplificationAmount=function(e){return arguments.length?(v=e,i&&(P(),H(),J()),R):v},R.simplificationRows=function(e){return arguments.length?(p=e,i&&(P(),H(),J()),R):p},R.transformBase=function(e){return arguments.length?(m=e,i&&(P(),H(),J()),R):m},R.unselect=function(){return n.forEach((function(e){e.pinned=!1})),J(),R},R.visualizationMode=function(e){return arguments.length?(g=e,Y(),R):g},R.showLinks=function(e){return arguments.length?(x=e,J(),R):x},R.categoryScaling=function(e){return arguments.length?(O=e,J(),R):O},R.updateLinks=function(){return Q(),R},R.on=function(){var e=k.on.apply(k,arguments);return e===k?R:e},R.onCalcRel=function(){var e=A.on.apply(A,arguments);return e===A?R:e},R.loadMore=function(e){return function(e){(D+=parseInt(e))<Object(E.a)(n).length?r=Object(E.a)(n).slice(0,D):(S=!0,r=Object(E.a)(n)),J()}(e),R},R.isFullData=function(){return S},R.fullDataLength=function(){return Object(E.a)(n).length},R.displayRowNum=function(){return D},R}),H=n(67),J=function(e){var t=e.loadMore,n=e.isFullData,a=e.addrowNum,c=e.setAddRowNum,i=e.max,l=e.displayRowNum,u=e.refreshDisplayRowNum,s=Object(r.useState)(l||100),d=Object(o.a)(s,2),p=d[0],m=d[1];return Object(x.jsx)("div",{style:{padding:"2rem",display:"flex",justifyContent:"center",position:"sticky",left:"0",zIndex:"3",backgroundColor:"white"},children:Object(x.jsx)(f.a,{onSubmit:function(e){e.preventDefault(),t(a),u()>i?m(i):m(u()),c(100)},children:Object(x.jsxs)(h.a,{children:[Object(x.jsx)(v.a,{xs:"auto",children:Object(x.jsxs)(f.a.Text,{style:{position:"relative",top:".5rem",fontSize:"1rem"},children:["Showing ",p," of ",i," rows"]})}),Object(x.jsx)(v.a,{xs:"auto",children:Object(x.jsx)(H.a,{disabled:n,type:"submit",children:n?"End of Data":"Load ".concat(a," more rows")})}),Object(x.jsx)(v.a,{xs:"auto",children:Object(x.jsx)(f.a.Control,{type:"number",min:"1",max:i,value:a,onChange:function(e){return c(e.target.value)},disabled:n})})]})})})},Q=function(e){var t=e.data,n=e.clusterCol,a=e.clusterAscending,c=e.sortCol,i=e.sortAscending,l=Object(r.useContext)(C),u=Object(o.a)(l,2),s=u[0],d=s.apply,f=s.method,h=s.amount,v=s.rows,p=s.transformBase,m=s.unselect,g=u[1],b=Object(r.useContext)(L),y=Object(o.a)(b,2),O=y[0],w=O.mode,k=O.showLinks,A=O.categoryScaling,D=y[1],S=Object(r.useRef)(),R=Object(r.useRef)(),M=Object(r.useRef)(),E=Object(r.useState)(!1),N=Object(o.a)(E,2),B=N[0],q=N[1],z=Object(r.useState)(100),I=Object(o.a)(z,2),F=I[0],T=I[1],V=function(e,t,n){var a=Object(r.useRef)(0),c=Object(r.useRef)(0),i=Object(r.useRef)(!1);return function(){if(t.current)switch(n){case"horizontal":var r=t.current.scrollLeft;r!==a.current&&(a.current=r,i.current||(window.requestAnimationFrame((function(){e(r),i.current=!1})),i.current=!0));break;case"vertical":var l=t.current.scrollTop;l!==c.current&&(c.current=l,i.current||(window.requestAnimationFrame((function(){e(l),i.current=!1})),i.current=!0));break;case"both":var u=t.current.scrollLeft,s=t.current.scrollTop;u===a.current&&s===c.current||(a.current=u,c.current=s,i.current||(window.requestAnimationFrame((function(){e(u,s),i.current=!1})),i.current=!0));break;default:console.log("Invalid scroll type")}}}((function(){R.current&&R.current.updateLinks()}),M,"horizontal");Object(r.useEffect)((function(){R.current||(R.current=P().applySimplification(d).simplificationMethod(f.name).simplificationAmount(h).simplificationRows(v).transformBase(p).visualizationMode(w).categoryScaling(A).on("clusterByColumn",(function(e){g({type:"setColumnInfo",columnType:e.type,unique:e.uniqueValues.length})})).onCalcRel("CalculateRelations",(function(e){D({type:"setCalculatingRelations",calculatingRelations:e})})).applyClusterColumnLink(n,a).applySortColumnLink(c,i))}),[]),Object(r.useEffect)((function(){j.select(S.current).datum(t).call(R.current),D({type:"setCalculatingRelations",calculatingRelations:!0})}),[t]),Object(r.useEffect)((function(){R.current&&R.current.applySimplification(d)}),[d]),Object(r.useEffect)((function(){R.current&&R.current.simplificationMethod(f.name)}),[f]),Object(r.useEffect)((function(){R.current&&R.current.simplificationAmount(h)}),[h]),Object(r.useEffect)((function(){R.current&&R.current.simplificationRows(v)}),[v]),Object(r.useEffect)((function(){R.current&&R.current.transformBase(p)}),[p]),Object(r.useEffect)((function(){R.current&&R.current.unselect()}),[m]),Object(r.useEffect)((function(){R.current&&R.current.visualizationMode(w)}),[w]),Object(r.useEffect)((function(){R.current&&R.current.showLinks(k)}),[k]),Object(r.useEffect)((function(){R.current&&R.current.categoryScaling(A)}),[A]),Object(r.useEffect)((function(){R.current&&R.current.isFullData()&&q(!0)}),[]);var U=R.current&&R.current.fullDataLength(),W=R.current&&R.current.displayRowNum();return Object(x.jsxs)("div",{ref:M,onScroll:V,style:{height:"100%",overflow:"auto"},children:[Object(x.jsx)("div",{ref:S}),d||B?Object(x.jsx)("div",{}):Object(x.jsx)(J,{loadMore:function(e){R.current&&(R.current.loadMore(e),R.current.isFullData()&&q(!0))},isFullData:B,addrowNum:F,setAddRowNum:T,max:U,displayRowNum:W,refreshDisplayRowNum:function(){if(R.current)return R.current.displayRowNum()}})]})},Y=n(39),_=n(66),K=_.a.Header,X=_.a.Body,Z=_.a.Subtitle,$=function(e){var t=e.title,n=e.subtitle,r=e.children;return Object(x.jsxs)(_.a,{children:[Object(x.jsx)(K,{children:t}),Object(x.jsxs)(X,{children:[n&&Object(x.jsx)(Z,{className:"mb-2 text-muted",children:n}),Object(x.jsx)(m.a,{gap:3,children:r})]})]})},ee=f.a.Group,te=f.a.Label,ne=f.a.Check,re=f.a.Select,ae=f.a.Range,ce=f.a.Control,ie=function(e){var t=e.simplification,n=Object(r.useContext)(C),a=Object(o.a)(n,2),c=a[0],i=c.apply,l=c.columnType,u=c.methods,s=c.method,d=c.amount,f=c.transformBase,h=c.unique,v=c.rows,p=c.unselect,m=a[1];Object(r.useEffect)((function(){"true"===t&&m({type:"setApply",apply:!0})}),[]);return Object(x.jsxs)($,{title:"Simplification",subtitle:"".concat(l," column"),children:[Object(x.jsx)(ee,{children:Object(x.jsx)(ne,{type:"checkbox",label:"Apply",id:"apply-simplification-checkbox",size:"sm",checked:i,disabled:"id"===l,onChange:function(e){m({type:"setApply",apply:e.target.checked})}})}),"numeric"===l&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)(ee,{children:[Object(x.jsx)(te,{children:"numeric column:"}),Object(x.jsx)(Y.a,{label:"Method",children:Object(x.jsx)(re,{value:s.name,onChange:function(e){m({type:"setMethod",method:u.find((function(t){return t.name===e.target.value}))})},children:u.map((function(e,t){var n=e.name;return Object(x.jsx)("option",{value:n,children:n},t)}))})})]}),"amount"===s.type?Object(x.jsxs)(ee,{children:[Object(x.jsx)(te,{children:"Amount"}),Object(x.jsx)(ae,{min:0,max:100,step:1,value:100*d,onChange:function(e){m({type:"setAmount",amount:+e.target.value/100})}})]}):Object(x.jsxs)(ee,{children:[Object(x.jsx)(te,{children:"Number of rows"}),Object(x.jsx)(ce,{type:"number",min:1,max:h,step:1,value:v,onChange:function(e){m({type:"setRows",rows:+e.target.value})}})]}),s.transform&&Object(x.jsxs)(ee,{children:[Object(x.jsx)(te,{children:"Depth weight"}),Object(x.jsx)(ae,{min:100,max:400,step:1,value:100*f,onChange:function(e){m({type:"setTransformBase",transformBase:+e.target.value/100})}})]})]}),Object(x.jsx)(ee,{children:Object(x.jsx)(H.a,{variant:"outline-secondary",size:"sm",value:!p,onClick:function(e){m({type:"setUnselect",unselect:"true"===e.target.value})},children:"Unselect all rows"})})]})},le=f.a.Group,ue=f.a.Select,se=f.a.Check,oe=function(e){var t=e.visual,n=Object(r.useContext)(L),a=Object(o.a)(n,2),c=a[0],i=c.modes,l=c.mode,u=c.showLinks,s=c.categoryScalingOptions,d=c.categoryScaling,f=c.calculatingRelations,h=a[1];Object(r.useEffect)((function(){"both"===t?h({type:"setMode",mode:"both"}):"visualizations"===t?h({type:"setMode",mode:"visualizations"}):"interactive"===t&&h({type:"setMode",mode:"interactive"})}),[]);var v=function(e){h({type:"setShowLinks",showLinks:e.target.checked})};return Object(x.jsxs)($,{title:"Visualization",children:[Object(x.jsx)(le,{children:Object(x.jsx)(Y.a,{label:"Mode",children:Object(x.jsx)(ue,{value:l,onChange:function(e){h({type:"setMode",mode:e.target.value})},children:i.map((function(e,t){return Object(x.jsx)("option",{value:e,children:e},t)}))})})}),Object(x.jsx)(le,{children:f?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(se,{type:"checkbox",label:"Show links",id:"show-links-checkbox",size:"sm",checked:u,onChange:v,disabled:f}),Object(x.jsx)("p",{className:"text-muted small",style:{marginBottom:"0rem"},children:"Calculating..."})]}):Object(x.jsx)(se,{type:"checkbox",label:"Show links",id:"show-links-checkbox",size:"sm",checked:u,onChange:v,disabled:f})}),Object(x.jsx)(le,{children:Object(x.jsx)(Y.a,{label:"Category scaling",children:Object(x.jsx)(ue,{value:d,onChange:function(e){h({type:"setCategoryScaling",categoryScaling:e.target.value})},children:s.map((function(e,t){return Object(x.jsx)("option",{value:e,children:e},t)}))})})})]})},de=d.a.Brand,fe=f.a.Group,he=f.a.Control,ve=f.a.Select,pe=[{name:"MT Cars",url:"/digestable/data/mtcars.csv"},{name:"NFL Combine 2017",url:"/digestable/data/NFL Combine 2017.csv"},{name:"Starbucks",url:"/digestable/data/starbucks.csv"},{name:"Electric Cars",url:"/digestable/data/ElectricCars.csv"},{name:"Stars",url:"/digestable/data/Stars.csv"}],me=function(){var e=Object(r.useState)(""),t=Object(o.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),i=Object(o.a)(c,2),l=i[0],b=i[1],y=Object(r.useState)(!1),O=Object(o.a)(y,2),w=O[0],C=O[1],A=function(){var e=Object(s.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(null),C(!0),e.prev=2,e.next=5,j.csv(t);case 5:n=e.sent,b(n),C(!1),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),D=new URLSearchParams(window.location.search),S=D.get("mode"),R=D.get("clusterCol"),L=D.get("clusterAscending"),E=D.get("sortCol"),N=D.get("sortAscending"),B=D.get("simplification"),q=D.get("visual"),z=D.get("dataset");return Object(r.useEffect)((function(){!function(e){var t=pe.find((function(t){return t.name===e}));if(t){var n=t.url;a(n),A(n)}}(z)}),[]),Object(x.jsx)(k,{children:Object(x.jsxs)(M,{children:[Object(x.jsxs)(d.a,{bg:"dark",variant:"dark",children:[Object(x.jsxs)(de,{className:"ms-2",children:[Object(x.jsx)("img",{src:"/digestable/digestable_512.png",alt:"digestable logo",height:"32px",className:"me-1"}),Object(x.jsxs)("span",{className:"text-align-bottom",children:["diges",Object(x.jsx)("b",{children:"table"})]})]}),Object(x.jsx)(f.a,{children:Object(x.jsxs)(fe,{as:h.a,className:"align-items-center",children:[Object(x.jsx)(v.a,{children:Object(x.jsxs)(ve,{value:n,onChange:function(e){var t=e.target.value;a(t),A(t)},children:[Object(x.jsx)("option",{value:"",disabled:!0,children:"Choose dataset"}),pe.map((function(e,t){return Object(x.jsx)("option",{value:e.url,children:e.name},t)}))]})}),Object(x.jsx)(v.a,{sm:"auto",className:"text-center",children:Object(x.jsx)("span",{className:"text-light",children:"or"})}),Object(x.jsx)(v.a,{children:Object(x.jsx)(he,{type:"file",accept:".csv",onChange:function(e){var t=1===e.target.files.length?e.target.files[0]:null;t&&(a(""),A(URL.createObjectURL(t)))}})})]})})]}),l?Object(x.jsx)(p.a,{fluid:!0,style:{height:"calc(100% - 100px)"},children:Object(x.jsxs)(h.a,{style:{height:"100%"},children:[Object(x.jsx)(v.a,{xs:10,className:"mt-3",style:{height:"100%"},children:Object(x.jsx)(Q,{data:l,clusterCol:R,clusterAscending:L,sortCol:E,sortAscending:N})}),Object(x.jsx)(v.a,{className:"bg-dark",children:"simple"===S?Object(x.jsx)(m.a,{gap:3}):Object(x.jsxs)(m.a,{gap:3,children:[Object(x.jsx)(ie,{simplification:B}),Object(x.jsx)(oe,{visual:q})]})})]})}):Object(x.jsx)(p.a,{children:Object(x.jsx)("div",{className:"m-4 text-center",children:w?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("h5",{children:"Loading..."}),Object(x.jsx)(g.a,{animation:"border"})]}):Object(x.jsx)("h3",{children:"No data"})})})]})})};i.a.render(Object(x.jsx)(a.a.StrictMode,{children:Object(x.jsx)(me,{})}),document.getElementById("root"))}},[[56,1,2]]]);
//# sourceMappingURL=main.cb926071.chunk.js.map