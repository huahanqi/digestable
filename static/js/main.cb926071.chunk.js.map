{"version":3,"sources":["contexts/simplify-context.js","contexts/visualization-context.js","digestable/clustering/kmeans.js","digestable/compute-relation-web-worker.js","digestable/digestable.js","digestable/clustering/clusterQuantiles.js","digestable/clustering/clusterGap.js","digestable/clustering/groupCategories.js","components/table-wrapper/Footer.js","components/table-wrapper/table-wrapper.js","hooks/use-scroll-hook.js","components/controls/controlPanel.js","components/controls/simplifyControls.js","components/controls/visualizationControls.js","app.js","index.js"],"names":["methods","name","type","transform","initialState","apply","columnType","method","amount","transformBase","unique","rows","unselect","reducer","state","action","Math","min","Error","SimplifyContext","createContext","SimplifyProvider","children","useReducer","dispatch","Provider","value","modes","categoryScalingOptions","mode","showLinks","categoryScaling","calculatingRelations","VisualizationContext","VisualizationProvider","calcMeanCentroid","dataSet","start","end","features","length","n","mean","i","push","j","getRandomCentroidsNaiveSharding","dataset","k","numSamples","step","floor","centroids","getRandomCentroids","index","max","centroidsIndex","random","indexOf","centroid","compareCentroids","a","b","shouldStop","oldCentroids","iterations","sameCount","getDistanceSQ","diffs","reduce","r","e","getLabels","labels","c","points","indeces","closestCentroidIndex","prevDistance","distance","getPointsMean","pointList","totalPoints","means","point","val","recalculateCentroids","newCentroid","newCentroidList","centroidGroup","Worker_fn","Worker","digestable","table","d3","linkSvg","allData","data","columns","relations","clustering","applyClusterColumn","NaN","applySortColumn","cluster_order","sort_order","applySimplification","simplificationMethod","simplificationAmount","simplificationRows","visualizationMode","isCalculating","missingValues","isMissing","d","includes","dispatcher","dispatcher_calcRel","displayRowNum","isFullData","selection","each","this","selectAll","join","enter","append","attr","inputData","map","group","unshift","filter","column","forEach","values","uniqueValues","Array","from","add","Set","validValues","numeric","isNaN","numbers","sort","isId","extent","maxDigits","significantDigits","counts","getCounts","count","clearSorting","clearClustering","createColumns","v","initialIndex","isCluster","cluster","pinned","expanded","cluster_col","find","clusterByColumn","sort_col","sortByColumn","processData","sortTable","drawTable","Object","entries","log10","log","String","split","n1","n2","abs","d1","d2","clusterColumn","v1","v2","sortData","maxCount","clusters","transformValues","base","valueScale","domain","range","pow","removeNull","nullIndex","nullCluster","slice","applyNull","concat","scale","clusterQuantiles","reverse","useNaiveSharding","converged","kmeans","numRows","gaps","gap","clusterGap","console","clusterNumeric","groupCategories","clusterCategorical","size","row","valid","median","q1","q2","warn","sortColumn","px","paddingX","py","paddingY","showSortButtons","info","th","select","div","nameDiv","text","on","evt","style","call","html","classed","width","node","clientWidth","height","svg","xScale","rangeRound","bins","bin","yScale","rect","x0","x1","s","tippy","nodes","colorScale","bandwidth","drawHeader","top","others","topString","othersString","expandedData","insert","maxSize","td","valueDiv","idx","isPinned","isExpanded","isExpanded_target","w2","w1","source","target","drawBody","applyVisualizationMode","clientHeight","highlight","drawLinks","window","computeRelationWorker","postMessage","onmessage","re","cols","offsetWidth","aspect","offset","getBoundingClientRect","x","left","right","pos","x2","y","xi","yi","line","curve","opacityScale","widthScale","magnitude","applyClusterColumnLink","clusterCol","ascending","arguments","applySortColumnLink","sortCol","_","updateLinks","onCalcRel","loadMore","rowNum","parseInt","loadMoreData","fullDataLength","Footer","addrowNum","setAddRowNum","refreshDisplayRowNum","useState","displayRowNumAct","setDisplayRowNumAct","padding","display","justifyContent","position","zIndex","backgroundColor","Form","onSubmit","preventDefault","Row","Col","xs","Text","fontSize","Button","disabled","Control","onChange","TableWrapper","clusterAscending","sortAscending","useContext","simplifyDispatch","visualizationDispatch","divRef","useRef","digestableRef","OuterDivRef","setIsFullData","onScroll","callback","scrollType","ticking","current","scrollLeft","requestAnimationFrame","scrollTop","useScrollHook","useEffect","datum","ref","overflow","Header","Card","Body","Subtitle","ControlPanel","title","subtitle","className","Stack","Group","Label","Check","Select","Range","SimplifyControls","simplification","label","id","checked","FloatingLabel","variant","onClick","VisualizationControls","visual","onShowLinksChange","marginBottom","option","Brand","Navbar","datasets","url","App","setDataset","setData","loading","setLoading","loadData","csvData","queryParams","URLSearchParams","location","search","get","targetDataset","ds","loadwithPresetData","bg","src","alt","as","sm","accept","file","files","URL","createObjectURL","Container","fluid","Spinner","animation","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.cb926071.chunk.js","sourcesContent":["import React, { createContext, useReducer } from 'react';\n\nconst methods = [\n  { name: 'quantiles', type: 'rows' },\n  { name: 'kmeans', type: 'rows' },\n  { name: 'gap', type: 'rows', transform: true },\n  //  { name: 'threshold', type: 'amount' }\n];\n\nconst initialState = {\n  apply: false,\n  columnType: 'numeric',\n  methods: methods,\n  method: methods[0],\n  amount: 0.5,\n  transformBase: 1,\n  unique: 0,\n  rows: 10,\n  unselect: false,\n};\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'setApply':\n      return {\n        ...state,\n        apply: action.apply,\n      };\n\n    case 'setMethod':\n      return {\n        ...state,\n        method: action.method,\n      };\n\n    case 'setAmount':\n      return {\n        ...state,\n        amount: action.amount,\n      };\n\n    case 'setTransformBase':\n      return {\n        ...state,\n        transformBase: action.transformBase,\n      };\n\n    case 'setColumnInfo':\n      return {\n        ...state,\n        columnType: action.columnType,\n        unique: action.unique,\n        rows: Math.min(state.rows, action.unique),\n      };\n\n    case 'setRows':\n      return {\n        ...state,\n        rows: action.rows,\n      };\n\n    case 'setUnselect':\n      return {\n        ...state,\n        unselect: action.unselect,\n      };\n\n    default:\n      throw new Error('Invalid simplify context action: ' + action.type);\n  }\n};\n\nexport const SimplifyContext = createContext(initialState);\n\nexport const SimplifyProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  return (\n    <SimplifyContext.Provider value={[state, dispatch]}>\n      {children}\n    </SimplifyContext.Provider>\n  );\n};\n","import React, { createContext, useReducer } from 'react';\n\nconst modes = ['text', 'visualizations', 'both', 'interactive'];\n\nconst categoryScalingOptions = ['row', 'column'];\n\nconst initialState = {\n  modes: modes,\n  mode: modes[0],\n  showLinks: false,\n  categoryScalingOptions: categoryScalingOptions,\n  categoryScaling: categoryScalingOptions[0],\n  calculatingRelations: true,\n};\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'setMode':\n      return {\n        ...state,\n        mode: action.mode,\n      };\n\n    case 'setShowLinks':\n      return {\n        ...state,\n        showLinks: action.showLinks,\n      };\n\n    case 'setCategoryScaling':\n      return {\n        ...state,\n        categoryScaling: action.categoryScaling,\n      };\n\n    case 'setCalculatingRelations':\n      return {\n        ...state,\n        calculatingRelations: action.calculatingRelations,\n      };\n\n    default:\n      throw new Error('Invalid visualization context action: ' + action.type);\n  }\n};\n\nexport const VisualizationContext = createContext(initialState);\n\nexport const VisualizationProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  return (\n    <VisualizationContext.Provider value={[state, dispatch]}>\n      {children}\n    </VisualizationContext.Provider>\n  );\n};\n","// Adapted from https://medium.com/geekculture/implementing-k-means-clustering-from-scratch-in-javascript-13d71fbcb31e\n\nconst MAX_ITERATIONS = 50;\n\nfunction randomBetween(min, max) {\n  return Math.floor(\n    Math.random() * (max - min) + min\n  );\n}\n\nfunction calcMeanCentroid(dataSet, start, end) {\n  const features = dataSet[0].length;\n  const n = end - start;\n  let mean = [];\n  for (let i = 0; i < features; i++) {\n    mean.push(0);\n  }\n  for (let i = start; i < end; i++) {\n    for (let j = 0; j < features; j++) {\n      mean[j] = mean[j] + dataSet[i][j] / n;\n    }\n  }\n  return mean;\n}\n\nfunction getRandomCentroidsNaiveSharding(dataset, k) {\n  // implementation of a variation of naive sharding centroid initialization method\n  // (not using sums or sorting, just dividing into k shards and calc mean)\n  // https://www.kdnuggets.com/2017/03/naive-sharding-centroid-initialization-method.html\n  const numSamples = dataset.length;\n  // Divide dataset into k shards:\n  const step = Math.floor(numSamples / k);\n  const centroids = [];\n  for (let i = 0; i < k; i++) {\n    const start = step * i;\n    let end = step * (i + 1);\n    if (i + 1 === k) {\n      end = numSamples;\n    }\n    centroids.push(calcMeanCentroid(dataset, start, end));\n  }\n  return centroids;\n}\n\nfunction getRandomCentroids(dataset, k) {\n  // selects random points as centroids from the dataset\n  const numSamples = dataset.length;\n  const centroidsIndex = [];\n  let index;\n  while (centroidsIndex.length < k) {\n    index = randomBetween(0, numSamples);\n    if (centroidsIndex.indexOf(index) === -1) {\n      centroidsIndex.push(index);\n    }\n  }\n  const centroids = [];\n  for (let i = 0; i < centroidsIndex.length; i++) {\n    const centroid = [...dataset[centroidsIndex[i]]];\n    centroids.push(centroid);\n  }\n  return centroids;\n}\n\nfunction compareCentroids(a, b) {\n  for (let i = 0; i < a.length; i++) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction shouldStop(oldCentroids, centroids, iterations) {\n  if (iterations > MAX_ITERATIONS) {\n    return true;\n  }\n  if (!oldCentroids || !oldCentroids.length) {\n    return false;\n  }\n  let sameCount = true;\n  for (let i = 0; i < centroids.length; i++) {\n    if (!compareCentroids(centroids[i], oldCentroids[i])) {\n      sameCount = false;\n    }\n  }\n  return sameCount;\n}\n\n// Calculate Squared Euclidean Distance\nfunction getDistanceSQ(a, b) {\n  const diffs = [];\n  for (let i = 0; i < a.length; i++) {\n    diffs.push(a[i] - b[i]);\n  }\n  return diffs.reduce((r, e) => (r + (e * e)), 0);\n}\n\n// Returns a label for each piece of data in the dataset. \nfunction getLabels(dataSet, centroids) {\n  // prep data structure:\n  const labels = {};\n  for (let c = 0; c < centroids.length; c++) {\n    labels[c] = {\n      points: [],\n      indeces: [],\n      centroid: centroids[c],\n    };\n  }\n  // For each element in the dataset, choose the closest centroid. \n  // Make that centroid the element's label.\n  for (let i = 0; i < dataSet.length; i++) {\n    const a = dataSet[i];\n    let closestCentroid, closestCentroidIndex, prevDistance;\n    for (let j = 0; j < centroids.length; j++) {\n      let centroid = centroids[j];\n      if (j === 0) {\n        closestCentroid = centroid;\n        closestCentroidIndex = j;\n        prevDistance = getDistanceSQ(a, closestCentroid);\n      } else {\n        // get distance:\n        const distance = getDistanceSQ(a, centroid);\n        if (distance < prevDistance) {\n          prevDistance = distance;\n          closestCentroid = centroid;\n          closestCentroidIndex = j;\n        }\n      }\n    }\n\n    labels[closestCentroidIndex].points.push(a);\n    labels[closestCentroidIndex].indeces.push(i);\n  }\n  return labels;\n}\n\nfunction getPointsMean(pointList) {\n  const totalPoints = pointList.length;\n  const means = [];\n  for (let j = 0; j < pointList[0].length; j++) {\n    means.push(0);\n  }\n  for (let i = 0; i < pointList.length; i++) {\n    const point = pointList[i];\n    for (let j = 0; j < point.length; j++) {\n      const val = point[j];\n      means[j] = means[j] + val / totalPoints;\n    }\n  }\n  return means;\n}\n\nfunction recalculateCentroids(dataSet, labels, k) {\n  // Each centroid is the geometric mean of the points that\n  // have that centroid's label. Important: If a centroid is empty (no points have\n  // that centroid's label) you should randomly re-initialize it.\n  let newCentroid;\n  const newCentroidList = [];\n  for (const k in labels) {\n    const centroidGroup = labels[k];\n    if (centroidGroup.points.length > 0) {\n      // find mean:\n      newCentroid = getPointsMean(centroidGroup.points);\n    } else {\n      // get new random centroid\n      newCentroid = getRandomCentroids(dataSet, 1)[0];\n    }\n    newCentroidList.push(newCentroid);\n  }\n  return newCentroidList;\n}\n\nexport function kmeans(dataset, k, useNaiveSharding = true) {\n  if (dataset.length && dataset[0].length && dataset.length >= k) {\n    // Initialize book keeping variables\n    let iterations = 0;\n    let oldCentroids, labels, centroids;\n\n    // Initialize centroids randomly\n    if (useNaiveSharding) {\n      centroids = getRandomCentroidsNaiveSharding(dataset, k);\n    } else {\n      centroids = getRandomCentroids(dataset, k);\n    }\n\n    // Run the main k-means algorithm\n    while (!shouldStop(oldCentroids, centroids, iterations)) {\n      // Save old centroids for convergence test.\n      oldCentroids = [...centroids];\n      iterations++;\n\n      // Assign labels to each datapoint based on centroids\n      labels = getLabels(dataset, centroids);\n      centroids = recalculateCentroids(dataset, labels, k);\n    }\n\n    const clusters = [];\n    for (let i = 0; i < k; i++) {\n      clusters.push(labels[i]);\n    }\n    const results = {\n      clusters: clusters,\n      centroids: centroids,\n      iterations: iterations,\n      converged: iterations <= MAX_ITERATIONS,\n    };\n    return results;\n  } else {\n    throw new Error('Invalid dataset');\n  }\n}","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"static/js/compute-relation-web-worker.dc856299.worker.js\");\n}\n","import * as d3 from 'd3';\nimport {\n  clusterQuantiles,\n  kmeans,\n  clusterGap,\n  groupCategories,\n} from './clustering';\nimport './digestable.css';\n// import worker for relation calculation\n/* eslint-disable import/no-webpack-loader-syntax */\nimport Worker from 'worker-loader!./compute-relation-web-worker.js';\n\n// import tippy for nicer tooltip\nimport tippy from 'tippy.js';\nimport 'tippy.js/dist/tippy.css';\n\nexport const digestable = () => {\n  // The table\n  let table = d3.select(),\n    linkSvg = d3.select(),\n    // Data\n    allData = [],\n    data = [],\n    columns = [],\n    relations = [],\n    clustering = false,\n    // Parameters\n    applyClusterColumn = NaN,\n    applySortColumn = NaN,\n    cluster_order = 'ascending',\n    sort_order = 'ascending',\n    applySimplification = false,\n    simplificationMethod = 'threshold',\n    simplificationAmount = 0.9,\n    simplificationRows = 20,\n    transformBase = 1,\n    visualizationMode = 'text',\n    showLinks = false,\n    // web-worker para\n    isCalculating = false,\n    categoryScaling = 'row',\n    paddingX = 5,\n    paddingY = 0,\n    // Missing data\n    missingValues = ['', 'NA', 'na'],\n    isMissing = (d) => missingValues.includes(d),\n    // Event dispatcher\n    dispatcher = d3.dispatch('clusterByColumn'),\n    dispatcher_calcRel = d3.dispatch('CalculateRelations'),\n    // load more data parameters\n    displayRowNum = 100,\n    isFullData = false;\n\n  function digestable(selection) {\n    selection.each(function(d) {\n      // Create SVG for links\n      linkSvg = d3\n        .select(this)\n        .selectAll('.linkSvg')\n        .data([[]])\n        .join((enter) => enter.append('svg').attr('class', 'linkSvg'));\n\n      // Create skeletal table\n      table = d3\n        .select(this)\n        .selectAll('table')\n        .data([[]])\n        .join((enter) => {\n          const table = enter.append('table');\n\n          table.append('thead').append('tr');\n          table.append('tbody');\n\n          return table;\n        });\n      createColumns(d);\n      createData(d);\n\n      // if have query string, change initial loading state\n      if (applyClusterColumn) {\n        const cluster_col = columns.find(\n          ({ name }) => name === applyClusterColumn\n        );\n        if (cluster_col) {\n          clusterByColumn(cluster_col);\n          if (cluster_order === 'ascending') {\n            clusterByColumn(cluster_col);\n          }\n        }\n      }\n      if (applySortColumn) {\n        const sort_col = columns.find(({ name }) => name === applySortColumn);\n        if (sort_col) {\n          sortByColumn(sort_col);\n          if (sort_order === 'ascending') {\n            sortByColumn(sort_col);\n          }\n        }\n      }\n      processData();\n      sortTable();\n      drawTable();\n    });\n\n    // // if have query string, change initial loading state\n\n    // // cluster by col\n    // if (applyClusterColumn) {\n    //   columns.forEach((d) => {\n    //     if (d.name === applyClusterColumn) {\n    //       clusterByColumn(d);\n    //       processData();\n    //       sortTable();\n    //       drawTable();\n    //       if (cluster_order === 'ascending') {\n    //         clusterByColumn(d);\n    //         processData();\n    //         sortTable();\n    //         drawTable();\n    //       }\n    //       dispatcher.call('clusterByColumn', this, d);\n    //     }\n    //   });\n    // }\n\n    // // if cluster by a categorical col then can sort\n    // if (applySortColumn) {\n    //   columns.forEach((d) => {\n    //     if (d.name === applySortColumn) {\n    //       sortByColumn(d);\n    //       sortTable();\n    //       drawTable();\n    //       if (sort_order === 'ascending') {\n    //         sortByColumn(d);\n    //         sortTable();\n    //         drawTable();\n    //       }\n    //     }\n    //   });\n    // }\n  }\n\n  // Helper functions\n  const textVisibility = () =>\n    visualizationMode === 'text' || visualizationMode === 'both'\n      ? 'visible'\n      : 'hidden';\n  const visVisibility = () =>\n    visualizationMode !== 'text' ? 'visible' : 'hidden';\n\n  const getCounts = (uniqueValues, values) =>\n    Object.entries(\n      values.reduce(\n        (counts, value) => {\n          counts[value]++;\n          return counts;\n        },\n        uniqueValues.reduce((counts, value) => {\n          counts[value] = 0;\n          return counts;\n        }, {})\n      )\n    )\n      .map(([key, value]) => ({\n        value: key,\n        count: value,\n      }))\n      .sort((a, b) => d3.descending(a.count, b.count));\n\n  const significantDigits = (n) => {\n    const log10 = Math.log(10);\n\n    // Split decimal\n    let [n1, n2] = String(n).split('.');\n\n    // Handle left of decimal\n    n1 = Math.abs(n1);\n    const d1 = Math.floor(Math.log(n) / log10) + 1;\n\n    // Handle right of decimal\n    const d2 = n2\n      ? n1 > 0\n        ? n2.length\n        : Math.floor(Math.log(+n) / log10) + 1\n      : 0;\n\n    return Math.max(d1 + d2, 1);\n  };\n\n  function clearSorting() {\n    columns.forEach((d) => (d.sort = null));\n  }\n\n  function clearClustering() {\n    columns.forEach((d) => (d.cluster = null));\n  }\n\n  function createColumns(inputData) {\n    columns = inputData.columns.map((d) => ({\n      name: d,\n    }));\n    const group = { name: 'group', type: 'group' };\n    columns.unshift(group);\n    //console.log(columns);\n    // Determine column types and set column info\n    columns\n      .filter((column) => column.type !== 'group')\n      .forEach((column) => {\n        const { name } = column;\n        const values = inputData.map((d) => d[name]);\n        const uniqueValues = Array.from(\n          values.reduce((values, d) => values.add(d), new Set())\n        );\n        const validValues = uniqueValues.filter((value) => !isMissing(value));\n        const numeric = validValues.reduce(\n          (numeric, value) => numeric && !isNaN(value),\n          true\n        );\n        const numbers = numeric ? validValues.map((d) => +d) : null;\n\n        column.uniqueValues = uniqueValues;\n\n        if (numeric) {\n          if (numbers.length === inputData.length) {\n            // Heuristic to check for integer ID type\n            numbers.sort((a, b) => d3.ascending(a, b));\n\n            const isId = numbers.reduce(\n              (isId, d, i, a) => isId && (i === 0 || d === a[i - 1] + 1),\n              true\n            );\n\n            column.type = isId ? 'id' : 'numeric';\n          } else if (\n            numbers.length === 2 &&\n            numbers.includes(0) &&\n            numbers.includes(1)\n          ) {\n            // Treat binary as categorical\n            column.type = 'categorical';\n          } else {\n            column.type = 'numeric';\n          }\n        } else if (uniqueValues.length === inputData.length) {\n          column.type = 'id';\n        } else {\n          column.type = 'categorical';\n        }\n\n        if (column.type === 'numeric') {\n          column.values = values.filter((value) => !isMissing(value));\n          column.extent = d3.extent(numbers);\n          column.maxDigits = d3.max(numbers, significantDigits);\n        } else if (column.type === 'categorical') {\n          column.type = 'categorical';\n          column.counts = getCounts(uniqueValues, values).sort(\n            (a, b) => b.count - a.count\n          );\n          column.uniqueValues = column.counts.map(({ value }) => value);\n        }\n      });\n\n    clearSorting();\n    clearClustering();\n  }\n\n  function createData(inputData) {\n    allData = inputData.map((d, i) => {\n      const v = { ...d };\n\n      // Convert missing and numeric data\n      columns.forEach(({ type, name }) => {\n        const value = v[name];\n\n        if (isMissing(value)) {\n          v[name] = null;\n        } else if (type === 'numeric') {\n          v[name] = +value;\n        }\n      });\n\n      return {\n        initialIndex: i,\n        isCluster: false,\n        cluster: null,\n        pinned: false,\n        expanded: false,\n        values: v,\n      };\n    });\n  }\n\n  // function computeRelations() {\n  //   // Compute relations\n  //   relations = columns.reduce((relations, column1, i, a) => {\n  //     const v1 = allData.map((d) => d.values[column1.name]);\n\n  //     for (let j = i + 1; j < a.length; j++) {\n  //       const column2 = a[j];\n  //       const v2 = allData.map((d) => d.values[column2.name]);\n\n  //       const value =\n  //         column1.type === 'id' || column2.type === 'id'\n  //           ? 0\n  //           : column1.type === 'categorical' && column2.type === 'categorical'\n  //           ? cramersV(v1, v2)\n  //           : column1.type === 'categorical' && column2.type === 'numeric'\n  //           ? categoricalRegression(v1, v2)\n  //           : column1.type === 'numeric' && column2.type === 'categorical'\n  //           ? categoricalRegression(v2, v1)\n  //           : correlation(v1, v2);\n\n  //       relations.push({\n  //         source: column1,\n  //         target: column2,\n  //         value: value,\n  //         magnitude: Math.abs(value),\n  //       });\n  //     }\n\n  //     return relations;\n  //   }, []);\n\n  //   relations.sort((a, b) => d3.ascending(a.magnitude, b.magnitude));\n  // }\n\n  function sortByColumn(column) {\n    const sort = column.sort === 'descending' ? 'ascending' : 'descending';\n\n    clearSorting();\n\n    column.sort = sort;\n  }\n\n  function clusterByColumn(column) {\n    const cluster =\n      column.cluster === null\n        ? 'descending'\n        : column.cluster === 'descending'\n        ? 'ascending'\n        : null;\n\n    clearClustering();\n    clearSorting();\n\n    column.cluster = cluster;\n  }\n\n  function sortData() {\n    const clusterColumn = columns.find(({ cluster }) => cluster);\n\n    const sort = clusterColumn ? clusterColumn.cluster : 'ascending';\n\n    allData.sort((a, b) => {\n      const v1 = clusterColumn ? a.values[clusterColumn.name] : a.initialIndex;\n      const v2 = clusterColumn ? b.values[clusterColumn.name] : b.initialIndex;\n\n      return v1 === v2\n        ? 0\n        : v1 === null\n        ? 1\n        : v2 === null\n        ? -1\n        : d3[sort](v1, v2);\n    });\n  }\n\n  function processData() {\n    sortData();\n\n    // Clear expanded\n    allData.forEach((d) => (d.expanded = false));\n\n    const clusterColumn = columns.find(({ cluster }) => cluster);\n\n    // Initialize categorical and id column counts\n    columns\n      .filter(({ type }) => type !== 'numeric')\n      .forEach((column) => (column.maxCount = 1));\n\n    clustering =\n      applySimplification && clusterColumn && clusterColumn.type !== 'id';\n\n    if (clustering) {\n      const { name, type, cluster: sort } = clusterColumn;\n\n      const values = allData.map((d) => d.values[name]);\n\n      const clusters = (type === 'numeric'\n        ? clusterNumeric(values, sort)\n        : clusterCategorical(values)\n      ).filter((cluster) => cluster.length > 0);\n\n      data = clusters.map((cluster) => {\n        const size = cluster.length;\n\n        // No cluster if only 1\n        if (size === 1) {\n          allData[cluster[0]].cluster = null;\n\n          return allData[cluster[0]];\n        }\n\n        // Create row object\n        const row = {\n          isCluster: true,\n          indeces: cluster,\n          size: size,\n          values: {},\n        };\n\n        // Set cluster object for each item\n        cluster.forEach((i) => (allData[i].cluster = row));\n\n        // Compute info based on column type\n        columns.forEach((column) => {\n          const { name, type, uniqueValues } = column;\n\n          if (type === 'numeric') {\n            const values = cluster.map((i) => allData[i].values[name]);\n\n            if (values.length > 0) {\n              const validValues = values.filter((d) => d !== null);\n\n              row.values[name] =\n                validValues.length > 0\n                  ? {\n                      valid: true,\n                      values: values,\n                      validValues: validValues,\n                      min: d3.min(validValues),\n                      max: d3.max(validValues),\n                      median: d3.median(validValues),\n                      q1: d3.quantile(validValues, 0.25),\n                      q2: d3.quantile(validValues, 0.75),\n                    }\n                  : {\n                      valid: false,\n                      values: values,\n                    };\n            } else {\n              row.values[name] = null;\n            }\n          } else if (type === 'categorical') {\n            const values = cluster.map((i) => allData[i].values[name]);\n\n            if (values.length > 0) {\n              const counts = getCounts(uniqueValues, values);\n\n              column.maxCount = Math.max(column.maxCount, counts[0].count);\n\n              row.values[name] = {\n                counts: counts,\n              };\n            } else {\n              row.values[name] = null;\n            }\n          } else if (type === 'id') {\n            const values = cluster.map((i) => allData[i].values[name]);\n\n            if (values.length > 0) {\n              const counts = values.map((value) => ({\n                value: value,\n                count: 1,\n              }));\n\n              row.values[name] = {\n                counts: counts,\n              };\n            } else {\n              row.values[name] = null;\n            }\n          } else if (type === 'group') {\n            //console.log('group');\n          } else {\n            console.warn('Unknown column type: ' + type);\n          }\n        });\n\n        return row;\n      });\n    } else {\n      if (displayRowNum < [...allData].length) {\n        data = [...allData].slice(0, displayRowNum);\n      } else {\n        data = [...allData];\n        isFullData = true;\n      }\n    }\n\n    function clusterNumeric(values, sort) {\n      const transformValues = (values) => {\n        const base = sort === 'ascending' ? 1 / transformBase : transformBase;\n\n        const valueScale = d3\n          .scaleLinear()\n          .domain(d3.extent(values))\n          .range([0, 1]);\n\n        return values.map((d) => Math.pow(valueScale(d), base));\n      };\n\n      const removeNull = (values) => {\n        // Find first null. Always sorted to the end.\n        const nullIndex = values.indexOf(null);\n        const nullCluster =\n          nullIndex > -1 ? d3.range(nullIndex, values.length) : null;\n        const validValues =\n          nullIndex > -1 ? values.slice(0, nullIndex) : values;\n        const rows = nullCluster ? simplificationRows - 1 : simplificationRows;\n\n        return [validValues, nullCluster, rows];\n      };\n\n      const applyNull = (clusters, nullCluster) => {\n        return nullCluster ? clusters.concat([nullCluster]) : clusters;\n      };\n\n      switch (simplificationMethod) {\n        case 'quantiles': {\n          const [validValues, nullCluster, rows] = removeNull(values);\n          const clusters = clusterQuantiles(validValues, rows);\n          if (sort === 'descending') clusters.reverse();\n\n          return applyNull(clusters, nullCluster);\n        }\n\n        case 'kmeans': {\n          const [validValues, nullCluster, rows] = removeNull(values);\n          const { clusters } = kmeans(\n            validValues.map((d) => [d]),\n            rows\n          );\n          clusters.sort((a, b) => d3[sort](a.centroid[0], b.centroid[0]));\n\n          return applyNull(\n            clusters.map((cluster) => cluster.indeces),\n            nullCluster\n          );\n        }\n\n        case 'gap': {\n          const [validValues, nullCluster, rows] = removeNull(values);\n          const clusters = clusterGap(transformValues(validValues), rows);\n\n          return applyNull(clusters, nullCluster);\n        }\n\n        default:\n          console.log(`Unknown simplification method: ${simplificationMethod}`);\n      }\n    }\n\n    function clusterCategorical(values) {\n      return groupCategories(values);\n    }\n  }\n\n  function sortTable() {\n    const sortColumn = columns.find(({ sort }) => sort !== null);\n\n    if (!sortColumn) return;\n\n    const { name, type, sort, cluster } = sortColumn;\n\n    data.sort((a, b) => {\n      switch (type) {\n        case 'numeric': {\n          const v1 = a.isCluster ? a.values[name].median : a.values[name];\n          const v2 = b.isCluster ? b.values[name].median : b.values[name];\n\n          return v1 === v2\n            ? 0\n            : v1 === null\n            ? 1\n            : v2 === null\n            ? -1\n            : d3[sort](v1, v2);\n        }\n\n        case 'categorical': {\n          if (cluster) {\n            const v1 = a.isCluster\n              ? a.values[name].counts[0].count\n              : a.values[name]\n              ? 1\n              : null;\n            const v2 = b.isCluster\n              ? b.values[name].counts[0].count\n              : b.values[name]\n              ? 1\n              : null;\n\n            return v1 === v2\n              ? 0\n              : v1 === null\n              ? 1\n              : v2 === null\n              ? -1\n              : d3[sort](v1, v2);\n          } else {\n            const v1 = a.isCluster\n              ? a.values[name].counts[0].count / a.size\n              : a.values[name];\n            const v2 = b.isCluster\n              ? b.values[name].counts[0].count / b.size\n              : b.values[name];\n\n            return v1 === v2\n              ? 0\n              : v1 === null\n              ? 1\n              : v2 === null\n              ? -1\n              : d3[sort](v1, v2);\n          }\n        }\n\n        case 'id': {\n          const v1 = a.isCluster\n            ? a.values[name].counts[0].value\n            : a.values[name];\n          const v2 = b.isCluster\n            ? b.values[name].counts[0].value\n            : b.values[name];\n\n          return v1 === v2\n            ? 0\n            : v1 === null\n            ? 1\n            : v2 === null\n            ? -1\n            : d3[sort](v1, v2);\n        }\n\n        default:\n          console.log(`Unknown column type ${type}`);\n          return 0;\n      }\n    });\n  }\n\n  function drawTable() {\n    const px = paddingX + 'px';\n    const py = paddingY + 'px';\n\n    const clusterIcon = (cluster) =>\n      cluster === 'ascending' ? '' : cluster === 'descending' ? '' : '';\n    //cluster === 'ascending' ? '' :\n    //cluster === 'descending' ? '' :\n    //''\n\n    const sortIcon = (sort) => (sort === 'ascending' ? '' : '');\n\n    const clusterColumn = columns.find(({ cluster }) => cluster);\n    const showSortButtons =\n      applySimplification &&\n      clusterColumn &&\n      clusterColumn.type === 'categorical';\n\n    // Reset svg widths for proper column width sizing\n    table.selectAll('svg').attr('width', 0);\n\n    drawHeader();\n    drawBody();\n    applyVisualizationMode();\n    highlight();\n    drawLinks();\n\n    function drawHeader() {\n      const info = (column) => {\n        switch (column.type) {\n          case 'numeric': {\n            // Display range and median for clusters\n            const min = column.extent[0];\n            const max = column.extent[1];\n\n            return min === max\n              ? min\n              : `<div class='range'><div>${min}</div><div class='dash'><hr /></div><div>${max}</div>`;\n          }\n\n          case 'categorical': {\n            return `<div>${column.uniqueValues.length} categories</div>`;\n          }\n\n          case 'id': {\n            return `<div>${column.uniqueValues.length} unique values<div>`;\n          }\n\n          default:\n            return null;\n        }\n      };\n\n      // Header elements\n      const th = table\n        .select('thead')\n        .select('tr')\n        .selectAll('th')\n        .data(columns, (d) => d.name)\n        .join((enter) => {\n          const th = enter.append('th');\n          // enter.each(function(column) {\n          //   if (column.type === 'group') {\n          //     d3.select(this)\n          //       .select('th')\n          //       .style('visibility', 'hidden');\n          //   }\n          // });\n          const div = th.each(function(column) {\n            d3.select(this)\n              .selectAll('.headerDiv')\n              .data(column.type === 'group' ? [] : [column])\n              .join((enter) => {\n                const div = enter.append('div').attr('class', 'headerDiv');\n                //console.log(div);\n                const nameDiv = div.append('div').attr('class', 'nameDiv');\n                nameDiv.append('div').text((d) => d.name);\n                nameDiv\n                  .append('button')\n                  .attr('class', 'headerButton sortButton')\n                  .on('click', (evt, d) => {\n                    sortByColumn(d);\n                    sortTable();\n                    drawTable();\n                  });\n\n                nameDiv\n                  .append('button')\n                  .attr('class', 'headerButton clusterButton')\n                  .style('font-weight', 'bold')\n                  .on('click', (evt, d) => {\n                    clusterByColumn(d);\n                    processData();\n                    sortTable();\n                    drawTable();\n\n                    dispatcher.call('clusterByColumn', this, d);\n                  });\n\n                div\n                  .append('div')\n                  .attr('class', 'info')\n                  .html(info);\n\n                div.each(function(column) {\n                  d3.select(this)\n                    .selectAll('.visDiv')\n                    .data(column.type === 'id' ? [] : [column])\n                    .join((enter) => {\n                      const div = enter.append('div').attr('class', 'visDiv');\n\n                      div.append('svg');\n\n                      return div;\n                    });\n                });\n\n                th.append('div').attr('class', 'highlight');\n\n                return div;\n              });\n          });\n\n          //   const div = th.append('div').attr('class', 'headerDiv');\n          //   const nameDiv = div.append('div').attr('class', 'nameDiv');\n          //   nameDiv.append('div').text((d) => d.name);\n          //   nameDiv\n          //     .append('button')\n          //     .attr('class', 'headerButton sortButton')\n          //     .on('click', (evt, d) => {\n          //       sortByColumn(d);\n          //       sortTable();\n          //       drawTable();\n          //     });\n          //   nameDiv\n          //     .append('button')\n          //     .attr('class', 'headerButton clusterButton')\n          //     .style('font-weight', 'bold')\n          //     .on('click', (evt, d) => {\n          //       clusterByColumn(d);\n          //       processData();\n          //       sortTable();\n          //       drawTable();\n          //       dispatcher.call('clusterByColumn', this, d);\n          //     });\n          //   div\n          //     .append('div')\n          //     .attr('class', 'info')\n          //     .html(info);\n          //   div.each(function(column) {\n          //     d3.select(this)\n          //       .selectAll('.visDiv')\n          //       .data(column.type === 'id' ? [] : [column])\n          //       .join((enter) => {\n          //         const div = enter.append('div').attr('class', 'visDiv');\n          //         div.append('svg');\n          //         return div;\n          //       });\n          //   });\n          //   th.append('div').attr('class', 'highlight');\n\n          return th;\n        })\n        .classed('active', (d) => d.cluster !== null)\n        .style('padding-left', px)\n        .style('padding-right', px)\n        .style('padding-top', py)\n        .style('padding-bottom', py);\n\n      // Update buttons\n      th.select('.clusterButton')\n        .classed('active', (d) => d.cluster !== null)\n        .text((d) => clusterIcon(d.cluster));\n\n      th.select('.sortButton')\n        .classed('active', (d) => d.sort !== null)\n        .style('visibility', (d) => (showSortButtons ? null : 'hidden'))\n        .text((d) => sortIcon(d.sort));\n\n      // Separate out the visualization update so we have an accurate width after rendering textual elements\n      table\n        .select('thead')\n        .selectAll('tr')\n        .each(function() {\n          d3.select(this)\n            .selectAll('th')\n            .each(function(column) {\n              if (column.type === 'group') {\n                var width = 5;\n              } else {\n                width = d3\n                  .select(this)\n                  .select('.nameDiv')\n                  .node().clientWidth;\n              }\n              const height = 10;\n\n              // Visualization\n              switch (column.type) {\n                case 'numeric': {\n                  const svg = d3\n                    .select(this)\n                    .select('.visDiv svg')\n                    .attr('width', width)\n                    .attr('height', height);\n\n                  const xScale = d3\n                    .scaleLinear()\n                    .domain(column.extent)\n                    .rangeRound([0, width]);\n\n                  const bin = d3.bin().domain(xScale.domain());\n\n                  const bins = bin(column.values);\n\n                  const yScale = d3\n                    .scaleLinear()\n                    .domain([0, d3.max(bins, (d) => d.length)])\n                    .range([height, 0]);\n\n                  // Histogram\n                  svg\n                    .selectAll('rect')\n                    .data(bins)\n                    .join((enter) => {\n                      const rect = enter.append('rect').style('fill', '#aaa');\n\n                      rect.append('title');\n\n                      return rect;\n                    })\n                    .attr('x', (d) => xScale(d.x0))\n                    .attr('y', (d) => yScale(d.length))\n                    .attr('width', (d) => xScale(d.x1) - xScale(d.x0) - 1)\n                    .attr('height', (d) => yScale(0) - yScale(d.length))\n                    //.select('title')\n                    //.text((d) => `${d.x0}-${d.x1}: ${d.length}`);\n                    .attr(\n                      'data-tippy-content',\n                      (d) => `${d.x0}-${d.x1}: ${d.length}`\n                    )\n                    .call((s) => tippy(s.nodes()));\n\n                  break;\n                }\n\n                case 'categorical': {\n                  const svg = d3\n                    .select(this)\n                    .select('.visDiv svg')\n                    .attr('width', width)\n                    .attr('height', height);\n\n                  const colorScale = d3\n                    .scaleOrdinal()\n                    .domain(column.uniqueValues)\n                    .range(d3.schemeTableau10);\n\n                  const xScale = d3\n                    .scaleBand()\n                    .domain(column.uniqueValues)\n                    .range([0, width]);\n\n                  const yScale = d3\n                    .scaleLinear()\n                    .domain([0, d3.max(column.counts, (d) => d.count)])\n                    .range([height, 0]);\n\n                  // Bars\n                  svg\n                    .selectAll('rect')\n                    .data(column.counts)\n                    .join((enter) => {\n                      const rect = enter.append('rect');\n                      rect.append('title');\n                      return rect;\n                    })\n                    .attr('x', (d) => xScale(d.value))\n                    .attr('y', (d) => yScale(d.count))\n                    .attr('width', xScale.bandwidth())\n                    .attr('height', (d) => yScale(0) - yScale(d.count))\n                    .attr('fill', (d) => colorScale(d.value))\n                    //.select('title')\n                    //.text((d) => `${d.value}: ${d.count}`);\n                    .attr('data-tippy-content', (d) => `${d.value}: ${d.count}`)\n                    .call((s) => tippy(s.nodes()));\n\n                  break;\n                }\n\n                case 'id':\n                  d3.select(this)\n                    .select('.visDiv svg')\n                    .attr('width', width)\n                    .attr('height', height);\n\n                  break;\n\n                case 'group': {\n                  d3.select(this)\n                    .select('.visDiv svg')\n                    .attr('width', width)\n                    .attr('height', height);\n\n                  break;\n                }\n                default:\n                  console.log(`Unknown column type ${column.type}`);\n              }\n            });\n        });\n    }\n\n    function drawBody() {\n      const text = (type, v, isCluster, maxDigits) => {\n        switch (type) {\n          case 'numeric': {\n            if (v !== null && isCluster && v.valid) {\n              // Display range and median for clusters\n              const median = d3.format(`.${maxDigits}r`)(v.median);\n\n              return v.min === v.max\n                ? median\n                : `<div class='range'><div class='extrema'>${v.min}</div><div>${median}</div><div class='extrema'>${v.max}<div>`;\n            } else {\n              return v === null || isCluster ? '' : v;\n            }\n          }\n\n          case 'categorical': {\n            if (v !== null && isCluster) {\n              // Display top category and number of other categories\n              const top = v.counts[0];\n              const others = v.counts.slice(1).filter((d) => d.count > 0);\n              const s = others.map((d) => `${d.value} (${d.count})`).join(', ');\n\n              const topString =\n                `<div>${top.value}` +\n                (top.count > 1 ? ` (${top.count})</div>` : '<div>');\n\n              const othersString =\n                others.length === 1\n                  ? `<div class='others' title=\"${s}\">and 1 other category</div>`\n                  : others.length > 1\n                  ? `<div class='others' title=\"${s}\">and ${others.length} other categories</div>`\n                  : `<div class='others none'>dummy text</div>`;\n\n              return `<div class='categories'>${topString}${othersString}</div>`;\n            } else {\n              return v === null ? '' : v;\n            }\n          }\n\n          case 'id': {\n            if (v !== null && isCluster) {\n              // Display first id and number of other ids\n              const top = v.counts[0];\n              const others = v.counts.slice(1).filter((d) => d.count > 0);\n              const s = others.map((d) => d.value).join(', ');\n\n              const topString = `<div>${top.value}<div>`;\n\n              const othersString =\n                others.length === 1\n                  ? `<div class='others' title=\"${s}\">and 1 other</div>`\n                  : others.length > 1\n                  ? `<div class='others' title=\"${s}\">and ${others.length} others</div>`\n                  : '';\n\n              return `<div class='categories'>${topString}${othersString}</div>`;\n            } else {\n              return v === null ? '' : v;\n            }\n          }\n\n          case 'cluster': {\n            return `<div class='clusterSize'>n = ${v}</div>`;\n          }\n\n          case 'group': {\n            return `<div class='group' align=\"center\">${v}</div>`;\n          }\n\n          case 'Diamond': {\n            return `<div class='group' align=\"center\", style=\"opacity:0.5;\" >${v}</div>`;\n          }\n\n          default:\n            return null;\n        }\n      };\n\n      // Insert pinned and expanded rows\n      const expandedData = [];\n\n      const sortColumn = columns.find(({ sort }) => sort !== null);\n      const clusterColumn = columns.find(({ cluster }) => cluster !== null);\n      console.log(sortColumn);\n      console.log(clusterColumn);\n\n      data.forEach((row) => {\n        expandedData.push(row);\n\n        if (row.isCluster) {\n          const insert = row.indeces\n            .map((i) => allData[i])\n            .filter((d) => d.pinned || d.expanded);\n\n          const name = sortColumn ? sortColumn.name : clusterColumn.name;\n          const sort = sortColumn ? sortColumn.sort : clusterColumn.cluster;\n\n          insert.sort((a, b) => {\n            const v1 = a.values[name];\n            const v2 = b.values[name];\n\n            return v1 === null && v2 === null\n              ? 0\n              : v1 === null\n              ? 1\n              : v2 === null\n              ? -1\n              : d3[sort](v1, v2);\n          });\n\n          expandedData.push(...insert);\n        }\n      });\n\n      const maxSize = d3.max(data, (d) => (d.isCluster ? d.size : 1));\n\n      table\n        .select('tbody')\n        .selectAll('tr')\n        .data(expandedData)\n        .join('tr')\n        //.style('cursor', d => d.isCluster ? allData[d.indeces[0]].expanded ? 'zoom-out' : 'zoom-in': 'pointer')\n        .style('cursor', 'pointer')\n        .each(function(d, row) {\n          d3.select(this)\n            .selectAll('td')\n            .data(columns, (d) => d.name)\n            .join((enter) => {\n              const td = enter.append('td');\n\n              const div = td.append('div').attr('class', 'cellDiv');\n\n              const valueDiv = div.append('div').attr('class', 'valueDiv');\n\n              valueDiv\n                .append('div')\n                .attr('class', 'textDiv')\n                .classed('notId', (d) => d.type !== 'id')\n                .style('text-align', (d) =>\n                  d.type === 'numeric' ? 'center' : 'left'\n                );\n\n              valueDiv.append('div').attr('class', 'visDiv');\n\n              return td;\n            })\n            .classed('active', (d) => d.cluster !== null)\n            .style('padding-left', px)\n            .style('padding-right', px)\n            .style('padding-top', py)\n            .style('padding-bottom', py)\n            .each(function(column, idx) {\n              // Text\n\n              const v = d.values[column.name];\n\n              const td = d3\n                .select(this)\n                .classed('expanded', d.expanded)\n                .classed('pinned', d.pinned);\n\n              // clearer grouping indication for pinned rows\n              const isPinned = d3.select(this).classed('pinned');\n              const isExpanded = d3.select(this).classed('expanded');\n              if (\n                applySimplification &&\n                idx === 1 &&\n                (isExpanded || isPinned)\n              ) {\n                td.select('.valueDiv .textDiv').html(\n                  text(column.type, '&emsp;' + v, d.isCluster, column.maxDigits)\n                );\n              } else if (\n                applySimplification &&\n                idx === 0 &&\n                (isExpanded || isPinned)\n              ) {\n                if (isPinned) {\n                  td.select('.valueDiv').html(\n                    text(\n                      'Diamond',\n                      '\\u25C6\\uFE0E',\n                      d.isCluster,\n                      column.maxDigits\n                    ) // BLACK DIAMOND\n                  );\n                } else {\n                  td.select('.valueDiv').html(\n                    text(\n                      'Diamond',\n                      '\\u25C7\\uFE0E',\n                      d.isCluster,\n                      column.maxDigits\n                    ) // WHITE DIAMOND\n                  );\n                }\n              } else if (idx === 0) {\n                //console.log(allData);\n                //console.log(d);\n                // const val = td\n                //   .select('.valueDiv .group')\n                //   .nodes()\n                //   .map(function(d) {\n                //     return d.innerHTML;\n                //   });\n                //console.log(val);\n                //console.log(val[0] === '\\u25BC');\n                if (applySimplification) {\n                  if (d.isCluster) {\n                    var isExpanded_target = false;\n                    d.indeces.forEach((i) => {\n                      isExpanded_target = allData[i].expanded;\n                    });\n                    if (isExpanded_target) {\n                      td.select('.valueDiv').html(\n                        text(\n                          column.type,\n                          '\\u25BC\\uFE0E',\n                          d.isCluster,\n                          column.maxDigits\n                        ) // BLACK DOWN-POINTING TRIANGLE\n                      );\n                    } else {\n                      td.select('.valueDiv').html(\n                        text(\n                          column.type,\n                          '\\u25B6\\uFE0E',\n                          d.isCluster,\n                          column.maxDigits\n                        ) //BLACK RIGHT-POINTING TRIANGLE\n                      );\n                    }\n                  } else {\n                    td.select('.valueDiv').html(\n                      text(\n                        column.type,\n                        '\\u25B6\\uFE0E',\n                        d.isCluster,\n                        column.maxDigits\n                      ) //BLACK RIGHT-POINTING TRIANGLE\n                    );\n                  }\n                } else {\n                  td.select('.valueDiv').html(\n                    text(column.type, '', d.isCluster, column.maxDigits)\n                  );\n                }\n              } else {\n                td.select('.valueDiv .textDiv').html(\n                  text(column.type, v, d.isCluster, column.maxDigits)\n                );\n              }\n\n              td.select('.cellDiv')\n                .selectAll('.clusterDiv')\n                .data(clustering && column.cluster !== null ? [v] : [])\n                .join((enter) => {\n                  const div = enter.append('div').attr('class', 'clusterDiv');\n\n                  div.append('div').attr('class', 'textDiv notId');\n\n                  div.append('div').attr('class', 'visDiv');\n\n                  return div;\n                })\n                .select('.textDiv')\n                .html(\n                  d.expanded ? '' : text('cluster', d.isCluster ? d.size : 1)\n                );\n            });\n        });\n\n      // Separate out the visualization update so we have an accurate width after rendering textual elements\n      table\n        .select('tbody')\n        .selectAll('tr')\n        .each(function(d, i) {\n          d3.select(this)\n            .selectAll('td')\n            .each(function(column) {\n              // Get column width\n              if (i === 0) {\n                column.width = d3\n                  .select(this)\n                  .select('.valueDiv')\n                  .node().clientWidth;\n              }\n\n              const v = d.values[column.name];\n\n              const height = 10;\n\n              // Visualization\n              switch (column.type) {\n                case 'numeric':\n                  d3.select(this)\n                    .select('.valueDiv .visDiv')\n                    .selectAll('svg')\n                    .data(v === null || (d.isCluster && !v.valid) ? [] : [v])\n                    .join('svg')\n                    .attr('width', column.width)\n                    .attr('height', height)\n                    .each(function(v) {\n                      const svg = d3.select(this);\n\n                      const height = 6;\n                      const y = height / 2;\n                      const r = height / 2;\n                      const w1 = r;\n                      const w2 = Math.max(Math.floor(w1 / 2), 1);\n\n                      const colorScale = d3\n                        .scaleLinear()\n                        .domain([\n                          column.extent[0],\n                          (column.extent[0] + column.extent[1]) / 2,\n                          column.extent[1],\n                        ])\n                        .range(['#2171b5', '#999', '#cb181d']);\n\n                      const xScale = d3\n                        .scaleLinear()\n                        .domain(column.extent)\n                        .range([r, column.width - r]);\n\n                      // Quartile line\n                      svg\n                        .selectAll('line')\n                        .data(\n                          d.isCluster\n                            ? [\n                                [v.min, v.max, v.median],\n                                [v.q1, v.q2, v.median],\n                              ]\n                            : []\n                        )\n                        .join((enter) =>\n                          enter\n                            .append('line')\n                            .style('margin', 0)\n                            .style('padding', 0)\n                            .style('stroke-linecap', 'round')\n                        )\n                        .attr('x1', (d) => xScale(d[0]))\n                        .attr('y1', y)\n                        .attr('x2', (d) => xScale(d[1]))\n                        .attr('y2', y)\n                        .style('stroke', (d) => colorScale(d[2]))\n                        .style('stroke-width', (d, i) => (i === 0 ? w2 : w1));\n\n                      // Median\n                      svg\n                        .selectAll('circle')\n                        .data(d.isCluster ? [v.median] : [v])\n                        .join('circle')\n                        .attr('cx', (d) => xScale(d))\n                        .attr('cy', y)\n                        .attr('r', r)\n                        .style('fill', (d) => colorScale(d));\n                    });\n\n                  break;\n\n                case 'categorical':\n                  d3.select(this)\n                    .select('.valueDiv .visDiv')\n                    .selectAll('svg')\n                    .data(v === null ? [] : [v])\n                    .join('svg')\n                    .attr('width', column.width)\n                    .attr('height', height)\n                    .each(function(v) {\n                      const svg = d3.select(this);\n\n                      const height = 10;\n\n                      const counts = v.counts\n                        ? v.counts\n                        : [\n                            {\n                              value: v,\n                              count: 1,\n                            },\n                          ];\n\n                      const colorScale = d3\n                        .scaleOrdinal()\n                        .domain(column.uniqueValues)\n                        .range(d3.schemeTableau10);\n\n                      const xScale = d3\n                        .scaleBand()\n                        .domain(column.uniqueValues)\n                        .range([0, column.width]);\n\n                      const yScale = d3\n                        .scaleLinear()\n                        .domain(\n                          categoryScaling === 'row'\n                            ? [0, d3.max(counts, (d) => d.count)]\n                            : [0, column.maxCount]\n                        )\n                        .range([height, 0]);\n\n                      // Bars\n                      svg\n                        .selectAll('rect')\n                        .data(counts)\n                        .join((enter) => {\n                          const rect = enter.append('rect');\n                          rect.append('title');\n                          return rect;\n                        })\n                        .attr('x', (d) => xScale(d.value))\n                        .attr('y', (d) => yScale(d.count))\n                        .attr('width', xScale.bandwidth())\n                        .attr('height', (d) => yScale(0) - yScale(d.count))\n                        .attr('fill', (d) => colorScale(d.value))\n                        // .select('title')\n                        // .text((d) => `${d.value}: ${d.count}`);\n                        .attr(\n                          'data-tippy-content',\n                          (d) => `${d.value}: ${d.count}`\n                        )\n                        .call((s) => tippy(s.nodes()));\n                    });\n\n                  break;\n\n                case 'id':\n                  break;\n\n                case 'group':\n                  break;\n\n                default:\n                  console.log(`Unknown column type ${column.type}`);\n              }\n\n              // Cluster size\n              const clusterWidth = 30;\n\n              d3.select(this)\n                .select('.clusterDiv .visDiv')\n                .selectAll('svg')\n                .data([d])\n                .join('svg')\n                .attr('width', clusterWidth)\n                .attr('height', height)\n                .each(function(d) {\n                  const svg = d3.select(this);\n\n                  const height = 5;\n\n                  const size = d.isCluster ? d.size : 1;\n\n                  const xScale = d3\n                    .scaleLinear()\n                    .domain([0, maxSize])\n                    .range([0, clusterWidth]);\n\n                  // Bar\n                  svg\n                    .selectAll('rect')\n                    .data(d.expanded ? [] : [d])\n                    .join('rect')\n                    .attr('width', xScale(size))\n                    .attr('height', height)\n                    .attr('fill', '#bbb');\n                });\n            })\n            .on('mouseover', function(evt, column) {\n              table\n                .selectAll('th')\n                .filter((d) => d === column)\n                .select('.highlight')\n                .style('visibility', null);\n\n              if (visualizationMode === 'interactive') {\n                table\n                  .selectAll('td')\n                  .filter((d) => d === column || d.cluster !== null)\n                  .selectAll('.textDiv.notId')\n                  .style('visibility', null);\n              }\n\n              linkSvg\n                .selectAll('path')\n                .style('visibility', (d) =>\n                  d.source === column || d.target === column ? null : 'hidden'\n                );\n            })\n            .on('mouseout', function(evt, column) {\n              table\n                .selectAll('th')\n                .filter((d) => d === column)\n                .select('.highlight')\n                .style('visibility', (d) =>\n                  d.cluster !== null ? null : 'hidden'\n                );\n\n              if (visualizationMode === 'interactive') {\n                table\n                  .selectAll('td')\n                  .filter((d) => d === column || d.cluster !== null)\n                  .selectAll('.textDiv.notId')\n                  .style('visibility', 'hidden');\n              }\n\n              linkSvg.selectAll('path').style('visibility', null);\n            });\n        })\n        .on('mouseover', function(evt, row) {\n          table\n            .select('tbody')\n            .selectAll('tr')\n            .filter((d) => d === row)\n            .selectAll('td')\n            .classed('mouseOver', true);\n        })\n        .on('mouseout', function(evt, row) {\n          table\n            .select('tbody')\n            .selectAll('tr')\n            .filter((d) => d === row)\n            .selectAll('td')\n            .classed('mouseOver', false);\n        })\n        .on('click', function(evt, row) {\n          //var isExpanded = false;\n          if (row.isCluster) {\n            row.indeces.forEach((i) => {\n              allData[i].expanded = !allData[i].expanded;\n            });\n            //console.log(row);\n            //row.isExpanded = allData[i].expanded;\n            //isExpanded = allData[row].expanded;\n            drawTable();\n            // for the triangle indicators\n            // if (isExpanded) {\n            //   table\n            //     .select('tbody')\n            //     .selectAll('tr')\n            //     .filter((d) => d === row)\n            //     .select('.valueDiv .group')\n            //     .text('');\n            // } else {\n            //   table\n            //     .select('tbody')\n            //     .selectAll('tr')\n            //     .filter((d) => d === row)\n            //     .select('.valueDiv .group')\n            //     .text('');\n            // }\n          } else {\n            row.pinned = !row.pinned;\n\n            if (row.pinned) {\n              // Already shown\n              d3.select(this)\n                .selectAll('td')\n                .classed('pinned', true);\n\n              drawTable();\n            } else {\n              // Need to hide\n              drawTable();\n            }\n          }\n        });\n    }\n\n    function highlight() {\n      // Update border\n      const height = table.node() ? table.node().clientHeight - 4 : 0;\n\n      table\n        .selectAll('th')\n        .select('.highlight')\n        .style('height', `${height}px`)\n        .style('visibility', (d) => (d.cluster !== null ? null : 'hidden'));\n    }\n  }\n\n  function drawLinks() {\n    if (!table.node()) return;\n\n    // linkSvg.style('display', showLinks ? null : 'none');\n    // if (!showLinks) return;\n\n    // computeRelations();\n\n    if (relations.length === 0 && !isCalculating) {\n      if (window.Worker) {\n        // instantiate worker\n        isCalculating = true;\n        const computeRelationWorker = new Worker();\n\n        // post data to worker\n        computeRelationWorker.postMessage({\n          relations,\n          columns,\n          allData,\n        });\n        // if received data from worker\n        computeRelationWorker.onmessage = function(e) {\n          if (e && e.data) {\n            const { relations: re, columns: cols } = e.data;\n            relations = re;\n            columns = cols;\n            //console.log('Message received from worker');\n            isCalculating = false;\n            dispatcher_calcRel.call('CalculateRelations', this, isCalculating);\n          }\n        };\n      } else {\n        console.log(\"Your browser doesn't support web worker\");\n      }\n    }\n\n    linkSvg.style('display', showLinks ? null : 'none');\n    if (!showLinks) return;\n\n    const width = table.node().offsetWidth;\n    const height = 200;\n    const aspect = width / height;\n\n    const offset = table.node().getBoundingClientRect().x;\n\n    table\n      .selectAll('th')\n      .nodes()\n      .forEach((d, i) => {\n        const { left, right } = d.getBoundingClientRect();\n\n        columns[i].pos = left + (right - left) / 2 - offset;\n      });\n\n    relations.forEach((d) => {\n      const x1 = d.source.pos;\n      const x2 = d.target.pos;\n\n      const y = height - (x2 - x1) / aspect;\n\n      const xi = d3.interpolateNumber(x1, x2);\n      const yi = d3.interpolateNumber(height, y);\n\n      d.points = [\n        { x: xi(0), y: yi(0) },\n        { x: xi(0.1), y: yi(0.5) },\n        { x: xi(0.5), y: yi(1) },\n        { x: xi(0.9), y: yi(0.5) },\n        { x: xi(1), y: yi(0) },\n      ];\n    });\n\n    const line = d3\n      .line()\n      .x((d) => d.x)\n      .y((d) => d.y)\n      .curve(d3.curveBasis);\n\n    const colorScale = d3.scaleSequential(d3.interpolateRdBu).domain([1, -1]);\n\n    const opacityScale = d3\n      .scaleLinear()\n      .domain([0, 1])\n      .range([0, 1]);\n\n    const widthScale = d3\n      .scaleLinear()\n      .domain([0, 1])\n      .range([0, 5]);\n\n    linkSvg\n      .attr('width', width)\n      .attr('height', height)\n      .selectAll('path')\n      .data(relations)\n      .join('path')\n      .attr('d', (d) => line(d.points))\n      .style('fill', 'none')\n      .style('stroke', (d) => colorScale(d.value))\n      .style('stroke-opacity', (d) => opacityScale(d.magnitude))\n      .style('stroke-width', (d) => widthScale(d.magnitude))\n      .style('stroke-linecap', 'round')\n      .append('title')\n      .text((d) => d.value);\n  }\n\n  function applyVisualizationMode() {\n    const td = table.selectAll('td');\n    td.selectAll('.textDiv.notId').style('visibility', textVisibility());\n    td.selectAll('svg').style('visibility', visVisibility());\n  }\n\n  // for task link\n\n  // cluster\n  digestable.applyClusterColumnLink = function(clusterCol, ascending) {\n    if (!arguments.length) return applyClusterColumn;\n    if (!ascending || ascending === 'true') {\n      cluster_order = 'ascending';\n    } else {\n      cluster_order = 'descending';\n    }\n    applyClusterColumn = clusterCol;\n    return digestable;\n  };\n\n  //sort\n  digestable.applySortColumnLink = function(sortCol, ascending) {\n    if (!arguments.length) return applySortColumn;\n    if (!ascending || ascending === 'true') {\n      sort_order = 'ascending';\n    } else {\n      sort_order = 'descending';\n    }\n    applySortColumn = sortCol;\n    return digestable;\n  };\n\n  // digestable.applySimpleLink = function(simplification) {\n  //   if (!arguments.length) return simplification;\n  //   if (!simplification) return simplification;\n  //   if (simplification === 'true') {\n  //     applySimplification = true;\n  //   }\n  //   return digestable;\n  // };\n\n  digestable.applySimplification = function(_) {\n    if (!arguments.length) return applySimplification;\n    applySimplification = _;\n    const clusterColumn = columns.find(({ cluster }) => cluster !== null);\n    if (clusterColumn && clusterColumn.type !== 'id') {\n      processData();\n      sortTable();\n    }\n    drawTable();\n    return digestable;\n  };\n\n  digestable.simplificationMethod = function(_) {\n    if (!arguments.length) return simplificationMethod;\n    simplificationMethod = _;\n    if (clustering) {\n      processData();\n      sortTable();\n      drawTable();\n    }\n    return digestable;\n  };\n\n  digestable.simplificationAmount = function(_) {\n    if (!arguments.length) return simplificationAmount;\n    simplificationAmount = _;\n    if (clustering) {\n      processData();\n      sortTable();\n      drawTable();\n    }\n    return digestable;\n  };\n\n  digestable.simplificationRows = function(_) {\n    if (!arguments.length) return simplificationRows;\n    simplificationRows = _;\n    if (clustering) {\n      processData();\n      sortTable();\n      drawTable();\n    }\n    return digestable;\n  };\n\n  digestable.transformBase = function(_) {\n    if (!arguments.length) return transformBase;\n    transformBase = _;\n    if (clustering) {\n      processData();\n      sortTable();\n      drawTable();\n    }\n    return digestable;\n  };\n\n  // unselect function\n  digestable.unselect = function() {\n    allData.forEach((row) => {\n      row.pinned = false;\n    });\n    drawTable();\n    return digestable;\n  };\n\n  digestable.visualizationMode = function(_) {\n    if (!arguments.length) return visualizationMode;\n    visualizationMode = _;\n    applyVisualizationMode();\n    return digestable;\n  };\n\n  digestable.showLinks = function(_) {\n    if (!arguments.length) return showLinks;\n    showLinks = _;\n    drawTable();\n    return digestable;\n  };\n\n  digestable.categoryScaling = function(_) {\n    if (!arguments.length) return categoryScaling;\n    categoryScaling = _;\n    drawTable();\n    return digestable;\n  };\n\n  digestable.updateLinks = function() {\n    drawLinks();\n    return digestable;\n  };\n\n  // For registering event callbacks\n  digestable.on = function() {\n    const value = dispatcher.on.apply(dispatcher, arguments);\n    return value === dispatcher ? digestable : value;\n  };\n\n  // For registering event callbacks\n  digestable.onCalcRel = function() {\n    const value = dispatcher_calcRel.on.apply(dispatcher_calcRel, arguments);\n    return value === dispatcher_calcRel ? digestable : value;\n  };\n\n  function loadMoreData(rowNum) {\n    displayRowNum += parseInt(rowNum);\n    //console.log(displayRowNum);\n    if (displayRowNum < [...allData].length) {\n      data = [...allData].slice(0, displayRowNum);\n    } else {\n      isFullData = true;\n      data = [...allData];\n    }\n    drawTable();\n  }\n\n  digestable.loadMore = function(rowNum) {\n    loadMoreData(rowNum);\n    //console.log('digestable test');\n    return digestable;\n  };\n\n  digestable.isFullData = function() {\n    return isFullData;\n  };\n\n  digestable.fullDataLength = function() {\n    return [...allData].length;\n  };\n\n  digestable.displayRowNum = function() {\n    return displayRowNum;\n  };\n\n  return digestable;\n};\n","import * as d3 from 'd3';\n\nexport const clusterQuantiles = (values, n) => {\n  const range = d3.range(n);\n\n  const scale = d3.scaleQuantile()\n    .domain(values)\n    .range(range);\n\n  return values.reduce((clusters, value, i) => {\n    clusters[scale(value)].push(i);\n    return clusters;\n  }, range.map(() => []));\n};","import * as d3 from 'd3';\n\nexport const clusterGap = (values, numRows) => {\n  const gaps = d3.pairs(values).map((d, i) => ({ value: Math.abs(d[1] - d[0]), index: i }));\n\n  gaps.sort((a, b) => {\n    return a.value === b.value ? d3.ascending(a.index, b.index) : d3.descending(a.value, b.value);\n  });\n\n  const clusters = gaps.slice(0, numRows - 1).map(gap => gap.index);\n\n  clusters.sort(d3.ascending);\n  clusters.unshift(-1);\n  clusters.push(values.length - 1);\n  \n  return d3.pairs(clusters).map(d => d3.range(d[0] + 1, d[1] + 1));\n};","export const groupCategories = values => {\n  return values.reduce((clusters, value, i, a) => {\n    if (i === 0) {\n      clusters.push([i]);\n    }\n    else {\n      if (value === a[i - 1]) {\n        clusters[clusters.length -1].push(i);\n      }\n      else {\n        clusters.push([i]);\n      }\n    }\n\n    return clusters;\n  }, []);\n}","import { Button, Form, Row, Col } from 'react-bootstrap';\nimport { useState } from 'react';\nconst Footer = ({\n  loadMore,\n  isFullData,\n  addrowNum,\n  setAddRowNum,\n  max,\n  displayRowNum,\n  refreshDisplayRowNum,\n}) => {\n  // handle form submit\n  const [displayRowNumAct, setDisplayRowNumAct] = useState(\n    displayRowNum || 100\n  );\n\n  const onFormSubmit = (e) => {\n    e.preventDefault();\n    loadMore(addrowNum);\n    if (refreshDisplayRowNum() > max) {\n      setDisplayRowNumAct(max);\n    } else {\n      setDisplayRowNumAct(refreshDisplayRowNum());\n    }\n    setAddRowNum(100);\n  };\n  return (\n    <div\n      style={{\n        padding: '2rem',\n        display: 'flex',\n        justifyContent: 'center',\n        position: 'sticky',\n        left: '0',\n        zIndex: '3',\n        backgroundColor: 'white',\n      }}\n    >\n      <Form onSubmit={onFormSubmit}>\n        <Row>\n          <Col xs='auto'>\n            <Form.Text\n              style={{ position: 'relative', top: '.5rem', fontSize: '1rem' }}\n            >\n              Showing {displayRowNumAct} of {max} rows\n            </Form.Text>\n          </Col>\n          <Col xs='auto'>\n            <Button\n              disabled={isFullData}\n              // style={{\n              //   marginLeft: '1rem',\n              // }}\n              type='submit'\n            >\n              {isFullData ? 'End of Data' : `Load ${addrowNum} more rows`}\n            </Button>\n          </Col>\n          <Col xs='auto'>\n            <Form.Control\n              //style={{ width: '8rem' }}\n              type='number'\n              //placeholder='more rows'\n              min='1'\n              max={max}\n              value={addrowNum}\n              onChange={(e) => setAddRowNum(e.target.value)}\n              disabled={isFullData}\n            />\n          </Col>\n        </Row>\n      </Form>\n    </div>\n  );\n};\nexport default Footer;\n","import { useContext, useRef, useEffect, useState } from 'react';\nimport * as d3 from 'd3';\nimport { SimplifyContext, VisualizationContext } from '../../contexts';\nimport { useScrollHook } from '../../hooks';\nimport { digestable } from '../../digestable';\nimport Footer from './Footer';\n//import { index } from 'd3';\n\nexport const TableWrapper = ({\n  data,\n  clusterCol,\n  clusterAscending,\n  sortCol,\n  sortAscending,\n}) => {\n  const [\n    { apply, method, amount, rows, transformBase, unselect },\n    simplifyDispatch,\n  ] = useContext(SimplifyContext);\n  const [\n    { mode, showLinks, categoryScaling },\n    visualizationDispatch,\n  ] = useContext(VisualizationContext);\n  const divRef = useRef();\n  const digestableRef = useRef();\n  const OuterDivRef = useRef();\n\n  // parameters for load more\n  const [isFullData, setIsFullData] = useState(false);\n  const [addrowNum, setAddRowNum] = useState(100);\n  // Scroll callback\n  const onScroll = useScrollHook(\n    () => {\n      if (digestableRef.current) {\n        digestableRef.current.updateLinks();\n      }\n    },\n    OuterDivRef,\n    'horizontal'\n  );\n\n  // Create visualization\n  useEffect(() => {\n    if (!digestableRef.current) {\n      digestableRef.current = digestable()\n        .applySimplification(apply)\n        // .applySimpleLink(simplification)\n        .simplificationMethod(method.name)\n        .simplificationAmount(amount)\n        .simplificationRows(rows)\n        .transformBase(transformBase)\n        .visualizationMode(mode)\n        .categoryScaling(categoryScaling)\n        .on('clusterByColumn', (column) => {\n          simplifyDispatch({\n            type: 'setColumnInfo',\n            columnType: column.type,\n            unique: column.uniqueValues.length,\n          });\n        })\n        .onCalcRel('CalculateRelations', (isCalculating) => {\n          //console.log(isCalculating);\n          visualizationDispatch({\n            type: 'setCalculatingRelations',\n            calculatingRelations: isCalculating,\n          });\n        })\n        .applyClusterColumnLink(clusterCol, clusterAscending)\n        .applySortColumnLink(sortCol, sortAscending);\n    }\n  }, []);\n\n  // Update data\n  useEffect(() => {\n    d3.select(divRef.current)\n      .datum(data)\n      .call(digestableRef.current);\n    visualizationDispatch({\n      type: 'setCalculatingRelations',\n      calculatingRelations: true,\n    });\n  }, [data]);\n\n  // Simplify parameters\n  useEffect(() => {\n    if (digestableRef.current) {\n      digestableRef.current.applySimplification(apply);\n    }\n  }, [apply]);\n\n  useEffect(() => {\n    if (digestableRef.current) {\n      digestableRef.current.simplificationMethod(method.name);\n    }\n  }, [method]);\n\n  useEffect(() => {\n    if (digestableRef.current) {\n      digestableRef.current.simplificationAmount(amount);\n    }\n  }, [amount]);\n\n  useEffect(() => {\n    if (digestableRef.current) {\n      digestableRef.current.simplificationRows(rows);\n    }\n  }, [rows]);\n\n  useEffect(() => {\n    if (digestableRef.current) {\n      digestableRef.current.transformBase(transformBase);\n    }\n  }, [transformBase]);\n\n  // unselect parameters\n  useEffect(() => {\n    if (digestableRef.current) {\n      digestableRef.current.unselect();\n    }\n  }, [unselect]);\n\n  // Visualization parameters\n  useEffect(() => {\n    if (digestableRef.current) {\n      digestableRef.current.visualizationMode(mode);\n    }\n  }, [mode]);\n\n  useEffect(() => {\n    if (digestableRef.current) {\n      digestableRef.current.showLinks(showLinks);\n    }\n  }, [showLinks]);\n\n  useEffect(() => {\n    if (digestableRef.current) {\n      digestableRef.current.categoryScaling(categoryScaling);\n    }\n  }, [categoryScaling]);\n\n  // if still calculate relations\n  // useEffect(() => {\n  //   if (digestableRef.current) {\n  //     visualizationDispatch({\n  //       type: 'setCalculatingRelations',\n  //       calculatingRelations: false,\n  //     });\n  //   }\n  // }, [calculatingRelations]);\n\n  //load-more parameter\n\n  // initial check\n  useEffect(() => {\n    if (digestableRef.current && digestableRef.current.isFullData()) {\n      setIsFullData(true);\n    }\n  }, []);\n\n  // click event\n  const loadMore = (addrowNum) => {\n    if (digestableRef.current) {\n      digestableRef.current.loadMore(addrowNum);\n      if (digestableRef.current.isFullData()) {\n        setIsFullData(true);\n      }\n    }\n  };\n\n  const max = digestableRef.current && digestableRef.current.fullDataLength();\n  const displayRowNum =\n    digestableRef.current && digestableRef.current.displayRowNum();\n\n  const refreshDisplayRowNum = () => {\n    if (digestableRef.current) {\n      return digestableRef.current.displayRowNum();\n    }\n  };\n  return (\n    <div\n      ref={OuterDivRef}\n      onScroll={onScroll}\n      style={{\n        height: '100%',\n        overflow: 'auto',\n      }}\n    >\n      <div ref={divRef}></div>\n      {apply || isFullData ? (\n        <div></div>\n      ) : (\n        <Footer\n          loadMore={loadMore}\n          isFullData={isFullData}\n          addrowNum={addrowNum}\n          setAddRowNum={setAddRowNum}\n          max={max}\n          displayRowNum={displayRowNum}\n          refreshDisplayRowNum={refreshDisplayRowNum}\n        />\n      )}\n    </div>\n  );\n};\n","import { useRef } from 'react';\n\nexport const useScrollHook = (callback, divRef, scrollType) => {\n  const x = useRef(0);\n  const y = useRef(0);\n  const ticking = useRef(false);\n\n  return () => {\n    if (!divRef.current) return;\n\n    switch (scrollType) {\n      case 'horizontal':\n        {\n          const left = divRef.current.scrollLeft;\n\n          if (left !== x.current) {\n            x.current = left;\n\n            if (!ticking.current) {\n              window.requestAnimationFrame(() => {\n                callback(left);\n\n                ticking.current = false;\n              });\n\n              ticking.current = true;\n            }\n          }\n        }\n        break;\n\n      case 'vertical':\n        {\n          const top = divRef.current.scrollTop;\n\n          if (top !== y.current) {\n            y.current = top;\n\n            if (!ticking.current) {\n              window.requestAnimationFrame(() => {\n                callback(top);\n\n                ticking.current = false;\n              });\n\n              ticking.current = true;\n            }\n          }\n        }\n        break;\n\n      case 'both':\n        {\n          const left = divRef.current.scrollLeft;\n          const top = divRef.current.scrollTop;\n\n          if (left !== x.current || top !== y.current) {\n            x.current = left;\n            y.current = top;\n\n            if (!ticking.current) {\n              window.requestAnimationFrame(() => {\n                callback(left, top);\n\n                ticking.current = false;\n              });\n\n              ticking.current = true;\n            }\n          }\n        }\n        break;\n\n      default:\n        console.log('Invalid scroll type');\n    }\n  };\n};\n","import { Card, Stack } from 'react-bootstrap';\n\nconst { Header, Body, Subtitle } = Card;\n\nexport const ControlPanel = ({ title, subtitle, children }) => {\n  return (\n    <Card>\n      <Header>{ title }</Header>\n      <Body>\n        { subtitle && \n          <Subtitle className='mb-2 text-muted'>\n            { subtitle}\n          </Subtitle>\n        }\n        <Stack gap={ 3 }>\n          { children }\n        </Stack>\n      </Body>\n    </Card>\n  );\n};\n","import { useEffect } from 'react';\nimport { useContext } from 'react';\nimport { Form, FloatingLabel, Button } from 'react-bootstrap';\nimport { SimplifyContext } from '../../contexts';\nimport { ControlPanel } from './controlPanel';\n\nconst { Group, Label, Check, Select, Range, Control } = Form;\n\nexport const SimplifyControls = ({ simplification }) => {\n  const [\n    {\n      apply,\n      columnType,\n      methods,\n      method,\n      amount,\n      transformBase,\n      unique,\n      rows,\n      unselect,\n    },\n    simplifyDispatch,\n  ] = useContext(SimplifyContext);\n\n  useEffect(() => {\n    if (simplification === 'true') {\n      simplifyDispatch({ type: 'setApply', apply: true });\n      //simplification = 'false';\n    }\n  }, []);\n\n  const onApplyChange = (evt) => {\n    simplifyDispatch({ type: 'setApply', apply: evt.target.checked });\n  };\n\n  const onMethodChange = (evt) => {\n    simplifyDispatch({\n      type: 'setMethod',\n      method: methods.find(({ name }) => name === evt.target.value),\n    });\n  };\n\n  const onAmountChange = (evt) => {\n    simplifyDispatch({\n      type: 'setAmount',\n      amount: +evt.target.value / 100,\n    });\n  };\n\n  const onRowsChange = (evt) => {\n    simplifyDispatch({ type: 'setRows', rows: +evt.target.value });\n  };\n\n  const onTransformBaseChange = (evt) => {\n    simplifyDispatch({\n      type: 'setTransformBase',\n      transformBase: +evt.target.value / 100,\n    });\n  };\n\n  const onUnselectChange = (evt) => {\n    simplifyDispatch({\n      type: 'setUnselect',\n      unselect: evt.target.value === 'true',\n    });\n  };\n\n  return (\n    <ControlPanel title='Simplification' subtitle={`${columnType} column`}>\n      <Group>\n        <Check\n          type='checkbox'\n          label='Apply'\n          id='apply-simplification-checkbox'\n          size='sm'\n          checked={apply}\n          disabled={columnType === 'id'}\n          onChange={onApplyChange}\n        />\n      </Group>\n      {columnType === 'numeric' && (\n        <>\n          <Group>\n            <Label>numeric column:</Label>\n            <FloatingLabel label='Method'>\n              <Select value={method.name} onChange={onMethodChange}>\n                {methods.map(({ name }, i) => (\n                  <option key={i} value={name}>\n                    {name}\n                  </option>\n                ))}\n              </Select>\n            </FloatingLabel>\n          </Group>\n          {method.type === 'amount' ? (\n            <Group>\n              <Label>Amount</Label>\n              <Range\n                min={0}\n                max={100}\n                step={1}\n                value={amount * 100}\n                onChange={onAmountChange}\n              />\n            </Group>\n          ) : (\n            <Group>\n              <Label>Number of rows</Label>\n              <Control\n                type='number'\n                min={1}\n                max={unique}\n                step={1}\n                value={rows}\n                onChange={onRowsChange}\n              />\n            </Group>\n          )}\n          {method.transform && (\n            <Group>\n              <Label>Depth weight</Label>\n              <Range\n                min={100}\n                max={400}\n                step={1}\n                value={transformBase * 100}\n                onChange={onTransformBaseChange}\n              />\n            </Group>\n          )}\n        </>\n      )}\n      <Group>\n        <Button\n          variant='outline-secondary'\n          size='sm'\n          value={!unselect}\n          onClick={onUnselectChange}\n        >\n          Unselect all rows\n        </Button>\n      </Group>\n    </ControlPanel>\n  );\n};\n","import { useContext, useEffect } from 'react';\nimport { Form, FloatingLabel, Spinner, Row, Col } from 'react-bootstrap';\nimport { VisualizationContext } from '../../contexts';\nimport { ControlPanel } from './controlPanel';\n\nconst { Group, Select, Check } = Form;\n\nexport const VisualizationControls = ({ visual }) => {\n  const [\n    {\n      modes,\n      mode,\n      showLinks,\n      categoryScalingOptions,\n      categoryScaling,\n      calculatingRelations,\n    },\n    visualizationDispatch,\n  ] = useContext(VisualizationContext);\n\n  useEffect(() => {\n    if (visual === 'both') {\n      visualizationDispatch({ type: 'setMode', mode: 'both' });\n      //simplification = 'false';\n    } else if (visual === 'visualizations') {\n      visualizationDispatch({ type: 'setMode', mode: 'visualizations' });\n    } else if (visual === 'interactive') {\n      visualizationDispatch({\n        type: 'setMode',\n        mode: 'interactive',\n      });\n    }\n  }, []);\n\n  const onModeChange = (evt) => {\n    visualizationDispatch({ type: 'setMode', mode: evt.target.value });\n  };\n\n  const onShowLinksChange = (evt) => {\n    visualizationDispatch({\n      type: 'setShowLinks',\n      showLinks: evt.target.checked,\n    });\n  };\n\n  const onCategoryScalingChange = (evt) => {\n    visualizationDispatch({\n      type: 'setCategoryScaling',\n      categoryScaling: evt.target.value,\n    });\n  };\n\n  return (\n    <ControlPanel title='Visualization'>\n      <Group>\n        <FloatingLabel label='Mode'>\n          <Select value={mode} onChange={onModeChange}>\n            {modes.map((mode, i) => (\n              <option key={i} value={mode}>\n                {mode}\n              </option>\n            ))}\n          </Select>\n        </FloatingLabel>\n      </Group>\n      <Group>\n        {calculatingRelations ? (\n          <>\n            <Check\n              type='checkbox'\n              label='Show links'\n              id='show-links-checkbox'\n              size='sm'\n              checked={showLinks}\n              onChange={onShowLinksChange}\n              disabled={calculatingRelations}\n            />\n            {/* <Spinner\n                animation='border'\n                style={{\n                  width: '1.5rem',\n                  height: '1.5rem',\n                  position: 'relative',\n                  right: '20%',\n                }}\n              /> */}\n            <p className='text-muted small' style={{ marginBottom: '0rem' }}>\n              Calculating...\n            </p>\n          </>\n        ) : (\n          <Check\n            type='checkbox'\n            label='Show links'\n            id='show-links-checkbox'\n            size='sm'\n            checked={showLinks}\n            onChange={onShowLinksChange}\n            disabled={calculatingRelations}\n          />\n        )}\n      </Group>\n      <Group>\n        <FloatingLabel label='Category scaling'>\n          <Select value={categoryScaling} onChange={onCategoryScalingChange}>\n            {categoryScalingOptions.map((option, i) => (\n              <option key={i} value={option}>\n                {option}\n              </option>\n            ))}\n          </Select>\n        </FloatingLabel>\n      </Group>\n    </ControlPanel>\n  );\n};\n","import { useState } from 'react';\nimport {\n  Container,\n  Navbar,\n  Row,\n  Col,\n  Form,\n  Spinner,\n  Stack,\n} from 'react-bootstrap';\nimport * as d3 from 'd3';\nimport { SimplifyProvider, VisualizationProvider } from './contexts';\nimport { TableWrapper } from './components/table-wrapper';\nimport { SimplifyControls, VisualizationControls } from './components/controls';\nimport { useEffect } from 'react';\n\nconst { Brand } = Navbar;\nconst { Group, Control, Select } = Form;\n\nconst datasets = [\n  { name: 'MT Cars', url: '/digestable/data/mtcars.csv' },\n  { name: 'NFL Combine 2017', url: '/digestable/data/NFL Combine 2017.csv' },\n  { name: 'Starbucks', url: '/digestable/data/starbucks.csv' },\n  { name: 'Electric Cars', url: '/digestable/data/ElectricCars.csv' },\n  { name: 'Stars', url: '/digestable/data/Stars.csv' },\n];\n\nexport const App = () => {\n  const [dataset, setDataset] = useState('');\n  const [data, setData] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  // XXX: Add loading spinner\n  const loadData = async (url) => {\n    setData(null);\n    setLoading(true);\n\n    try {\n      const csvData = await d3.csv(url);\n\n      setData(csvData);\n      setLoading(false);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const onSelectChange = (evt) => {\n    const url = evt.target.value;\n    setDataset(url);\n    loadData(url);\n  };\n\n  const onFileSelect = (evt) => {\n    const file = evt.target.files.length === 1 ? evt.target.files[0] : null;\n\n    if (file) {\n      setDataset('');\n      loadData(URL.createObjectURL(file));\n    }\n  };\n\n  // Get the query string\n  const queryParams = new URLSearchParams(window.location.search);\n  const mode = queryParams.get('mode');\n  // const target_dataset = queryParams.get('dataset');\n  const clusterCol = queryParams.get('clusterCol');\n  const clusterAscending = queryParams.get('clusterAscending');\n  const sortCol = queryParams.get('sortCol');\n  const sortAscending = queryParams.get('sortAscending');\n  const simplification = queryParams.get('simplification');\n  const visual = queryParams.get('visual');\n  const targetDataset = queryParams.get('dataset');\n\n  const loadwithPresetData = (targetDataset) => {\n    const d = datasets.find((ds) => ds.name === targetDataset);\n    if (d) {\n      const url = d.url;\n      setDataset(url);\n      loadData(url);\n    }\n  };\n\n  useEffect(() => {\n    loadwithPresetData(targetDataset);\n  }, []);\n\n  return (\n    <SimplifyProvider>\n      <VisualizationProvider>\n        <Navbar bg='dark' variant='dark'>\n          <Brand className='ms-2'>\n            <img\n              src='/digestable/digestable_512.png'\n              alt='digestable logo'\n              height='32px'\n              className='me-1'\n            />\n            <span className='text-align-bottom'>\n              diges<b>table</b>\n            </span>\n          </Brand>\n          <Form>\n            <Group as={Row} className='align-items-center'>\n              <Col>\n                <Select value={dataset} onChange={onSelectChange}>\n                  <option value='' disabled>\n                    Choose dataset\n                  </option>\n                  {datasets.map((dataset, i) => (\n                    <option key={i} value={dataset.url}>\n                      {dataset.name}\n                    </option>\n                  ))}\n                </Select>\n              </Col>\n              <Col sm='auto' className='text-center'>\n                <span className='text-light'>or</span>\n              </Col>\n              <Col>\n                <Control type='file' accept='.csv' onChange={onFileSelect} />\n              </Col>\n            </Group>\n          </Form>\n        </Navbar>\n        {data ? (\n          <Container fluid style={{ height: 'calc(100% - 100px)' }}>\n            <Row style={{ height: '100%' }}>\n              <Col xs={10} className='mt-3' style={{ height: '100%' }}>\n                <TableWrapper\n                  data={data}\n                  clusterCol={clusterCol}\n                  clusterAscending={clusterAscending}\n                  sortCol={sortCol}\n                  sortAscending={sortAscending}\n                />\n              </Col>\n              <Col className='bg-dark'>\n                {mode === 'simple' ? (\n                  <Stack gap={3}></Stack>\n                ) : (\n                  <Stack gap={3}>\n                    <SimplifyControls simplification={simplification} />\n                    <VisualizationControls visual={visual} />\n                  </Stack>\n                )}\n              </Col>\n            </Row>\n          </Container>\n        ) : (\n          <Container>\n            <div className='m-4 text-center'>\n              {loading ? (\n                <>\n                  <h5>Loading...</h5>\n                  <Spinner animation='border' />\n                </>\n              ) : (\n                <h3>No data</h3>\n              )}\n            </div>\n          </Container>\n        )}\n      </VisualizationProvider>\n    </SimplifyProvider>\n  );\n};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport { App } from './app';\n//import reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n//reportWebVitals();\n"],"sourceRoot":""}